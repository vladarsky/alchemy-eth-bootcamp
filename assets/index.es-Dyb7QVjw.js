const __vite__fileDeps=["assets/index-D8vjKS3j.js","assets/index-BNTKMgQt.js","assets/index-Ck9It0Ud.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{g as Ts,l as zw,i as ca,a as Yr,_ as Hw}from"./index-BNTKMgQt.js";import{e as Fr,U as Vu}from"./events-DtPImOVQ.js";import{r as Bw}from"./___vite-browser-external_commonjs-proxy-CMnoDguS.js";var Gu={},ua={},je={},Gd={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});function e(f,g){var p=f>>>16&65535,v=f&65535,w=g>>>16&65535,E=g&65535;return v*E+(p*E+v*w<<16>>>0)|0}i.mul=Math.imul||e;function t(f,g){return f+g|0}i.add=t;function s(f,g){return f-g|0}i.sub=s;function o(f,g){return f<<g|f>>>32-g}i.rotl=o;function c(f,g){return f<<32-g|f>>>g}i.rotr=c;function l(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}i.isInteger=Number.isInteger||l,i.MAX_SAFE_INTEGER=9007199254740991,i.isSafeInteger=function(f){return i.isInteger(f)&&f>=-i.MAX_SAFE_INTEGER&&f<=i.MAX_SAFE_INTEGER}})(Gd);Object.defineProperty(je,"__esModule",{value:!0});var Wd=Gd;function Kw(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])<<16>>16}je.readInt16BE=Kw;function kw(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])>>>0}je.readUint16BE=kw;function Vw(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])<<16>>16}je.readInt16LE=Vw;function Gw(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])>>>0}je.readUint16LE=Gw;function Yd(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>8,e[t+1]=i>>>0,e}je.writeUint16BE=Yd;je.writeInt16BE=Yd;function Jd(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e}je.writeUint16LE=Jd;je.writeInt16LE=Jd;function vu(i,e){return e===void 0&&(e=0),i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}je.readInt32BE=vu;function mu(i,e){return e===void 0&&(e=0),(i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3])>>>0}je.readUint32BE=mu;function _u(i,e){return e===void 0&&(e=0),i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e]}je.readInt32LE=_u;function wu(i,e){return e===void 0&&(e=0),(i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e])>>>0}je.readUint32LE=wu;function ta(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>24,e[t+1]=i>>>16,e[t+2]=i>>>8,e[t+3]=i>>>0,e}je.writeUint32BE=ta;je.writeInt32BE=ta;function ra(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e[t+2]=i>>>16,e[t+3]=i>>>24,e}je.writeUint32LE=ra;je.writeInt32LE=ra;function Ww(i,e){e===void 0&&(e=0);var t=vu(i,e),s=vu(i,e+4);return t*4294967296+s-(s>>31)*4294967296}je.readInt64BE=Ww;function Yw(i,e){e===void 0&&(e=0);var t=mu(i,e),s=mu(i,e+4);return t*4294967296+s}je.readUint64BE=Yw;function Jw(i,e){e===void 0&&(e=0);var t=_u(i,e),s=_u(i,e+4);return s*4294967296+t-(t>>31)*4294967296}je.readInt64LE=Jw;function Qw(i,e){e===void 0&&(e=0);var t=wu(i,e),s=wu(i,e+4);return s*4294967296+t}je.readUint64LE=Qw;function Qd(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),ta(i/4294967296>>>0,e,t),ta(i>>>0,e,t+4),e}je.writeUint64BE=Qd;je.writeInt64BE=Qd;function Xd(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),ra(i>>>0,e,t),ra(i/4294967296>>>0,e,t+4),e}je.writeUint64LE=Xd;je.writeInt64LE=Xd;function Xw(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,c=i/8+t-1;c>=t;c--)s+=e[c]*o,o*=256;return s}je.readUintBE=Xw;function Zw(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,c=t;c<t+i/8;c++)s+=e[c]*o,o*=256;return s}je.readUintLE=Zw;function e1(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Wd.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,c=i/8+s-1;c>=s;c--)t[c]=e/o&255,o*=256;return t}je.writeUintBE=e1;function t1(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Wd.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,c=s;c<s+i/8;c++)t[c]=e/o&255,o*=256;return t}je.writeUintLE=t1;function r1(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e)}je.readFloat32BE=r1;function i1(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e,!0)}je.readFloat32LE=i1;function n1(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e)}je.readFloat64BE=n1;function s1(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e,!0)}je.readFloat64LE=s1;function o1(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i),e}je.writeFloat32BE=o1;function a1(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i,!0),e}je.writeFloat32LE=a1;function c1(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i),e}je.writeFloat64BE=c1;function u1(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i,!0),e}je.writeFloat64LE=u1;var Cr={};Object.defineProperty(Cr,"__esModule",{value:!0});function h1(i){for(var e=0;e<i.length;e++)i[e]=0;return i}Cr.wipe=h1;Object.defineProperty(ua,"__esModule",{value:!0});var Xt=je,bu=Cr,l1=20;function f1(i,e,t){for(var s=1634760805,o=857760878,c=2036477234,l=1797285236,f=t[3]<<24|t[2]<<16|t[1]<<8|t[0],g=t[7]<<24|t[6]<<16|t[5]<<8|t[4],p=t[11]<<24|t[10]<<16|t[9]<<8|t[8],v=t[15]<<24|t[14]<<16|t[13]<<8|t[12],w=t[19]<<24|t[18]<<16|t[17]<<8|t[16],E=t[23]<<24|t[22]<<16|t[21]<<8|t[20],x=t[27]<<24|t[26]<<16|t[25]<<8|t[24],I=t[31]<<24|t[30]<<16|t[29]<<8|t[28],B=e[3]<<24|e[2]<<16|e[1]<<8|e[0],K=e[7]<<24|e[6]<<16|e[5]<<8|e[4],Z=e[11]<<24|e[10]<<16|e[9]<<8|e[8],$=e[15]<<24|e[14]<<16|e[13]<<8|e[12],L=s,P=o,C=c,A=l,h=f,b=g,ee=p,ne=v,ue=w,ge=E,ye=x,S=I,R=B,X=K,J=Z,k=$,V=0;V<l1;V+=2)L=L+h|0,R^=L,R=R>>>16|R<<16,ue=ue+R|0,h^=ue,h=h>>>20|h<<12,P=P+b|0,X^=P,X=X>>>16|X<<16,ge=ge+X|0,b^=ge,b=b>>>20|b<<12,C=C+ee|0,J^=C,J=J>>>16|J<<16,ye=ye+J|0,ee^=ye,ee=ee>>>20|ee<<12,A=A+ne|0,k^=A,k=k>>>16|k<<16,S=S+k|0,ne^=S,ne=ne>>>20|ne<<12,C=C+ee|0,J^=C,J=J>>>24|J<<8,ye=ye+J|0,ee^=ye,ee=ee>>>25|ee<<7,A=A+ne|0,k^=A,k=k>>>24|k<<8,S=S+k|0,ne^=S,ne=ne>>>25|ne<<7,P=P+b|0,X^=P,X=X>>>24|X<<8,ge=ge+X|0,b^=ge,b=b>>>25|b<<7,L=L+h|0,R^=L,R=R>>>24|R<<8,ue=ue+R|0,h^=ue,h=h>>>25|h<<7,L=L+b|0,k^=L,k=k>>>16|k<<16,ye=ye+k|0,b^=ye,b=b>>>20|b<<12,P=P+ee|0,R^=P,R=R>>>16|R<<16,S=S+R|0,ee^=S,ee=ee>>>20|ee<<12,C=C+ne|0,X^=C,X=X>>>16|X<<16,ue=ue+X|0,ne^=ue,ne=ne>>>20|ne<<12,A=A+h|0,J^=A,J=J>>>16|J<<16,ge=ge+J|0,h^=ge,h=h>>>20|h<<12,C=C+ne|0,X^=C,X=X>>>24|X<<8,ue=ue+X|0,ne^=ue,ne=ne>>>25|ne<<7,A=A+h|0,J^=A,J=J>>>24|J<<8,ge=ge+J|0,h^=ge,h=h>>>25|h<<7,P=P+ee|0,R^=P,R=R>>>24|R<<8,S=S+R|0,ee^=S,ee=ee>>>25|ee<<7,L=L+b|0,k^=L,k=k>>>24|k<<8,ye=ye+k|0,b^=ye,b=b>>>25|b<<7;Xt.writeUint32LE(L+s|0,i,0),Xt.writeUint32LE(P+o|0,i,4),Xt.writeUint32LE(C+c|0,i,8),Xt.writeUint32LE(A+l|0,i,12),Xt.writeUint32LE(h+f|0,i,16),Xt.writeUint32LE(b+g|0,i,20),Xt.writeUint32LE(ee+p|0,i,24),Xt.writeUint32LE(ne+v|0,i,28),Xt.writeUint32LE(ue+w|0,i,32),Xt.writeUint32LE(ge+E|0,i,36),Xt.writeUint32LE(ye+x|0,i,40),Xt.writeUint32LE(S+I|0,i,44),Xt.writeUint32LE(R+B|0,i,48),Xt.writeUint32LE(X+K|0,i,52),Xt.writeUint32LE(J+Z|0,i,56),Xt.writeUint32LE(k+$|0,i,60)}function Zd(i,e,t,s,o){if(o===void 0&&(o=0),i.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<t.length)throw new Error("ChaCha: destination is shorter than source");var c,l;if(o===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");c=new Uint8Array(16),l=c.length-e.length,c.set(e,l)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");c=e,l=o}for(var f=new Uint8Array(64),g=0;g<t.length;g+=64){f1(f,c,i);for(var p=g;p<g+64&&p<t.length;p++)s[p]=t[p]^f[p-g];p1(c,0,l)}return bu.wipe(f),o===0&&bu.wipe(c),s}ua.streamXOR=Zd;function d1(i,e,t,s){return s===void 0&&(s=0),bu.wipe(t),Zd(i,e,t,t,s)}ua.stream=d1;function p1(i,e,t){for(var s=1;t--;)s=s+(i[e]&255)|0,i[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var ep={},Fi={};Object.defineProperty(Fi,"__esModule",{value:!0});function g1(i,e,t){return~(i-1)&e|i-1&t}Fi.select=g1;function y1(i,e){return(i|0)-(e|0)-1>>>31&1}Fi.lessOrEqual=y1;function tp(i,e){if(i.length!==e.length)return 0;for(var t=0,s=0;s<i.length;s++)t|=i[s]^e[s];return 1&t-1>>>8}Fi.compare=tp;function v1(i,e){return i.length===0||e.length===0?!1:tp(i,e)!==0}Fi.equal=v1;(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Fi,t=Cr;i.DIGEST_LENGTH=16;var s=function(){function l(f){this.digestLength=i.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var g=f[0]|f[1]<<8;this._r[0]=g&8191;var p=f[2]|f[3]<<8;this._r[1]=(g>>>13|p<<3)&8191;var v=f[4]|f[5]<<8;this._r[2]=(p>>>10|v<<6)&7939;var w=f[6]|f[7]<<8;this._r[3]=(v>>>7|w<<9)&8191;var E=f[8]|f[9]<<8;this._r[4]=(w>>>4|E<<12)&255,this._r[5]=E>>>1&8190;var x=f[10]|f[11]<<8;this._r[6]=(E>>>14|x<<2)&8191;var I=f[12]|f[13]<<8;this._r[7]=(x>>>11|I<<5)&8065;var B=f[14]|f[15]<<8;this._r[8]=(I>>>8|B<<8)&8191,this._r[9]=B>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return l.prototype._blocks=function(f,g,p){for(var v=this._fin?0:2048,w=this._h[0],E=this._h[1],x=this._h[2],I=this._h[3],B=this._h[4],K=this._h[5],Z=this._h[6],$=this._h[7],L=this._h[8],P=this._h[9],C=this._r[0],A=this._r[1],h=this._r[2],b=this._r[3],ee=this._r[4],ne=this._r[5],ue=this._r[6],ge=this._r[7],ye=this._r[8],S=this._r[9];p>=16;){var R=f[g+0]|f[g+1]<<8;w+=R&8191;var X=f[g+2]|f[g+3]<<8;E+=(R>>>13|X<<3)&8191;var J=f[g+4]|f[g+5]<<8;x+=(X>>>10|J<<6)&8191;var k=f[g+6]|f[g+7]<<8;I+=(J>>>7|k<<9)&8191;var V=f[g+8]|f[g+9]<<8;B+=(k>>>4|V<<12)&8191,K+=V>>>1&8191;var te=f[g+10]|f[g+11]<<8;Z+=(V>>>14|te<<2)&8191;var ie=f[g+12]|f[g+13]<<8;$+=(te>>>11|ie<<5)&8191;var De=f[g+14]|f[g+15]<<8;L+=(ie>>>8|De<<8)&8191,P+=De>>>5|v;var oe=0,Se=oe;Se+=w*C,Se+=E*(5*S),Se+=x*(5*ye),Se+=I*(5*ge),Se+=B*(5*ue),oe=Se>>>13,Se&=8191,Se+=K*(5*ne),Se+=Z*(5*ee),Se+=$*(5*b),Se+=L*(5*h),Se+=P*(5*A),oe+=Se>>>13,Se&=8191;var le=oe;le+=w*A,le+=E*C,le+=x*(5*S),le+=I*(5*ye),le+=B*(5*ge),oe=le>>>13,le&=8191,le+=K*(5*ue),le+=Z*(5*ne),le+=$*(5*ee),le+=L*(5*b),le+=P*(5*h),oe+=le>>>13,le&=8191;var Ae=oe;Ae+=w*h,Ae+=E*A,Ae+=x*C,Ae+=I*(5*S),Ae+=B*(5*ye),oe=Ae>>>13,Ae&=8191,Ae+=K*(5*ge),Ae+=Z*(5*ue),Ae+=$*(5*ne),Ae+=L*(5*ee),Ae+=P*(5*b),oe+=Ae>>>13,Ae&=8191;var z=oe;z+=w*b,z+=E*h,z+=x*A,z+=I*C,z+=B*(5*S),oe=z>>>13,z&=8191,z+=K*(5*ye),z+=Z*(5*ge),z+=$*(5*ue),z+=L*(5*ne),z+=P*(5*ee),oe+=z>>>13,z&=8191;var F=oe;F+=w*ee,F+=E*b,F+=x*h,F+=I*A,F+=B*C,oe=F>>>13,F&=8191,F+=K*(5*S),F+=Z*(5*ye),F+=$*(5*ge),F+=L*(5*ue),F+=P*(5*ne),oe+=F>>>13,F&=8191;var U=oe;U+=w*ne,U+=E*ee,U+=x*b,U+=I*h,U+=B*A,oe=U>>>13,U&=8191,U+=K*C,U+=Z*(5*S),U+=$*(5*ye),U+=L*(5*ge),U+=P*(5*ue),oe+=U>>>13,U&=8191;var d=oe;d+=w*ue,d+=E*ne,d+=x*ee,d+=I*b,d+=B*h,oe=d>>>13,d&=8191,d+=K*A,d+=Z*C,d+=$*(5*S),d+=L*(5*ye),d+=P*(5*ge),oe+=d>>>13,d&=8191;var T=oe;T+=w*ge,T+=E*ue,T+=x*ne,T+=I*ee,T+=B*b,oe=T>>>13,T&=8191,T+=K*h,T+=Z*A,T+=$*C,T+=L*(5*S),T+=P*(5*ye),oe+=T>>>13,T&=8191;var se=oe;se+=w*ye,se+=E*ge,se+=x*ue,se+=I*ne,se+=B*ee,oe=se>>>13,se&=8191,se+=K*b,se+=Z*h,se+=$*A,se+=L*C,se+=P*(5*S),oe+=se>>>13,se&=8191;var he=oe;he+=w*S,he+=E*ye,he+=x*ge,he+=I*ue,he+=B*ne,oe=he>>>13,he&=8191,he+=K*ee,he+=Z*b,he+=$*h,he+=L*A,he+=P*C,oe+=he>>>13,he&=8191,oe=(oe<<2)+oe|0,oe=oe+Se|0,Se=oe&8191,oe=oe>>>13,le+=oe,w=Se,E=le,x=Ae,I=z,B=F,K=U,Z=d,$=T,L=se,P=he,g+=16,p-=16}this._h[0]=w,this._h[1]=E,this._h[2]=x,this._h[3]=I,this._h[4]=B,this._h[5]=K,this._h[6]=Z,this._h[7]=$,this._h[8]=L,this._h[9]=P},l.prototype.finish=function(f,g){g===void 0&&(g=0);var p=new Uint16Array(10),v,w,E,x;if(this._leftover){for(x=this._leftover,this._buffer[x++]=1;x<16;x++)this._buffer[x]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(v=this._h[1]>>>13,this._h[1]&=8191,x=2;x<10;x++)this._h[x]+=v,v=this._h[x]>>>13,this._h[x]&=8191;for(this._h[0]+=v*5,v=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=v,v=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=v,p[0]=this._h[0]+5,v=p[0]>>>13,p[0]&=8191,x=1;x<10;x++)p[x]=this._h[x]+v,v=p[x]>>>13,p[x]&=8191;for(p[9]-=8192,w=(v^1)-1,x=0;x<10;x++)p[x]&=w;for(w=~w,x=0;x<10;x++)this._h[x]=this._h[x]&w|p[x];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,E=this._h[0]+this._pad[0],this._h[0]=E&65535,x=1;x<8;x++)E=(this._h[x]+this._pad[x]|0)+(E>>>16)|0,this._h[x]=E&65535;return f[g+0]=this._h[0]>>>0,f[g+1]=this._h[0]>>>8,f[g+2]=this._h[1]>>>0,f[g+3]=this._h[1]>>>8,f[g+4]=this._h[2]>>>0,f[g+5]=this._h[2]>>>8,f[g+6]=this._h[3]>>>0,f[g+7]=this._h[3]>>>8,f[g+8]=this._h[4]>>>0,f[g+9]=this._h[4]>>>8,f[g+10]=this._h[5]>>>0,f[g+11]=this._h[5]>>>8,f[g+12]=this._h[6]>>>0,f[g+13]=this._h[6]>>>8,f[g+14]=this._h[7]>>>0,f[g+15]=this._h[7]>>>8,this._finished=!0,this},l.prototype.update=function(f){var g=0,p=f.length,v;if(this._leftover){v=16-this._leftover,v>p&&(v=p);for(var w=0;w<v;w++)this._buffer[this._leftover+w]=f[g+w];if(p-=v,g+=v,this._leftover+=v,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(p>=16&&(v=p-p%16,this._blocks(f,g,v),g+=v,p-=v),p){for(var w=0;w<p;w++)this._buffer[this._leftover+w]=f[g+w];this._leftover+=p}return this},l.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},l.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},l}();i.Poly1305=s;function o(l,f){var g=new s(l);g.update(f);var p=g.digest();return g.clean(),p}i.oneTimeAuth=o;function c(l,f){return l.length!==i.DIGEST_LENGTH||f.length!==i.DIGEST_LENGTH?!1:e.equal(l,f)}i.equal=c})(ep);(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=ua,t=ep,s=Cr,o=je,c=Fi;i.KEY_LENGTH=32,i.NONCE_LENGTH=12,i.TAG_LENGTH=16;var l=new Uint8Array(16),f=function(){function g(p){if(this.nonceLength=i.NONCE_LENGTH,this.tagLength=i.TAG_LENGTH,p.length!==i.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(p)}return g.prototype.seal=function(p,v,w,E){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var x=new Uint8Array(16);x.set(p,x.length-p.length);var I=new Uint8Array(32);e.stream(this._key,x,I,4);var B=v.length+this.tagLength,K;if(E){if(E.length!==B)throw new Error("ChaCha20Poly1305: incorrect destination length");K=E}else K=new Uint8Array(B);return e.streamXOR(this._key,x,v,K,4),this._authenticate(K.subarray(K.length-this.tagLength,K.length),I,K.subarray(0,K.length-this.tagLength),w),s.wipe(x),K},g.prototype.open=function(p,v,w,E){if(p.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(v.length<this.tagLength)return null;var x=new Uint8Array(16);x.set(p,x.length-p.length);var I=new Uint8Array(32);e.stream(this._key,x,I,4);var B=new Uint8Array(this.tagLength);if(this._authenticate(B,I,v.subarray(0,v.length-this.tagLength),w),!c.equal(B,v.subarray(v.length-this.tagLength,v.length)))return null;var K=v.length-this.tagLength,Z;if(E){if(E.length!==K)throw new Error("ChaCha20Poly1305: incorrect destination length");Z=E}else Z=new Uint8Array(K);return e.streamXOR(this._key,x,v.subarray(0,v.length-this.tagLength),Z,4),s.wipe(x),Z},g.prototype.clean=function(){return s.wipe(this._key),this},g.prototype._authenticate=function(p,v,w,E){var x=new t.Poly1305(v);E&&(x.update(E),E.length%16>0&&x.update(l.subarray(E.length%16))),x.update(w),w.length%16>0&&x.update(l.subarray(w.length%16));var I=new Uint8Array(8);E&&o.writeUint64LE(E.length,I),x.update(I),o.writeUint64LE(w.length,I),x.update(I);for(var B=x.digest(),K=0;K<B.length;K++)p[K]=B[K];x.clean(),s.wipe(B),s.wipe(I)},g}();i.ChaCha20Poly1305=f})(Gu);var rp={},Rs={},Wu={};Object.defineProperty(Wu,"__esModule",{value:!0});function m1(i){return typeof i.saveState<"u"&&typeof i.restoreState<"u"&&typeof i.cleanSavedState<"u"}Wu.isSerializableHash=m1;Object.defineProperty(Rs,"__esModule",{value:!0});var ri=Wu,_1=Fi,w1=Cr,ip=function(){function i(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(s).clean():s.set(t);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),ri.isSerializableHash(this._inner)&&ri.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),w1.wipe(s)}return i.prototype.reset=function(){if(!ri.isSerializableHash(this._inner)||!ri.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.clean=function(){ri.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),ri.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},i.prototype.update=function(e){return this._inner.update(e),this},i.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},i.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},i.prototype.saveState=function(){if(!ri.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},i.prototype.restoreState=function(e){if(!ri.isSerializableHash(this._inner)||!ri.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.cleanSavedState=function(e){if(!ri.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},i}();Rs.HMAC=ip;function b1(i,e,t){var s=new ip(i,e);s.update(t);var o=s.digest();return s.clean(),o}Rs.hmac=b1;Rs.equal=_1.equal;Object.defineProperty(rp,"__esModule",{value:!0});var pf=Rs,gf=Cr,E1=function(){function i(e,t,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=o;var c=pf.hmac(this._hash,s,t);this._hmac=new pf.HMAC(e,c),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return i.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},i.prototype.expand=function(e){for(var t=new Uint8Array(e),s=0;s<t.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[s]=this._buffer[this._bufpos++];return t},i.prototype.clean=function(){this._hmac.clean(),gf.wipe(this._buffer),gf.wipe(this._counter),this._bufpos=0},i}(),D1=rp.HKDF=E1,zn={},ha={},la={};Object.defineProperty(la,"__esModule",{value:!0});la.BrowserRandomSource=void 0;const yf=65536;class S1{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let s=0;s<t.length;s+=yf)this._crypto.getRandomValues(t.subarray(s,s+Math.min(t.length-s,yf)));return t}}la.BrowserRandomSource=S1;function I1(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var fa={};Object.defineProperty(fa,"__esModule",{value:!0});fa.NodeRandomSource=void 0;const x1=Cr;class P1{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof I1<"u"){const e=Bw;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let o=0;o<s.length;o++)s[o]=t[o];return(0,x1.wipe)(t),s}}fa.NodeRandomSource=P1;Object.defineProperty(ha,"__esModule",{value:!0});ha.SystemRandomSource=void 0;const O1=la,C1=fa;class A1{constructor(){if(this.isAvailable=!1,this.name="",this._source=new O1.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new C1.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}ha.SystemRandomSource=A1;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.randomStringForEntropy=i.randomString=i.randomUint32=i.randomBytes=i.defaultRandomSource=void 0;const e=ha,t=je,s=Cr;i.defaultRandomSource=new e.SystemRandomSource;function o(p,v=i.defaultRandomSource){return v.randomBytes(p)}i.randomBytes=o;function c(p=i.defaultRandomSource){const v=o(4,p),w=(0,t.readUint32LE)(v);return(0,s.wipe)(v),w}i.randomUint32=c;const l="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(p,v=l,w=i.defaultRandomSource){if(v.length<2)throw new Error("randomString charset is too short");if(v.length>256)throw new Error("randomString charset is too long");let E="";const x=v.length,I=256-256%x;for(;p>0;){const B=o(Math.ceil(p*256/I),w);for(let K=0;K<B.length&&p>0;K++){const Z=B[K];Z<I&&(E+=v.charAt(Z%x),p--)}(0,s.wipe)(B)}return E}i.randomString=f;function g(p,v=l,w=i.defaultRandomSource){const E=Math.ceil(p/(Math.log(v.length)/Math.LN2));return f(E,v,w)}i.randomStringForEntropy=g})(zn);var da={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=je,t=Cr;i.DIGEST_LENGTH=32,i.BLOCK_SIZE=64;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},f.prototype.update=function(g,p){if(p===void 0&&(p=g.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var v=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&p>0;)this._buffer[this._bufferLength++]=g[v++],p--;this._bufferLength===this.blockSize&&(c(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(v=c(this._temp,this._state,g,v,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=g[v++],p--;return this},f.prototype.finish=function(g){if(!this._finished){var p=this._bytesHashed,v=this._bufferLength,w=p/536870912|0,E=p<<3,x=p%64<56?64:128;this._buffer[v]=128;for(var I=v+1;I<x-8;I++)this._buffer[I]=0;e.writeUint32BE(w,this._buffer,x-8),e.writeUint32BE(E,this._buffer,x-4),c(this._temp,this._state,this._buffer,0,x),this._finished=!0}for(var I=0;I<this.digestLength/4;I++)e.writeUint32BE(this._state[I],g,I*4);return this},f.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(g){return this._state.set(g.state),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(g){t.wipe(g.state),g.buffer&&t.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},f}();i.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function c(f,g,p,v,w){for(;w>=64;){for(var E=g[0],x=g[1],I=g[2],B=g[3],K=g[4],Z=g[5],$=g[6],L=g[7],P=0;P<16;P++){var C=v+P*4;f[P]=e.readUint32BE(p,C)}for(var P=16;P<64;P++){var A=f[P-2],h=(A>>>17|A<<15)^(A>>>19|A<<13)^A>>>10;A=f[P-15];var b=(A>>>7|A<<25)^(A>>>18|A<<14)^A>>>3;f[P]=(h+f[P-7]|0)+(b+f[P-16]|0)}for(var P=0;P<64;P++){var h=(((K>>>6|K<<26)^(K>>>11|K<<21)^(K>>>25|K<<7))+(K&Z^~K&$)|0)+(L+(o[P]+f[P]|0)|0)|0,b=((E>>>2|E<<30)^(E>>>13|E<<19)^(E>>>22|E<<10))+(E&x^E&I^x&I)|0;L=$,$=Z,Z=K,K=B+h|0,B=I,I=x,x=E,E=h+b|0}g[0]+=E,g[1]+=x,g[2]+=I,g[3]+=B,g[4]+=K,g[5]+=Z,g[6]+=$,g[7]+=L,v+=64,w-=64}return v}function l(f){var g=new s;g.update(f);var p=g.digest();return g.clean(),p}i.hash=l})(da);var Yu={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.sharedKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.scalarMultBase=i.scalarMult=i.SHARED_KEY_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=void 0;const e=zn,t=Cr;i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=32,i.SHARED_KEY_LENGTH=32;function s(P){const C=new Float64Array(16);if(P)for(let A=0;A<P.length;A++)C[A]=P[A];return C}const o=new Uint8Array(32);o[0]=9;const c=s([56129,1]);function l(P){let C=1;for(let A=0;A<16;A++){let h=P[A]+C+65535;C=Math.floor(h/65536),P[A]=h-C*65536}P[0]+=C-1+37*(C-1)}function f(P,C,A){const h=~(A-1);for(let b=0;b<16;b++){const ee=h&(P[b]^C[b]);P[b]^=ee,C[b]^=ee}}function g(P,C){const A=s(),h=s();for(let b=0;b<16;b++)h[b]=C[b];l(h),l(h),l(h);for(let b=0;b<2;b++){A[0]=h[0]-65517;for(let ne=1;ne<15;ne++)A[ne]=h[ne]-65535-(A[ne-1]>>16&1),A[ne-1]&=65535;A[15]=h[15]-32767-(A[14]>>16&1);const ee=A[15]>>16&1;A[14]&=65535,f(h,A,1-ee)}for(let b=0;b<16;b++)P[2*b]=h[b]&255,P[2*b+1]=h[b]>>8}function p(P,C){for(let A=0;A<16;A++)P[A]=C[2*A]+(C[2*A+1]<<8);P[15]&=32767}function v(P,C,A){for(let h=0;h<16;h++)P[h]=C[h]+A[h]}function w(P,C,A){for(let h=0;h<16;h++)P[h]=C[h]-A[h]}function E(P,C,A){let h,b,ee=0,ne=0,ue=0,ge=0,ye=0,S=0,R=0,X=0,J=0,k=0,V=0,te=0,ie=0,De=0,oe=0,Se=0,le=0,Ae=0,z=0,F=0,U=0,d=0,T=0,se=0,he=0,Ee=0,He=0,ke=0,Le=0,dt=0,pt=0,qe=A[0],Ie=A[1],Ne=A[2],$e=A[3],Fe=A[4],Pe=A[5],Ue=A[6],be=A[7],Oe=A[8],Be=A[9],xe=A[10],Ve=A[11],We=A[12],Ze=A[13],et=A[14],Je=A[15];h=C[0],ee+=h*qe,ne+=h*Ie,ue+=h*Ne,ge+=h*$e,ye+=h*Fe,S+=h*Pe,R+=h*Ue,X+=h*be,J+=h*Oe,k+=h*Be,V+=h*xe,te+=h*Ve,ie+=h*We,De+=h*Ze,oe+=h*et,Se+=h*Je,h=C[1],ne+=h*qe,ue+=h*Ie,ge+=h*Ne,ye+=h*$e,S+=h*Fe,R+=h*Pe,X+=h*Ue,J+=h*be,k+=h*Oe,V+=h*Be,te+=h*xe,ie+=h*Ve,De+=h*We,oe+=h*Ze,Se+=h*et,le+=h*Je,h=C[2],ue+=h*qe,ge+=h*Ie,ye+=h*Ne,S+=h*$e,R+=h*Fe,X+=h*Pe,J+=h*Ue,k+=h*be,V+=h*Oe,te+=h*Be,ie+=h*xe,De+=h*Ve,oe+=h*We,Se+=h*Ze,le+=h*et,Ae+=h*Je,h=C[3],ge+=h*qe,ye+=h*Ie,S+=h*Ne,R+=h*$e,X+=h*Fe,J+=h*Pe,k+=h*Ue,V+=h*be,te+=h*Oe,ie+=h*Be,De+=h*xe,oe+=h*Ve,Se+=h*We,le+=h*Ze,Ae+=h*et,z+=h*Je,h=C[4],ye+=h*qe,S+=h*Ie,R+=h*Ne,X+=h*$e,J+=h*Fe,k+=h*Pe,V+=h*Ue,te+=h*be,ie+=h*Oe,De+=h*Be,oe+=h*xe,Se+=h*Ve,le+=h*We,Ae+=h*Ze,z+=h*et,F+=h*Je,h=C[5],S+=h*qe,R+=h*Ie,X+=h*Ne,J+=h*$e,k+=h*Fe,V+=h*Pe,te+=h*Ue,ie+=h*be,De+=h*Oe,oe+=h*Be,Se+=h*xe,le+=h*Ve,Ae+=h*We,z+=h*Ze,F+=h*et,U+=h*Je,h=C[6],R+=h*qe,X+=h*Ie,J+=h*Ne,k+=h*$e,V+=h*Fe,te+=h*Pe,ie+=h*Ue,De+=h*be,oe+=h*Oe,Se+=h*Be,le+=h*xe,Ae+=h*Ve,z+=h*We,F+=h*Ze,U+=h*et,d+=h*Je,h=C[7],X+=h*qe,J+=h*Ie,k+=h*Ne,V+=h*$e,te+=h*Fe,ie+=h*Pe,De+=h*Ue,oe+=h*be,Se+=h*Oe,le+=h*Be,Ae+=h*xe,z+=h*Ve,F+=h*We,U+=h*Ze,d+=h*et,T+=h*Je,h=C[8],J+=h*qe,k+=h*Ie,V+=h*Ne,te+=h*$e,ie+=h*Fe,De+=h*Pe,oe+=h*Ue,Se+=h*be,le+=h*Oe,Ae+=h*Be,z+=h*xe,F+=h*Ve,U+=h*We,d+=h*Ze,T+=h*et,se+=h*Je,h=C[9],k+=h*qe,V+=h*Ie,te+=h*Ne,ie+=h*$e,De+=h*Fe,oe+=h*Pe,Se+=h*Ue,le+=h*be,Ae+=h*Oe,z+=h*Be,F+=h*xe,U+=h*Ve,d+=h*We,T+=h*Ze,se+=h*et,he+=h*Je,h=C[10],V+=h*qe,te+=h*Ie,ie+=h*Ne,De+=h*$e,oe+=h*Fe,Se+=h*Pe,le+=h*Ue,Ae+=h*be,z+=h*Oe,F+=h*Be,U+=h*xe,d+=h*Ve,T+=h*We,se+=h*Ze,he+=h*et,Ee+=h*Je,h=C[11],te+=h*qe,ie+=h*Ie,De+=h*Ne,oe+=h*$e,Se+=h*Fe,le+=h*Pe,Ae+=h*Ue,z+=h*be,F+=h*Oe,U+=h*Be,d+=h*xe,T+=h*Ve,se+=h*We,he+=h*Ze,Ee+=h*et,He+=h*Je,h=C[12],ie+=h*qe,De+=h*Ie,oe+=h*Ne,Se+=h*$e,le+=h*Fe,Ae+=h*Pe,z+=h*Ue,F+=h*be,U+=h*Oe,d+=h*Be,T+=h*xe,se+=h*Ve,he+=h*We,Ee+=h*Ze,He+=h*et,ke+=h*Je,h=C[13],De+=h*qe,oe+=h*Ie,Se+=h*Ne,le+=h*$e,Ae+=h*Fe,z+=h*Pe,F+=h*Ue,U+=h*be,d+=h*Oe,T+=h*Be,se+=h*xe,he+=h*Ve,Ee+=h*We,He+=h*Ze,ke+=h*et,Le+=h*Je,h=C[14],oe+=h*qe,Se+=h*Ie,le+=h*Ne,Ae+=h*$e,z+=h*Fe,F+=h*Pe,U+=h*Ue,d+=h*be,T+=h*Oe,se+=h*Be,he+=h*xe,Ee+=h*Ve,He+=h*We,ke+=h*Ze,Le+=h*et,dt+=h*Je,h=C[15],Se+=h*qe,le+=h*Ie,Ae+=h*Ne,z+=h*$e,F+=h*Fe,U+=h*Pe,d+=h*Ue,T+=h*be,se+=h*Oe,he+=h*Be,Ee+=h*xe,He+=h*Ve,ke+=h*We,Le+=h*Ze,dt+=h*et,pt+=h*Je,ee+=38*le,ne+=38*Ae,ue+=38*z,ge+=38*F,ye+=38*U,S+=38*d,R+=38*T,X+=38*se,J+=38*he,k+=38*Ee,V+=38*He,te+=38*ke,ie+=38*Le,De+=38*dt,oe+=38*pt,b=1,h=ee+b+65535,b=Math.floor(h/65536),ee=h-b*65536,h=ne+b+65535,b=Math.floor(h/65536),ne=h-b*65536,h=ue+b+65535,b=Math.floor(h/65536),ue=h-b*65536,h=ge+b+65535,b=Math.floor(h/65536),ge=h-b*65536,h=ye+b+65535,b=Math.floor(h/65536),ye=h-b*65536,h=S+b+65535,b=Math.floor(h/65536),S=h-b*65536,h=R+b+65535,b=Math.floor(h/65536),R=h-b*65536,h=X+b+65535,b=Math.floor(h/65536),X=h-b*65536,h=J+b+65535,b=Math.floor(h/65536),J=h-b*65536,h=k+b+65535,b=Math.floor(h/65536),k=h-b*65536,h=V+b+65535,b=Math.floor(h/65536),V=h-b*65536,h=te+b+65535,b=Math.floor(h/65536),te=h-b*65536,h=ie+b+65535,b=Math.floor(h/65536),ie=h-b*65536,h=De+b+65535,b=Math.floor(h/65536),De=h-b*65536,h=oe+b+65535,b=Math.floor(h/65536),oe=h-b*65536,h=Se+b+65535,b=Math.floor(h/65536),Se=h-b*65536,ee+=b-1+37*(b-1),b=1,h=ee+b+65535,b=Math.floor(h/65536),ee=h-b*65536,h=ne+b+65535,b=Math.floor(h/65536),ne=h-b*65536,h=ue+b+65535,b=Math.floor(h/65536),ue=h-b*65536,h=ge+b+65535,b=Math.floor(h/65536),ge=h-b*65536,h=ye+b+65535,b=Math.floor(h/65536),ye=h-b*65536,h=S+b+65535,b=Math.floor(h/65536),S=h-b*65536,h=R+b+65535,b=Math.floor(h/65536),R=h-b*65536,h=X+b+65535,b=Math.floor(h/65536),X=h-b*65536,h=J+b+65535,b=Math.floor(h/65536),J=h-b*65536,h=k+b+65535,b=Math.floor(h/65536),k=h-b*65536,h=V+b+65535,b=Math.floor(h/65536),V=h-b*65536,h=te+b+65535,b=Math.floor(h/65536),te=h-b*65536,h=ie+b+65535,b=Math.floor(h/65536),ie=h-b*65536,h=De+b+65535,b=Math.floor(h/65536),De=h-b*65536,h=oe+b+65535,b=Math.floor(h/65536),oe=h-b*65536,h=Se+b+65535,b=Math.floor(h/65536),Se=h-b*65536,ee+=b-1+37*(b-1),P[0]=ee,P[1]=ne,P[2]=ue,P[3]=ge,P[4]=ye,P[5]=S,P[6]=R,P[7]=X,P[8]=J,P[9]=k,P[10]=V,P[11]=te,P[12]=ie,P[13]=De,P[14]=oe,P[15]=Se}function x(P,C){E(P,C,C)}function I(P,C){const A=s();for(let h=0;h<16;h++)A[h]=C[h];for(let h=253;h>=0;h--)x(A,A),h!==2&&h!==4&&E(A,A,C);for(let h=0;h<16;h++)P[h]=A[h]}function B(P,C){const A=new Uint8Array(32),h=new Float64Array(80),b=s(),ee=s(),ne=s(),ue=s(),ge=s(),ye=s();for(let J=0;J<31;J++)A[J]=P[J];A[31]=P[31]&127|64,A[0]&=248,p(h,C);for(let J=0;J<16;J++)ee[J]=h[J];b[0]=ue[0]=1;for(let J=254;J>=0;--J){const k=A[J>>>3]>>>(J&7)&1;f(b,ee,k),f(ne,ue,k),v(ge,b,ne),w(b,b,ne),v(ne,ee,ue),w(ee,ee,ue),x(ue,ge),x(ye,b),E(b,ne,b),E(ne,ee,ge),v(ge,b,ne),w(b,b,ne),x(ee,b),w(ne,ue,ye),E(b,ne,c),v(b,b,ue),E(ne,ne,b),E(b,ue,ye),E(ue,ee,h),x(ee,ge),f(b,ee,k),f(ne,ue,k)}for(let J=0;J<16;J++)h[J+16]=b[J],h[J+32]=ne[J],h[J+48]=ee[J],h[J+64]=ue[J];const S=h.subarray(32),R=h.subarray(16);I(S,S),E(R,R,S);const X=new Uint8Array(32);return g(X,R),X}i.scalarMult=B;function K(P){return B(P,o)}i.scalarMultBase=K;function Z(P){if(P.length!==i.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${i.SECRET_KEY_LENGTH} bytes`);const C=new Uint8Array(P);return{publicKey:K(C),secretKey:C}}i.generateKeyPairFromSeed=Z;function $(P){const C=(0,e.randomBytes)(32,P),A=Z(C);return(0,t.wipe)(C),A}i.generateKeyPair=$;function L(P,C,A=!1){if(P.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(C.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const h=B(P,C);if(A){let b=0;for(let ee=0;ee<h.length;ee++)b|=h[ee];if(b===0)throw new Error("X25519: invalid shared key")}return h}i.sharedKey=L})(Yu);function Ju(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function np(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Ju(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function Eu(i,e){e||(e=i.reduce((o,c)=>o+c.length,0));const t=np(e);let s=0;for(const o of i)t.set(o,s),s+=o.length;return Ju(t)}function T1(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<i.length;o++){var c=i.charAt(o),l=c.charCodeAt(0);if(t[l]!==255)throw new TypeError(c+" is ambiguous");t[l]=o}var f=i.length,g=i.charAt(0),p=Math.log(f)/Math.log(256),v=Math.log(256)/Math.log(f);function w(I){if(I instanceof Uint8Array||(ArrayBuffer.isView(I)?I=new Uint8Array(I.buffer,I.byteOffset,I.byteLength):Array.isArray(I)&&(I=Uint8Array.from(I))),!(I instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(I.length===0)return"";for(var B=0,K=0,Z=0,$=I.length;Z!==$&&I[Z]===0;)Z++,B++;for(var L=($-Z)*v+1>>>0,P=new Uint8Array(L);Z!==$;){for(var C=I[Z],A=0,h=L-1;(C!==0||A<K)&&h!==-1;h--,A++)C+=256*P[h]>>>0,P[h]=C%f>>>0,C=C/f>>>0;if(C!==0)throw new Error("Non-zero carry");K=A,Z++}for(var b=L-K;b!==L&&P[b]===0;)b++;for(var ee=g.repeat(B);b<L;++b)ee+=i.charAt(P[b]);return ee}function E(I){if(typeof I!="string")throw new TypeError("Expected String");if(I.length===0)return new Uint8Array;var B=0;if(I[B]!==" "){for(var K=0,Z=0;I[B]===g;)K++,B++;for(var $=(I.length-B)*p+1>>>0,L=new Uint8Array($);I[B];){var P=t[I.charCodeAt(B)];if(P===255)return;for(var C=0,A=$-1;(P!==0||C<Z)&&A!==-1;A--,C++)P+=f*L[A]>>>0,L[A]=P%256>>>0,P=P/256>>>0;if(P!==0)throw new Error("Non-zero carry");Z=C,B++}if(I[B]!==" "){for(var h=$-Z;h!==$&&L[h]===0;)h++;for(var b=new Uint8Array(K+($-h)),ee=K;h!==$;)b[ee++]=L[h++];return b}}}function x(I){var B=E(I);if(B)return B;throw new Error(`Non-${e} character`)}return{encode:w,decodeUnsafe:E,decode:x}}var R1=T1,N1=R1;const $1=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},U1=i=>new TextEncoder().encode(i),j1=i=>new TextDecoder().decode(i);class L1{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class M1{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return sp(this,e)}}class q1{constructor(e){this.decoders=e}or(e){return sp(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const sp=(i,e)=>new q1({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}});class F1{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new L1(e,t,s),this.decoder=new M1(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const pa=({name:i,prefix:e,encode:t,decode:s})=>new F1(i,e,t,s),Ns=({prefix:i,name:e,alphabet:t})=>{const{encode:s,decode:o}=N1(t,e);return pa({prefix:i,name:e,encode:s,decode:c=>$1(o(c))})},z1=(i,e,t,s)=>{const o={};for(let v=0;v<e.length;++v)o[e[v]]=v;let c=i.length;for(;i[c-1]==="=";)--c;const l=new Uint8Array(c*t/8|0);let f=0,g=0,p=0;for(let v=0;v<c;++v){const w=o[i[v]];if(w===void 0)throw new SyntaxError(`Non-${s} character`);g=g<<t|w,f+=t,f>=8&&(f-=8,l[p++]=255&g>>f)}if(f>=t||255&g<<8-f)throw new SyntaxError("Unexpected end of data");return l},H1=(i,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",l=0,f=0;for(let g=0;g<i.length;++g)for(f=f<<8|i[g],l+=8;l>t;)l-=t,c+=e[o&f>>l];if(l&&(c+=e[o&f<<t-l]),s)for(;c.length*t&7;)c+="=";return c},Wt=({name:i,prefix:e,bitsPerChar:t,alphabet:s})=>pa({prefix:e,name:i,encode(o){return H1(o,s,t)},decode(o){return z1(o,s,t,i)}}),B1=pa({prefix:"\0",name:"identity",encode:i=>j1(i),decode:i=>U1(i)}),K1=Object.freeze(Object.defineProperty({__proto__:null,identity:B1},Symbol.toStringTag,{value:"Module"})),k1=Wt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),V1=Object.freeze(Object.defineProperty({__proto__:null,base2:k1},Symbol.toStringTag,{value:"Module"})),G1=Wt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),W1=Object.freeze(Object.defineProperty({__proto__:null,base8:G1},Symbol.toStringTag,{value:"Module"})),Y1=Ns({prefix:"9",name:"base10",alphabet:"0123456789"}),J1=Object.freeze(Object.defineProperty({__proto__:null,base10:Y1},Symbol.toStringTag,{value:"Module"})),Q1=Wt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),X1=Wt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Z1=Object.freeze(Object.defineProperty({__proto__:null,base16:Q1,base16upper:X1},Symbol.toStringTag,{value:"Module"})),eb=Wt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),tb=Wt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),rb=Wt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ib=Wt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),nb=Wt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),sb=Wt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ob=Wt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ab=Wt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),cb=Wt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),ub=Object.freeze(Object.defineProperty({__proto__:null,base32:eb,base32hex:nb,base32hexpad:ob,base32hexpadupper:ab,base32hexupper:sb,base32pad:rb,base32padupper:ib,base32upper:tb,base32z:cb},Symbol.toStringTag,{value:"Module"})),hb=Ns({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),lb=Ns({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),fb=Object.freeze(Object.defineProperty({__proto__:null,base36:hb,base36upper:lb},Symbol.toStringTag,{value:"Module"})),db=Ns({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),pb=Ns({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),gb=Object.freeze(Object.defineProperty({__proto__:null,base58btc:db,base58flickr:pb},Symbol.toStringTag,{value:"Module"})),yb=Wt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),vb=Wt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),mb=Wt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),_b=Wt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),wb=Object.freeze(Object.defineProperty({__proto__:null,base64:yb,base64pad:vb,base64url:mb,base64urlpad:_b},Symbol.toStringTag,{value:"Module"})),op=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),bb=op.reduce((i,e,t)=>(i[t]=e,i),[]),Eb=op.reduce((i,e,t)=>(i[e.codePointAt(0)]=t,i),[]);function Db(i){return i.reduce((e,t)=>(e+=bb[t],e),"")}function Sb(i){const e=[];for(const t of i){const s=Eb[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const Ib=pa({prefix:"🚀",name:"base256emoji",encode:Db,decode:Sb}),xb=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:Ib},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const vf={...K1,...V1,...W1,...J1,...Z1,...ub,...fb,...gb,...wb,...xb};function ap(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const mf=ap("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),Yc=ap("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=np(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),cp={utf8:mf,"utf-8":mf,hex:vf.base16,latin1:Yc,ascii:Yc,binary:Yc,...vf};function mr(i,e="utf8"){const t=cp[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Ju(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}function ur(i,e="utf8"){const t=cp[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(i.buffer,i.byteOffset,i.byteLength).toString("utf8"):t.encoder.encode(i).substring(1)}var ve={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Du=function(i,e){return Du=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Du(i,e)};function Pb(i,e){Du(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Su=function(){return Su=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Su.apply(this,arguments)};function Ob(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function Cb(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function Ab(i,e){return function(t,s){e(t,s,i)}}function Tb(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function Rb(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(v){try{p(s.next(v))}catch(w){l(w)}}function g(v){try{p(s.throw(v))}catch(w){l(w)}}function p(v){v.done?c(v.value):o(v.value).then(f,g)}p((s=s.apply(i,e||[])).next())})}function Nb(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(v){return g([p,v])}}function g(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(i,t)}catch(v){p=[6,v],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function $b(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function Ub(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function Iu(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function up(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function jb(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(up(arguments[e]));return i}function Lb(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function Ds(i){return this instanceof Ds?(this.v=i,this):new Ds(i)}function Mb(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(E){s[E]&&(o[E]=function(x){return new Promise(function(I,B){c.push([E,x,I,B])>1||f(E,x)})})}function f(E,x){try{g(s[E](x))}catch(I){w(c[0][3],I)}}function g(E){E.value instanceof Ds?Promise.resolve(E.value.v).then(p,v):w(c[0][2],E)}function p(E){f("next",E)}function v(E){f("throw",E)}function w(E,x){E(x),c.shift(),c.length&&f(c[0][0],c[0][1])}}function qb(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:Ds(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function Fb(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof Iu=="function"?Iu(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(f,g){l=i[c](l),o(f,g,l.done,l.value)})}}function o(c,l,f,g){Promise.resolve(g).then(function(p){c({value:p,done:f})},l)}}function zb(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function Hb(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function Bb(i){return i&&i.__esModule?i:{default:i}}function Kb(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function kb(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const Vb=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Su},__asyncDelegator:qb,__asyncGenerator:Mb,__asyncValues:Fb,__await:Ds,__awaiter:Rb,__classPrivateFieldGet:Kb,__classPrivateFieldSet:kb,__createBinding:$b,__decorate:Cb,__exportStar:Ub,__extends:Pb,__generator:Nb,__importDefault:Bb,__importStar:Hb,__makeTemplateObject:zb,__metadata:Tb,__param:Ab,__read:up,__rest:Ob,__spread:jb,__spreadArrays:Lb,__values:Iu},Symbol.toStringTag,{value:"Module"})),ga=Ts(Vb);var Jc={},fs={},_f;function Gb(){if(_f)return fs;_f=1,Object.defineProperty(fs,"__esModule",{value:!0}),fs.delay=void 0;function i(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return fs.delay=i,fs}var rn={},Qc={},nn={},wf;function Wb(){return wf||(wf=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.ONE_THOUSAND=nn.ONE_HUNDRED=void 0,nn.ONE_HUNDRED=100,nn.ONE_THOUSAND=1e3),nn}var Xc={},bf;function Yb(){return bf||(bf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ONE_YEAR=i.FOUR_WEEKS=i.THREE_WEEKS=i.TWO_WEEKS=i.ONE_WEEK=i.THIRTY_DAYS=i.SEVEN_DAYS=i.FIVE_DAYS=i.THREE_DAYS=i.ONE_DAY=i.TWENTY_FOUR_HOURS=i.TWELVE_HOURS=i.SIX_HOURS=i.THREE_HOURS=i.ONE_HOUR=i.SIXTY_MINUTES=i.THIRTY_MINUTES=i.TEN_MINUTES=i.FIVE_MINUTES=i.ONE_MINUTE=i.SIXTY_SECONDS=i.THIRTY_SECONDS=i.TEN_SECONDS=i.FIVE_SECONDS=i.ONE_SECOND=void 0,i.ONE_SECOND=1,i.FIVE_SECONDS=5,i.TEN_SECONDS=10,i.THIRTY_SECONDS=30,i.SIXTY_SECONDS=60,i.ONE_MINUTE=i.SIXTY_SECONDS,i.FIVE_MINUTES=i.ONE_MINUTE*5,i.TEN_MINUTES=i.ONE_MINUTE*10,i.THIRTY_MINUTES=i.ONE_MINUTE*30,i.SIXTY_MINUTES=i.ONE_MINUTE*60,i.ONE_HOUR=i.SIXTY_MINUTES,i.THREE_HOURS=i.ONE_HOUR*3,i.SIX_HOURS=i.ONE_HOUR*6,i.TWELVE_HOURS=i.ONE_HOUR*12,i.TWENTY_FOUR_HOURS=i.ONE_HOUR*24,i.ONE_DAY=i.TWENTY_FOUR_HOURS,i.THREE_DAYS=i.ONE_DAY*3,i.FIVE_DAYS=i.ONE_DAY*5,i.SEVEN_DAYS=i.ONE_DAY*7,i.THIRTY_DAYS=i.ONE_DAY*30,i.ONE_WEEK=i.SEVEN_DAYS,i.TWO_WEEKS=i.ONE_WEEK*2,i.THREE_WEEKS=i.ONE_WEEK*3,i.FOUR_WEEKS=i.ONE_WEEK*4,i.ONE_YEAR=i.ONE_DAY*365}(Xc)),Xc}var Ef;function hp(){return Ef||(Ef=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ga;e.__exportStar(Wb(),i),e.__exportStar(Yb(),i)}(Qc)),Qc}var Df;function Jb(){if(Df)return rn;Df=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.fromMiliseconds=rn.toMiliseconds=void 0;const i=hp();function e(s){return s*i.ONE_THOUSAND}rn.toMiliseconds=e;function t(s){return Math.floor(s/i.ONE_THOUSAND)}return rn.fromMiliseconds=t,rn}var Sf;function Qb(){return Sf||(Sf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ga;e.__exportStar(Gb(),i),e.__exportStar(Jb(),i)}(Jc)),Jc}var Nn={},If;function Xb(){if(If)return Nn;If=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.Watch=void 0;class i{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const s=this.get(t);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const o=Date.now()-s.started;this.timestamps.set(t,{started:s.started,elapsed:o})}get(t){const s=this.timestamps.get(t);if(typeof s>"u")throw new Error(`No timestamp found for label: ${t}`);return s}elapsed(t){const s=this.get(t);return s.elapsed||Date.now()-s.started}}return Nn.Watch=i,Nn.default=i,Nn}var Zc={},ds={},xf;function Zb(){if(xf)return ds;xf=1,Object.defineProperty(ds,"__esModule",{value:!0}),ds.IWatch=void 0;class i{}return ds.IWatch=i,ds}var Pf;function eE(){return Pf||(Pf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),ga.__exportStar(Zb(),i)}(Zc)),Zc}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ga;e.__exportStar(Qb(),i),e.__exportStar(Xb(),i),e.__exportStar(eE(),i),e.__exportStar(hp(),i)})(ve);var ht={};Object.defineProperty(ht,"__esModule",{value:!0});ht.getLocalStorage=ht.getLocalStorageOrThrow=ht.getCrypto=ht.getCryptoOrThrow=lp=ht.getLocation=ht.getLocationOrThrow=Xu=ht.getNavigator=ht.getNavigatorOrThrow=Qu=ht.getDocument=ht.getDocumentOrThrow=ht.getFromWindowOrThrow=ht.getFromWindow=void 0;function cn(i){let e;return typeof window<"u"&&typeof window[i]<"u"&&(e=window[i]),e}ht.getFromWindow=cn;function Hn(i){const e=cn(i);if(!e)throw new Error(`${i} is not defined in Window`);return e}ht.getFromWindowOrThrow=Hn;function tE(){return Hn("document")}ht.getDocumentOrThrow=tE;function rE(){return cn("document")}var Qu=ht.getDocument=rE;function iE(){return Hn("navigator")}ht.getNavigatorOrThrow=iE;function nE(){return cn("navigator")}var Xu=ht.getNavigator=nE;function sE(){return Hn("location")}ht.getLocationOrThrow=sE;function oE(){return cn("location")}var lp=ht.getLocation=oE;function aE(){return Hn("crypto")}ht.getCryptoOrThrow=aE;function cE(){return cn("crypto")}ht.getCrypto=cE;function uE(){return Hn("localStorage")}ht.getLocalStorageOrThrow=uE;function hE(){return cn("localStorage")}ht.getLocalStorage=hE;var Zu={};Object.defineProperty(Zu,"__esModule",{value:!0});var fp=Zu.getWindowMetadata=void 0;const Of=ht;function lE(){let i,e;try{i=Of.getDocumentOrThrow(),e=Of.getLocationOrThrow()}catch{return null}function t(){const w=i.getElementsByTagName("link"),E=[];for(let x=0;x<w.length;x++){const I=w[x],B=I.getAttribute("rel");if(B&&B.toLowerCase().indexOf("icon")>-1){const K=I.getAttribute("href");if(K)if(K.toLowerCase().indexOf("https:")===-1&&K.toLowerCase().indexOf("http:")===-1&&K.indexOf("//")!==0){let Z=e.protocol+"//"+e.host;if(K.indexOf("/")===0)Z+=K;else{const $=e.pathname.split("/");$.pop();const L=$.join("/");Z+=L+"/"+K}E.push(Z)}else if(K.indexOf("//")===0){const Z=e.protocol+K;E.push(Z)}else E.push(K)}}return E}function s(...w){const E=i.getElementsByTagName("meta");for(let x=0;x<E.length;x++){const I=E[x],B=["itemprop","property","name"].map(K=>I.getAttribute(K)).filter(K=>K?w.includes(K):!1);if(B.length&&B){const K=I.getAttribute("content");if(K)return K}}return""}function o(){let w=s("name","og:site_name","og:title","twitter:title");return w||(w=i.title),w}function c(){return s("description","og:description","twitter:description","keywords")}const l=o(),f=c(),g=e.origin,p=t();return{description:f,url:g,icons:p,name:l}}fp=Zu.getWindowMetadata=lE;var Ss={},fE=i=>encodeURIComponent(i).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),dp="%[a-f0-9]{2}",Cf=new RegExp("("+dp+")|([^%]+?)","gi"),Af=new RegExp("("+dp+")+","gi");function xu(i,e){try{return[decodeURIComponent(i.join(""))]}catch{}if(i.length===1)return i;e=e||1;var t=i.slice(0,e),s=i.slice(e);return Array.prototype.concat.call([],xu(t),xu(s))}function dE(i){try{return decodeURIComponent(i)}catch{for(var e=i.match(Cf)||[],t=1;t<e.length;t++)i=xu(e,t).join(""),e=i.match(Cf)||[];return i}}function pE(i){for(var e={"%FE%FF":"��","%FF%FE":"��"},t=Af.exec(i);t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{var s=dE(t[0]);s!==t[0]&&(e[t[0]]=s)}t=Af.exec(i)}e["%C2"]="�";for(var o=Object.keys(e),c=0;c<o.length;c++){var l=o[c];i=i.replace(new RegExp(l,"g"),e[l])}return i}var gE=function(i){if(typeof i!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof i+"`");try{return i=i.replace(/\+/g," "),decodeURIComponent(i)}catch{return pE(i)}},yE=(i,e)=>{if(!(typeof i=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[i];const t=i.indexOf(e);return t===-1?[i]:[i.slice(0,t),i.slice(t+e.length)]},vE=function(i,e){for(var t={},s=Object.keys(i),o=Array.isArray(e),c=0;c<s.length;c++){var l=s[c],f=i[l];(o?e.indexOf(l)!==-1:e(l,f,i))&&(t[l]=f)}return t};(function(i){const e=fE,t=gE,s=yE,o=vE,c=$=>$==null,l=Symbol("encodeFragmentIdentifier");function f($){switch($.arrayFormat){case"index":return L=>(P,C)=>{const A=P.length;return C===void 0||$.skipNull&&C===null||$.skipEmptyString&&C===""?P:C===null?[...P,[v(L,$),"[",A,"]"].join("")]:[...P,[v(L,$),"[",v(A,$),"]=",v(C,$)].join("")]};case"bracket":return L=>(P,C)=>C===void 0||$.skipNull&&C===null||$.skipEmptyString&&C===""?P:C===null?[...P,[v(L,$),"[]"].join("")]:[...P,[v(L,$),"[]=",v(C,$)].join("")];case"colon-list-separator":return L=>(P,C)=>C===void 0||$.skipNull&&C===null||$.skipEmptyString&&C===""?P:C===null?[...P,[v(L,$),":list="].join("")]:[...P,[v(L,$),":list=",v(C,$)].join("")];case"comma":case"separator":case"bracket-separator":{const L=$.arrayFormat==="bracket-separator"?"[]=":"=";return P=>(C,A)=>A===void 0||$.skipNull&&A===null||$.skipEmptyString&&A===""?C:(A=A===null?"":A,C.length===0?[[v(P,$),L,v(A,$)].join("")]:[[C,v(A,$)].join($.arrayFormatSeparator)])}default:return L=>(P,C)=>C===void 0||$.skipNull&&C===null||$.skipEmptyString&&C===""?P:C===null?[...P,v(L,$)]:[...P,[v(L,$),"=",v(C,$)].join("")]}}function g($){let L;switch($.arrayFormat){case"index":return(P,C,A)=>{if(L=/\[(\d*)\]$/.exec(P),P=P.replace(/\[\d*\]$/,""),!L){A[P]=C;return}A[P]===void 0&&(A[P]={}),A[P][L[1]]=C};case"bracket":return(P,C,A)=>{if(L=/(\[\])$/.exec(P),P=P.replace(/\[\]$/,""),!L){A[P]=C;return}if(A[P]===void 0){A[P]=[C];return}A[P]=[].concat(A[P],C)};case"colon-list-separator":return(P,C,A)=>{if(L=/(:list)$/.exec(P),P=P.replace(/:list$/,""),!L){A[P]=C;return}if(A[P]===void 0){A[P]=[C];return}A[P]=[].concat(A[P],C)};case"comma":case"separator":return(P,C,A)=>{const h=typeof C=="string"&&C.includes($.arrayFormatSeparator),b=typeof C=="string"&&!h&&w(C,$).includes($.arrayFormatSeparator);C=b?w(C,$):C;const ee=h||b?C.split($.arrayFormatSeparator).map(ne=>w(ne,$)):C===null?C:w(C,$);A[P]=ee};case"bracket-separator":return(P,C,A)=>{const h=/(\[\])$/.test(P);if(P=P.replace(/\[\]$/,""),!h){A[P]=C&&w(C,$);return}const b=C===null?[]:C.split($.arrayFormatSeparator).map(ee=>w(ee,$));if(A[P]===void 0){A[P]=b;return}A[P]=[].concat(A[P],b)};default:return(P,C,A)=>{if(A[P]===void 0){A[P]=C;return}A[P]=[].concat(A[P],C)}}}function p($){if(typeof $!="string"||$.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function v($,L){return L.encode?L.strict?e($):encodeURIComponent($):$}function w($,L){return L.decode?t($):$}function E($){return Array.isArray($)?$.sort():typeof $=="object"?E(Object.keys($)).sort((L,P)=>Number(L)-Number(P)).map(L=>$[L]):$}function x($){const L=$.indexOf("#");return L!==-1&&($=$.slice(0,L)),$}function I($){let L="";const P=$.indexOf("#");return P!==-1&&(L=$.slice(P)),L}function B($){$=x($);const L=$.indexOf("?");return L===-1?"":$.slice(L+1)}function K($,L){return L.parseNumbers&&!Number.isNaN(Number($))&&typeof $=="string"&&$.trim()!==""?$=Number($):L.parseBooleans&&$!==null&&($.toLowerCase()==="true"||$.toLowerCase()==="false")&&($=$.toLowerCase()==="true"),$}function Z($,L){L=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},L),p(L.arrayFormatSeparator);const P=g(L),C=Object.create(null);if(typeof $!="string"||($=$.trim().replace(/^[?#&]/,""),!$))return C;for(const A of $.split("&")){if(A==="")continue;let[h,b]=s(L.decode?A.replace(/\+/g," "):A,"=");b=b===void 0?null:["comma","separator","bracket-separator"].includes(L.arrayFormat)?b:w(b,L),P(w(h,L),b,C)}for(const A of Object.keys(C)){const h=C[A];if(typeof h=="object"&&h!==null)for(const b of Object.keys(h))h[b]=K(h[b],L);else C[A]=K(h,L)}return L.sort===!1?C:(L.sort===!0?Object.keys(C).sort():Object.keys(C).sort(L.sort)).reduce((A,h)=>{const b=C[h];return b&&typeof b=="object"&&!Array.isArray(b)?A[h]=E(b):A[h]=b,A},Object.create(null))}i.extract=B,i.parse=Z,i.stringify=($,L)=>{if(!$)return"";L=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},L),p(L.arrayFormatSeparator);const P=b=>L.skipNull&&c($[b])||L.skipEmptyString&&$[b]==="",C=f(L),A={};for(const b of Object.keys($))P(b)||(A[b]=$[b]);const h=Object.keys(A);return L.sort!==!1&&h.sort(L.sort),h.map(b=>{const ee=$[b];return ee===void 0?"":ee===null?v(b,L):Array.isArray(ee)?ee.length===0&&L.arrayFormat==="bracket-separator"?v(b,L)+"[]":ee.reduce(C(b),[]).join("&"):v(b,L)+"="+v(ee,L)}).filter(b=>b.length>0).join("&")},i.parseUrl=($,L)=>{L=Object.assign({decode:!0},L);const[P,C]=s($,"#");return Object.assign({url:P.split("?")[0]||"",query:Z(B($),L)},L&&L.parseFragmentIdentifier&&C?{fragmentIdentifier:w(C,L)}:{})},i.stringifyUrl=($,L)=>{L=Object.assign({encode:!0,strict:!0,[l]:!0},L);const P=x($.url).split("?")[0]||"",C=i.extract($.url),A=i.parse(C,{sort:!1}),h=Object.assign(A,$.query);let b=i.stringify(h,L);b&&(b=`?${b}`);let ee=I($.url);return $.fragmentIdentifier&&(ee=`#${L[l]?v($.fragmentIdentifier,L):$.fragmentIdentifier}`),`${P}${b}${ee}`},i.pick=($,L,P)=>{P=Object.assign({parseFragmentIdentifier:!0,[l]:!1},P);const{url:C,query:A,fragmentIdentifier:h}=i.parseUrl($,P);return i.stringifyUrl({url:C,query:o(A,L),fragmentIdentifier:h},P)},i.exclude=($,L,P)=>{const C=Array.isArray(L)?A=>!L.includes(A):(A,h)=>!L(A,h);return i.pick($,C,P)}})(Ss);const mE={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}},_E=":";function wE(i){const[e,t]=i.split(_E);return{namespace:e,reference:t}}function bE(i,e=[]){const t=[];return Object.keys(i).forEach(s=>{if(e.length&&!e.includes(s))return;const o=i[s];t.push(...o.accounts)}),t}function pp(i,e){return i.includes(":")?[i]:e.chains||[]}const gp="base10",cr="base16",Pu="base64pad",eh="utf8",yp=0,un=1,EE=0,Tf=1,Ou=12,th=32;function DE(){const i=Yu.generateKeyPair();return{privateKey:ur(i.secretKey,cr),publicKey:ur(i.publicKey,cr)}}function Cu(){const i=zn.randomBytes(th);return ur(i,cr)}function SE(i,e){const t=Yu.sharedKey(mr(i,cr),mr(e,cr),!0),s=new D1(da.SHA256,t).expand(th);return ur(s,cr)}function IE(i){const e=da.hash(mr(i,cr));return ur(e,cr)}function qn(i){const e=da.hash(mr(i,eh));return ur(e,cr)}function xE(i){return mr(`${i}`,gp)}function $s(i){return Number(ur(i,gp))}function PE(i){const e=xE(typeof i.type<"u"?i.type:yp);if($s(e)===un&&typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof i.senderPublicKey<"u"?mr(i.senderPublicKey,cr):void 0,s=typeof i.iv<"u"?mr(i.iv,cr):zn.randomBytes(Ou),o=new Gu.ChaCha20Poly1305(mr(i.symKey,cr)).seal(s,mr(i.message,eh));return CE({type:e,sealed:o,iv:s,senderPublicKey:t})}function OE(i){const e=new Gu.ChaCha20Poly1305(mr(i.symKey,cr)),{sealed:t,iv:s}=ia(i.encoded),o=e.open(s,t);if(o===null)throw new Error("Failed to decrypt");return ur(o,eh)}function CE(i){if($s(i.type)===un){if(typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ur(Eu([i.type,i.senderPublicKey,i.iv,i.sealed]),Pu)}return ur(Eu([i.type,i.iv,i.sealed]),Pu)}function ia(i){const e=mr(i,Pu),t=e.slice(EE,Tf),s=Tf;if($s(t)===un){const f=s+th,g=f+Ou,p=e.slice(s,f),v=e.slice(f,g),w=e.slice(g);return{type:t,sealed:w,iv:v,senderPublicKey:p}}const o=s+Ou,c=e.slice(s,o),l=e.slice(o);return{type:t,sealed:l,iv:c}}function AE(i,e){const t=ia(i);return vp({type:$s(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?ur(t.senderPublicKey,cr):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function vp(i){const e=(i==null?void 0:i.type)||yp;if(e===un){if(typeof(i==null?void 0:i.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(i==null?void 0:i.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:i==null?void 0:i.senderPublicKey,receiverPublicKey:i==null?void 0:i.receiverPublicKey}}function Rf(i){return i.type===un&&typeof i.senderPublicKey=="string"&&typeof i.receiverPublicKey=="string"}var TE=Object.defineProperty,Nf=Object.getOwnPropertySymbols,RE=Object.prototype.hasOwnProperty,NE=Object.prototype.propertyIsEnumerable,$f=(i,e,t)=>e in i?TE(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Uf=(i,e)=>{for(var t in e||(e={}))RE.call(e,t)&&$f(i,t,e[t]);if(Nf)for(var t of Nf(e))NE.call(e,t)&&$f(i,t,e[t]);return i};const $E="ReactNative",Or={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},UE="js";function rh(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Bn(){return!Qu()&&!!Xu()&&navigator.product===$E}function Kn(){return!rh()&&!!Xu()&&!!Qu()}function Us(){return Bn()?Or.reactNative:rh()?Or.node:Kn()?Or.browser:Or.unknown}function jE(){var i;try{return Bn()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(i=global.Application)==null?void 0:i.applicationId:void 0}catch{return}}function LE(i,e){let t=Ss.parse(i);return t=Uf(Uf({},t),e),i=Ss.stringify(t),i}function ME(){return fp()||{name:"",description:"",url:"",icons:[""]}}function qE(){if(Us()===Or.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:t,Version:s}=global.Platform;return[t,s].join("-")}const i=zw();if(i===null)return"unknown";const e=i.os?i.os.replace(" ","").toLowerCase():"unknown";return i.type==="browser"?[e,i.name,i.version].join("-"):[e,i.version].join("-")}function FE(){var i;const e=Us();return e===Or.browser?[e,((i=lp())==null?void 0:i.host)||"unknown"].join(":"):e}function zE(i,e,t){const s=qE(),o=FE();return[[i,e].join("-"),[UE,t].join("-"),s,o].join("/")}function HE({protocol:i,version:e,relayUrl:t,sdkVersion:s,auth:o,projectId:c,useOnCloseEvent:l,bundleId:f}){const g=t.split("?"),p=zE(i,e,s),v={auth:o,ua:p,projectId:c,useOnCloseEvent:l||void 0,origin:f||void 0},w=LE(g[1]||"",v);return g[0]+"?"+w}function on(i,e){return i.filter(t=>e.includes(t)).length===i.length}function mp(i){return Object.fromEntries(i.entries())}function _p(i){return new Map(Object.entries(i))}function Ln(i=ve.FIVE_MINUTES,e){const t=ve.toMiliseconds(i||ve.FIVE_MINUTES);let s,o,c;return{resolve:l=>{c&&s&&(clearTimeout(c),s(l))},reject:l=>{c&&o&&(clearTimeout(c),o(l))},done:()=>new Promise((l,f)=>{c=setTimeout(()=>{f(new Error(e))},t),s=l,o=f})}}function Is(i,e,t){return new Promise(async(s,o)=>{const c=setTimeout(()=>o(new Error(t)),e);try{const l=await i;s(l)}catch(l){o(l)}clearTimeout(c)})}function wp(i,e){if(typeof e=="string"&&e.startsWith(`${i}:`))return e;if(i.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(i.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${i}`)}function BE(i){return wp("topic",i)}function KE(i){return wp("id",i)}function bp(i){const[e,t]=i.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")s.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))s.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return s}function Pr(i,e){return ve.fromMiliseconds((e||Date.now())+ve.toMiliseconds(i))}function Li(i){return Date.now()>=ve.toMiliseconds(i)}function Nt(i,e){return`${i}${e?`:${e}`:""}`}function eu(i=[],e=[]){return[...new Set([...i,...e])]}async function kE({id:i,topic:e,wcDeepLink:t}){try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const c=`${o}/wc?requestId=${i}&sessionTopic=${e}`,l=Us();l===Or.browser?c.startsWith("https://")?window.open(c,"_blank","noreferrer noopener"):window.open(c,"_self","noreferrer noopener"):l===Or.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(c)}catch(s){console.error(s)}}async function VE(i,e){try{return await i.getItem(e)||(Kn()?localStorage.getItem(e):void 0)}catch(t){console.error(t)}}const GE="irn";function Au(i){return(i==null?void 0:i.relay)||{protocol:GE}}function Xo(i){const e=mE[i];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${i}`);return e}var WE=Object.defineProperty,YE=Object.defineProperties,JE=Object.getOwnPropertyDescriptors,jf=Object.getOwnPropertySymbols,QE=Object.prototype.hasOwnProperty,XE=Object.prototype.propertyIsEnumerable,Lf=(i,e,t)=>e in i?WE(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ZE=(i,e)=>{for(var t in e||(e={}))QE.call(e,t)&&Lf(i,t,e[t]);if(jf)for(var t of jf(e))XE.call(e,t)&&Lf(i,t,e[t]);return i},eD=(i,e)=>YE(i,JE(e));function tD(i,e="-"){const t={},s="relay"+e;return Object.keys(i).forEach(o=>{if(o.startsWith(s)){const c=o.replace(s,""),l=i[o];t[c]=l}}),t}function Mf(i){i=i.includes("wc://")?i.replace("wc://",""):i,i=i.includes("wc:")?i.replace("wc:",""):i;const e=i.indexOf(":"),t=i.indexOf("?")!==-1?i.indexOf("?"):void 0,s=i.substring(0,e),o=i.substring(e+1,t).split("@"),c=typeof t<"u"?i.substring(t):"",l=Ss.parse(c);return{protocol:s,topic:rD(o[0]),version:parseInt(o[1],10),symKey:l.symKey,relay:tD(l),expiryTimestamp:l.expiryTimestamp?parseInt(l.expiryTimestamp,10):void 0}}function rD(i){return i.startsWith("//")?i.substring(2):i}function iD(i,e="-"){const t="relay",s={};return Object.keys(i).forEach(o=>{const c=t+e+o;i[o]&&(s[c]=i[o])}),s}function nD(i){return`${i.protocol}:${i.topic}@${i.version}?`+Ss.stringify(eD(ZE({symKey:i.symKey},iD(i.relay)),{expiryTimestamp:i.expiryTimestamp}))}function kn(i){const e=[];return i.forEach(t=>{const[s,o]=t.split(":");e.push(`${s}:${o}`)}),e}function sD(i){const e=[];return Object.values(i).forEach(t=>{e.push(...kn(t.accounts))}),e}function oD(i,e){const t=[];return Object.values(i).forEach(s=>{kn(s.accounts).includes(e)&&t.push(...s.methods)}),t}function aD(i,e){const t=[];return Object.values(i).forEach(s=>{kn(s.accounts).includes(e)&&t.push(...s.events)}),t}function ih(i){return i.includes(":")}function _s(i){return ih(i)?i.split(":")[0]:i}const cD={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},uD={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ae(i,e){const{message:t,code:s}=uD[i];return{message:e?`${t} ${e}`:t,code:s}}function mt(i,e){const{message:t,code:s}=cD[i];return{message:e?`${t} ${e}`:t,code:s}}function si(i,e){return Array.isArray(i)?typeof e<"u"&&i.length?i.every(e):!0:!1}function xs(i){return Object.getPrototypeOf(i)===Object.prototype&&Object.keys(i).length}function ar(i){return typeof i>"u"}function Vt(i,e){return e&&ar(i)?!0:typeof i=="string"&&!!i.trim().length}function nh(i,e){return e&&ar(i)?!0:typeof i=="number"&&!isNaN(i)}function hD(i,e){const{requiredNamespaces:t}=e,s=Object.keys(i.namespaces),o=Object.keys(t);let c=!0;return on(o,s)?(s.forEach(l=>{const{accounts:f,methods:g,events:p}=i.namespaces[l],v=kn(f),w=t[l];(!on(pp(l,w),v)||!on(w.methods,g)||!on(w.events,p))&&(c=!1)}),c):!1}function na(i){return Vt(i,!1)&&i.includes(":")?i.split(":").length===2:!1}function lD(i){if(Vt(i,!1)&&i.includes(":")){const e=i.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&na(t)}}return!1}function fD(i){if(Vt(i,!1))try{return typeof new URL(i)<"u"}catch{return!1}return!1}function dD(i){var e;return(e=i==null?void 0:i.proposer)==null?void 0:e.publicKey}function pD(i){return i==null?void 0:i.topic}function gD(i,e){let t=null;return Vt(i==null?void 0:i.publicKey,!1)||(t=ae("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function qf(i){let e=!0;return si(i)?i.length&&(e=i.every(t=>Vt(t,!1))):e=!1,e}function yD(i,e,t){let s=null;return si(e)&&e.length?e.forEach(o=>{s||na(o)||(s=mt("UNSUPPORTED_CHAINS",`${t}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):na(i)||(s=mt("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function vD(i,e,t){let s=null;return Object.entries(i).forEach(([o,c])=>{if(s)return;const l=yD(o,pp(o,c),`${e} ${t}`);l&&(s=l)}),s}function mD(i,e){let t=null;return si(i)?i.forEach(s=>{t||lD(s)||(t=mt("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):t=mt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function _D(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const o=mD(s==null?void 0:s.accounts,`${e} namespace`);o&&(t=o)}),t}function wD(i,e){let t=null;return qf(i==null?void 0:i.methods)?qf(i==null?void 0:i.events)||(t=mt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=mt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function Ep(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const o=wD(s,`${e}, namespace`);o&&(t=o)}),t}function bD(i,e,t){let s=null;if(i&&xs(i)){const o=Ep(i,e);o&&(s=o);const c=vD(i,e,t);c&&(s=c)}else s=ae("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return s}function tu(i,e){let t=null;if(i&&xs(i)){const s=Ep(i,e);s&&(t=s);const o=_D(i,e);o&&(t=o)}else t=ae("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function Dp(i){return Vt(i.protocol,!0)}function ED(i,e){let t=!1;return e&&!i?t=!0:i&&si(i)&&i.length&&i.forEach(s=>{t=Dp(s)}),t}function DD(i){return typeof i=="number"}function vr(i){return typeof i<"u"&&typeof i!==null}function SD(i){return!(!i||typeof i!="object"||!i.code||!nh(i.code,!1)||!i.message||!Vt(i.message,!1))}function ID(i){return!(ar(i)||!Vt(i.method,!1))}function xD(i){return!(ar(i)||ar(i.result)&&ar(i.error)||!nh(i.id,!1)||!Vt(i.jsonrpc,!1))}function PD(i){return!(ar(i)||!Vt(i.name,!1))}function Ff(i,e){return!(!na(e)||!sD(i).includes(e))}function OD(i,e,t){return Vt(t,!1)?oD(i,e).includes(t):!1}function CD(i,e,t){return Vt(t,!1)?aD(i,e).includes(t):!1}function zf(i,e,t){let s=null;const o=AD(i),c=TD(e),l=Object.keys(o),f=Object.keys(c),g=Hf(Object.keys(i)),p=Hf(Object.keys(e)),v=g.filter(w=>!p.includes(w));return v.length&&(s=ae("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${v.toString()}
      Received: ${Object.keys(e).toString()}`)),on(l,f)||(s=ae("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${l.toString()}
      Approved: ${f.toString()}`)),Object.keys(e).forEach(w=>{if(!w.includes(":")||s)return;const E=kn(e[w].accounts);E.includes(w)||(s=ae("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${w}
        Required: ${w}
        Approved: ${E.toString()}`))}),l.forEach(w=>{s||(on(o[w].methods,c[w].methods)?on(o[w].events,c[w].events)||(s=ae("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${w}`)):s=ae("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${w}`))}),s}function AD(i){const e={};return Object.keys(i).forEach(t=>{var s;t.includes(":")?e[t]=i[t]:(s=i[t].chains)==null||s.forEach(o=>{e[o]={methods:i[t].methods,events:i[t].events}})}),e}function Hf(i){return[...new Set(i.map(e=>e.includes(":")?e.split(":")[0]:e))]}function TD(i){const e={};return Object.keys(i).forEach(t=>{if(t.includes(":"))e[t]=i[t];else{const s=kn(i[t].accounts);s==null||s.forEach(o=>{e[o]={accounts:i[t].accounts.filter(c=>c.includes(`${o}:`)),methods:i[t].methods,events:i[t].events}})}}),e}function RD(i,e){return nh(i,!1)&&i<=e.max&&i>=e.min}function Bf(){const i=Us();return new Promise(e=>{switch(i){case Or.browser:e(ND());break;case Or.reactNative:e($D());break;case Or.node:e(UD());break;default:e(!0)}})}function ND(){return Kn()&&(navigator==null?void 0:navigator.onLine)}async function $D(){if(Bn()&&typeof global<"u"&&global!=null&&global.NetInfo){const i=await(global==null?void 0:global.NetInfo.fetch());return i==null?void 0:i.isConnected}return!0}function UD(){return!0}function jD(i){switch(Us()){case Or.browser:LD(i);break;case Or.reactNative:MD(i);break}}function LD(i){!Bn()&&Kn()&&(window.addEventListener("online",()=>i(!0)),window.addEventListener("offline",()=>i(!1)))}function MD(i){Bn()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>i(e==null?void 0:e.isConnected)))}const ru={};let ko=class{static get(e){return ru[e]}static set(e,t){ru[e]=t}static delete(e){delete ru[e]}};const qD=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,FD=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,zD=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function HD(i,e){if(i==="__proto__"||i==="constructor"&&e&&typeof e=="object"&&"prototype"in e){BD(i);return}return e}function BD(i){console.warn(`[destr] Dropping "${i}" key to prevent prototype pollution.`)}function Vo(i,e={}){if(typeof i!="string")return i;const t=i.trim();if(i[0]==='"'&&i.endsWith('"')&&!i.includes("\\"))return t.slice(1,-1);if(t.length<=9){const s=t.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!zD.test(i)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return i}try{if(qD.test(i)||FD.test(i)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(i,HD)}return JSON.parse(i)}catch(s){if(e.strict)throw s;return i}}function KD(i){return!i||typeof i.then!="function"?Promise.resolve(i):i}function kt(i,...e){try{return KD(i(...e))}catch(t){return Promise.reject(t)}}function kD(i){const e=typeof i;return i===null||e!=="object"&&e!=="function"}function VD(i){const e=Object.getPrototypeOf(i);return!e||e.isPrototypeOf(Object)}function Zo(i){if(kD(i))return String(i);if(VD(i)||Array.isArray(i))return JSON.stringify(i);if(typeof i.toJSON=="function")return Zo(i.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Sp(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const Tu="base64:";function GD(i){if(typeof i=="string")return i;Sp();const e=Buffer.from(i).toString("base64");return Tu+e}function WD(i){return typeof i!="string"||!i.startsWith(Tu)?i:(Sp(),Buffer.from(i.slice(Tu.length),"base64"))}function yr(i){return i?i.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function YD(...i){return yr(i.join(":"))}function Go(i){return i=yr(i),i?i+":":""}const JD="memory",QD=()=>{const i=new Map;return{name:JD,options:{},hasItem(e){return i.has(e)},getItem(e){return i.get(e)??null},getItemRaw(e){return i.get(e)??null},setItem(e,t){i.set(e,t)},setItemRaw(e,t){i.set(e,t)},removeItem(e){i.delete(e)},getKeys(){return Array.from(i.keys())},clear(){i.clear()},dispose(){i.clear()}}};function XD(i={}){const e={mounts:{"":i.driver||QD()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=p=>{for(const v of e.mountpoints)if(p.startsWith(v))return{base:v,relativeKey:p.slice(v.length),driver:e.mounts[v]};return{base:"",relativeKey:p,driver:e.mounts[""]}},s=(p,v)=>e.mountpoints.filter(w=>w.startsWith(p)||v&&p.startsWith(w)).map(w=>({relativeBase:p.length>w.length?p.slice(w.length):void 0,mountpoint:w,driver:e.mounts[w]})),o=(p,v)=>{if(e.watching){v=yr(v);for(const w of e.watchListeners)w(p,v)}},c=async()=>{if(!e.watching){e.watching=!0;for(const p in e.mounts)e.unwatch[p]=await Kf(e.mounts[p],o,p)}},l=async()=>{if(e.watching){for(const p in e.unwatch)await e.unwatch[p]();e.unwatch={},e.watching=!1}},f=(p,v,w)=>{const E=new Map,x=I=>{let B=E.get(I.base);return B||(B={driver:I.driver,base:I.base,items:[]},E.set(I.base,B)),B};for(const I of p){const B=typeof I=="string",K=yr(B?I:I.key),Z=B?void 0:I.value,$=B||!I.options?v:{...v,...I.options},L=t(K);x(L).items.push({key:K,value:Z,relativeKey:L.relativeKey,options:$})}return Promise.all([...E.values()].map(I=>w(I))).then(I=>I.flat())},g={hasItem(p,v={}){p=yr(p);const{relativeKey:w,driver:E}=t(p);return kt(E.hasItem,w,v)},getItem(p,v={}){p=yr(p);const{relativeKey:w,driver:E}=t(p);return kt(E.getItem,w,v).then(x=>Vo(x))},getItems(p,v){return f(p,v,w=>w.driver.getItems?kt(w.driver.getItems,w.items.map(E=>({key:E.relativeKey,options:E.options})),v).then(E=>E.map(x=>({key:YD(w.base,x.key),value:Vo(x.value)}))):Promise.all(w.items.map(E=>kt(w.driver.getItem,E.relativeKey,E.options).then(x=>({key:E.key,value:Vo(x)})))))},getItemRaw(p,v={}){p=yr(p);const{relativeKey:w,driver:E}=t(p);return E.getItemRaw?kt(E.getItemRaw,w,v):kt(E.getItem,w,v).then(x=>WD(x))},async setItem(p,v,w={}){if(v===void 0)return g.removeItem(p);p=yr(p);const{relativeKey:E,driver:x}=t(p);x.setItem&&(await kt(x.setItem,E,Zo(v),w),x.watch||o("update",p))},async setItems(p,v){await f(p,v,async w=>{if(w.driver.setItems)return kt(w.driver.setItems,w.items.map(E=>({key:E.relativeKey,value:Zo(E.value),options:E.options})),v);w.driver.setItem&&await Promise.all(w.items.map(E=>kt(w.driver.setItem,E.relativeKey,Zo(E.value),E.options)))})},async setItemRaw(p,v,w={}){if(v===void 0)return g.removeItem(p,w);p=yr(p);const{relativeKey:E,driver:x}=t(p);if(x.setItemRaw)await kt(x.setItemRaw,E,v,w);else if(x.setItem)await kt(x.setItem,E,GD(v),w);else return;x.watch||o("update",p)},async removeItem(p,v={}){typeof v=="boolean"&&(v={removeMeta:v}),p=yr(p);const{relativeKey:w,driver:E}=t(p);E.removeItem&&(await kt(E.removeItem,w,v),(v.removeMeta||v.removeMata)&&await kt(E.removeItem,w+"$",v),E.watch||o("remove",p))},async getMeta(p,v={}){typeof v=="boolean"&&(v={nativeOnly:v}),p=yr(p);const{relativeKey:w,driver:E}=t(p),x=Object.create(null);if(E.getMeta&&Object.assign(x,await kt(E.getMeta,w,v)),!v.nativeOnly){const I=await kt(E.getItem,w+"$",v).then(B=>Vo(B));I&&typeof I=="object"&&(typeof I.atime=="string"&&(I.atime=new Date(I.atime)),typeof I.mtime=="string"&&(I.mtime=new Date(I.mtime)),Object.assign(x,I))}return x},setMeta(p,v,w={}){return this.setItem(p+"$",v,w)},removeMeta(p,v={}){return this.removeItem(p+"$",v)},async getKeys(p,v={}){p=Go(p);const w=s(p,!0);let E=[];const x=[];for(const I of w){const K=(await kt(I.driver.getKeys,I.relativeBase,v)).map(Z=>I.mountpoint+yr(Z)).filter(Z=>!E.some($=>Z.startsWith($)));x.push(...K),E=[I.mountpoint,...E.filter(Z=>!Z.startsWith(I.mountpoint))]}return p?x.filter(I=>I.startsWith(p)&&!I.endsWith("$")):x.filter(I=>!I.endsWith("$"))},async clear(p,v={}){p=Go(p),await Promise.all(s(p,!1).map(async w=>{if(w.driver.clear)return kt(w.driver.clear,w.relativeBase,v);if(w.driver.removeItem){const E=await w.driver.getKeys(w.relativeBase||"",v);return Promise.all(E.map(x=>w.driver.removeItem(x,v)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(p=>kf(p)))},async watch(p){return await c(),e.watchListeners.push(p),async()=>{e.watchListeners=e.watchListeners.filter(v=>v!==p),e.watchListeners.length===0&&await l()}},async unwatch(){e.watchListeners=[],await l()},mount(p,v){if(p=Go(p),p&&e.mounts[p])throw new Error(`already mounted at ${p}`);return p&&(e.mountpoints.push(p),e.mountpoints.sort((w,E)=>E.length-w.length)),e.mounts[p]=v,e.watching&&Promise.resolve(Kf(v,o,p)).then(w=>{e.unwatch[p]=w}).catch(console.error),g},async unmount(p,v=!0){p=Go(p),!(!p||!e.mounts[p])&&(e.watching&&p in e.unwatch&&(e.unwatch[p](),delete e.unwatch[p]),v&&await kf(e.mounts[p]),e.mountpoints=e.mountpoints.filter(w=>w!==p),delete e.mounts[p])},getMount(p=""){p=yr(p)+":";const v=t(p);return{driver:v.driver,base:v.base}},getMounts(p="",v={}){return p=yr(p),s(p,v.parents).map(E=>({driver:E.driver,base:E.mountpoint}))}};return g}function Kf(i,e,t){return i.watch?i.watch((s,o)=>e(s,t+o)):()=>{}}async function kf(i){typeof i.dispose=="function"&&await kt(i.dispose)}function hn(i){return new Promise((e,t)=>{i.oncomplete=i.onsuccess=()=>e(i.result),i.onabort=i.onerror=()=>t(i.error)})}function Ip(i,e){const t=indexedDB.open(i);t.onupgradeneeded=()=>t.result.createObjectStore(e);const s=hn(t);return(o,c)=>s.then(l=>c(l.transaction(e,o).objectStore(e)))}let iu;function js(){return iu||(iu=Ip("keyval-store","keyval")),iu}function Vf(i,e=js()){return e("readonly",t=>hn(t.get(i)))}function ZD(i,e,t=js()){return t("readwrite",s=>(s.put(e,i),hn(s.transaction)))}function e3(i,e=js()){return e("readwrite",t=>(t.delete(i),hn(t.transaction)))}function t3(i=js()){return i("readwrite",e=>(e.clear(),hn(e.transaction)))}function r3(i,e){return i.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},hn(i.transaction)}function i3(i=js()){return i("readonly",e=>{if(e.getAllKeys)return hn(e.getAllKeys());const t=[];return r3(e,s=>t.push(s.key)).then(()=>t)})}const n3=i=>JSON.stringify(i,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),s3=i=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=i.replace(e,'$1"$2n"$3');return JSON.parse(t,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function Ls(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return s3(i)}catch{return i}}function an(i){return typeof i=="string"?i:n3(i)||""}const o3="idb-keyval";var a3=(i={})=>{const e=i.base&&i.base.length>0?`${i.base}:`:"",t=o=>e+o;let s;return i.dbName&&i.storeName&&(s=Ip(i.dbName,i.storeName)),{name:o3,options:i,async hasItem(o){return!(typeof await Vf(t(o),s)>"u")},async getItem(o){return await Vf(t(o),s)??null},setItem(o,c){return ZD(t(o),c,s)},removeItem(o){return e3(t(o),s)},getKeys(){return i3(s)},clear(){return t3(s)}}};const c3="WALLET_CONNECT_V2_INDEXED_DB",u3="keyvaluestorage";let h3=class{constructor(){this.indexedDb=XD({driver:a3({dbName:c3,storeName:u3})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(t!==null)return t}async setItem(e,t){await this.indexedDb.setItem(e,an(t))}async removeItem(e){await this.indexedDb.removeItem(e)}};var nu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ea={exports:{}};(function(){let i;function e(){}i=e,i.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},i.prototype.setItem=function(t,s){this[t]=String(s)},i.prototype.removeItem=function(t){delete this[t]},i.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(s){t[s]=void 0,delete t[s]})},i.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},i.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof nu<"u"&&nu.localStorage?ea.exports=nu.localStorage:typeof window<"u"&&window.localStorage?ea.exports=window.localStorage:ea.exports=new e})();function l3(i){var e;return[i[0],Ls((e=i[1])!=null?e:"")]}class f3{constructor(){this.localStorage=ea.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(l3)}async getItem(e){const t=this.localStorage.getItem(e);if(t!==null)return Ls(t)}async setItem(e,t){this.localStorage.setItem(e,an(t))}async removeItem(e){this.localStorage.removeItem(e)}}const d3="wc_storage_version",Gf=1,p3=async(i,e,t)=>{const s=d3,o=await e.getItem(s);if(o&&o>=Gf){t(e);return}const c=await i.getKeys();if(!c.length){t(e);return}const l=[];for(;c.length;){const f=c.shift();if(!f)continue;const g=f.toLowerCase();if(g.includes("wc@")||g.includes("walletconnect")||g.includes("wc_")||g.includes("wallet_connect")){const p=await i.getItem(f);await e.setItem(f,p),l.push(f)}}await e.setItem(s,Gf),t(e),g3(i,l)},g3=async(i,e)=>{e.length&&e.forEach(async t=>{await i.removeItem(t)})};let y3=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const e=new f3;this.storage=e;try{const t=new h3;p3(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}};var Vn={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ru=function(i,e){return Ru=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Ru(i,e)};function v3(i,e){Ru(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Nu=function(){return Nu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Nu.apply(this,arguments)};function m3(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function _3(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function w3(i,e){return function(t,s){e(t,s,i)}}function b3(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function E3(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(v){try{p(s.next(v))}catch(w){l(w)}}function g(v){try{p(s.throw(v))}catch(w){l(w)}}function p(v){v.done?c(v.value):o(v.value).then(f,g)}p((s=s.apply(i,e||[])).next())})}function D3(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(v){return g([p,v])}}function g(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(i,t)}catch(v){p=[6,v],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function S3(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function I3(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function $u(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function xp(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function x3(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(xp(arguments[e]));return i}function P3(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function Ps(i){return this instanceof Ps?(this.v=i,this):new Ps(i)}function O3(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(E){s[E]&&(o[E]=function(x){return new Promise(function(I,B){c.push([E,x,I,B])>1||f(E,x)})})}function f(E,x){try{g(s[E](x))}catch(I){w(c[0][3],I)}}function g(E){E.value instanceof Ps?Promise.resolve(E.value.v).then(p,v):w(c[0][2],E)}function p(E){f("next",E)}function v(E){f("throw",E)}function w(E,x){E(x),c.shift(),c.length&&f(c[0][0],c[0][1])}}function C3(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:Ps(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function A3(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof $u=="function"?$u(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(f,g){l=i[c](l),o(f,g,l.done,l.value)})}}function o(c,l,f,g){Promise.resolve(g).then(function(p){c({value:p,done:f})},l)}}function T3(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function R3(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function N3(i){return i&&i.__esModule?i:{default:i}}function $3(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function U3(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const j3=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Nu},__asyncDelegator:C3,__asyncGenerator:O3,__asyncValues:A3,__await:Ps,__awaiter:E3,__classPrivateFieldGet:$3,__classPrivateFieldSet:U3,__createBinding:S3,__decorate:_3,__exportStar:I3,__extends:v3,__generator:D3,__importDefault:N3,__importStar:R3,__makeTemplateObject:T3,__metadata:b3,__param:w3,__read:xp,__rest:m3,__spread:x3,__spreadArrays:P3,__values:$u},Symbol.toStringTag,{value:"Module"})),ya=Ts(j3);var ps={},su={},gs={};let ln=class{};const L3=Object.freeze(Object.defineProperty({__proto__:null,IEvents:ln},Symbol.toStringTag,{value:"Module"})),M3=Ts(L3);var Wf;function q3(){if(Wf)return gs;Wf=1,Object.defineProperty(gs,"__esModule",{value:!0}),gs.IHeartBeat=void 0;const i=M3;class e extends i.IEvents{constructor(s){super()}}return gs.IHeartBeat=e,gs}var Yf;function Pp(){return Yf||(Yf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),ya.__exportStar(q3(),i)}(su)),su}var ou={},sn={},Jf;function F3(){if(Jf)return sn;Jf=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.HEARTBEAT_EVENTS=sn.HEARTBEAT_INTERVAL=void 0;const i=ve;return sn.HEARTBEAT_INTERVAL=i.FIVE_SECONDS,sn.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},sn}var Qf;function Op(){return Qf||(Qf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),ya.__exportStar(F3(),i)}(ou)),ou}var Xf;function z3(){if(Xf)return ps;Xf=1,Object.defineProperty(ps,"__esModule",{value:!0}),ps.HeartBeat=void 0;const i=ya,e=Fr,t=ve,s=Pp(),o=Op();class c extends s.IHeartBeat{constructor(f){super(f),this.events=new e.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(f==null?void 0:f.interval)||o.HEARTBEAT_INTERVAL}static init(f){return i.__awaiter(this,void 0,void 0,function*(){const g=new c(f);return yield g.init(),g})}init(){return i.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,g){this.events.on(f,g)}once(f,g){this.events.once(f,g)}off(f,g){this.events.off(f,g)}removeListener(f,g){this.events.removeListener(f,g)}initialize(){return i.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return ps.HeartBeat=c,ps}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ya;e.__exportStar(z3(),i),e.__exportStar(Pp(),i),e.__exportStar(Op(),i)})(Vn);function H3(i){try{return JSON.stringify(i)}catch{return'"[Circular]"'}}var B3=K3;function K3(i,e,t){var s=t&&t.stringify||H3,o=1;if(typeof i=="object"&&i!==null){var c=e.length+o;if(c===1)return i;var l=new Array(c);l[0]=s(i);for(var f=1;f<c;f++)l[f]=s(e[f]);return l.join(" ")}if(typeof i!="string")return i;var g=e.length;if(g===0)return i;for(var p="",v=1-o,w=-1,E=i&&i.length||0,x=0;x<E;){if(i.charCodeAt(x)===37&&x+1<E){switch(w=w>-1?w:0,i.charCodeAt(x+1)){case 100:case 102:if(v>=g||e[v]==null)break;w<x&&(p+=i.slice(w,x)),p+=Number(e[v]),w=x+2,x++;break;case 105:if(v>=g||e[v]==null)break;w<x&&(p+=i.slice(w,x)),p+=Math.floor(Number(e[v])),w=x+2,x++;break;case 79:case 111:case 106:if(v>=g||e[v]===void 0)break;w<x&&(p+=i.slice(w,x));var I=typeof e[v];if(I==="string"){p+="'"+e[v]+"'",w=x+2,x++;break}if(I==="function"){p+=e[v].name||"<anonymous>",w=x+2,x++;break}p+=s(e[v]),w=x+2,x++;break;case 115:if(v>=g)break;w<x&&(p+=i.slice(w,x)),p+=String(e[v]),w=x+2,x++;break;case 37:w<x&&(p+=i.slice(w,x)),p+="%",w=x+2,x++,v--;break}++v}++x}return w===-1?i:(w<E&&(p+=i.slice(w)),p)}const Zf=B3;var k3=ni;const Os=t2().console||{},V3={mapHttpRequest:Wo,mapHttpResponse:Wo,wrapRequestSerializer:au,wrapResponseSerializer:au,wrapErrorSerializer:au,req:Wo,res:Wo,err:Q3};function G3(i,e){return Array.isArray(i)?i.filter(function(s){return s!=="!stdSerializers.err"}):i===!0?Object.keys(e):!1}function ni(i){i=i||{},i.browser=i.browser||{};const e=i.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const t=i.browser.write||Os;i.browser.write&&(i.browser.asObject=!0);const s=i.serializers||{},o=G3(i.browser.serialize,s);let c=i.browser.serialize;Array.isArray(i.browser.serialize)&&i.browser.serialize.indexOf("!stdSerializers.err")>-1&&(c=!1);const l=["error","fatal","warn","info","debug","trace"];typeof t=="function"&&(t.error=t.fatal=t.warn=t.info=t.debug=t.trace=t),i.enabled===!1&&(i.level="silent");const f=i.level||"info",g=Object.create(t);g.log||(g.log=Cs),Object.defineProperty(g,"levelVal",{get:v}),Object.defineProperty(g,"level",{get:w,set:E});const p={transmit:e,serialize:o,asObject:i.browser.asObject,levels:l,timestamp:X3(i)};g.levels=ni.levels,g.level=f,g.setMaxListeners=g.getMaxListeners=g.emit=g.addListener=g.on=g.prependListener=g.once=g.prependOnceListener=g.removeListener=g.removeAllListeners=g.listeners=g.listenerCount=g.eventNames=g.write=g.flush=Cs,g.serializers=s,g._serialize=o,g._stdErrSerialize=c,g.child=x,e&&(g._logEvent=Uu());function v(){return this.level==="silent"?1/0:this.levels.values[this.level]}function w(){return this._level}function E(I){if(I!=="silent"&&!this.levels.values[I])throw Error("unknown level "+I);this._level=I,$n(p,g,"error","log"),$n(p,g,"fatal","error"),$n(p,g,"warn","error"),$n(p,g,"info","log"),$n(p,g,"debug","log"),$n(p,g,"trace","log")}function x(I,B){if(!I)throw new Error("missing bindings for child Pino");B=B||{},o&&I.serializers&&(B.serializers=I.serializers);const K=B.serializers;if(o&&K){var Z=Object.assign({},s,K),$=i.browser.serialize===!0?Object.keys(Z):o;delete I.serializers,va([I],$,Z,this._stdErrSerialize)}function L(P){this._childLevel=(P._childLevel|0)+1,this.error=Un(P,I,"error"),this.fatal=Un(P,I,"fatal"),this.warn=Un(P,I,"warn"),this.info=Un(P,I,"info"),this.debug=Un(P,I,"debug"),this.trace=Un(P,I,"trace"),Z&&(this.serializers=Z,this._serialize=$),e&&(this._logEvent=Uu([].concat(P._logEvent.bindings,I)))}return L.prototype=this,new L(this)}return g}ni.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};ni.stdSerializers=V3;ni.stdTimeFunctions=Object.assign({},{nullTime:Cp,epochTime:Ap,unixTime:Z3,isoTime:e2});function $n(i,e,t,s){const o=Object.getPrototypeOf(e);e[t]=e.levelVal>e.levels.values[t]?Cs:o[t]?o[t]:Os[t]||Os[s]||Cs,W3(i,e,t)}function W3(i,e,t){!i.transmit&&e[t]===Cs||(e[t]=function(s){return function(){const c=i.timestamp(),l=new Array(arguments.length),f=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Os?Os:this;for(var g=0;g<l.length;g++)l[g]=arguments[g];if(i.serialize&&!i.asObject&&va(l,this._serialize,this.serializers,this._stdErrSerialize),i.asObject?s.call(f,Y3(this,t,l,c)):s.apply(f,l),i.transmit){const p=i.transmit.level||e.level,v=ni.levels.values[p],w=ni.levels.values[t];if(w<v)return;J3(this,{ts:c,methodLevel:t,methodValue:w,transmitLevel:p,transmitValue:ni.levels.values[i.transmit.level||e.level],send:i.transmit.send,val:e.levelVal},l)}}}(e[t]))}function Y3(i,e,t,s){i._serialize&&va(t,i._serialize,i.serializers,i._stdErrSerialize);const o=t.slice();let c=o[0];const l={};s&&(l.time=s),l.level=ni.levels.values[e];let f=(i._childLevel|0)+1;if(f<1&&(f=1),c!==null&&typeof c=="object"){for(;f--&&typeof o[0]=="object";)Object.assign(l,o.shift());c=o.length?Zf(o.shift(),o):void 0}else typeof c=="string"&&(c=Zf(o.shift(),o));return c!==void 0&&(l.msg=c),l}function va(i,e,t,s){for(const o in i)if(s&&i[o]instanceof Error)i[o]=ni.stdSerializers.err(i[o]);else if(typeof i[o]=="object"&&!Array.isArray(i[o]))for(const c in i[o])e&&e.indexOf(c)>-1&&c in t&&(i[o][c]=t[c](i[o][c]))}function Un(i,e,t){return function(){const s=new Array(1+arguments.length);s[0]=e;for(var o=1;o<s.length;o++)s[o]=arguments[o-1];return i[t].apply(this,s)}}function J3(i,e,t){const s=e.send,o=e.ts,c=e.methodLevel,l=e.methodValue,f=e.val,g=i._logEvent.bindings;va(t,i._serialize||Object.keys(i.serializers),i.serializers,i._stdErrSerialize===void 0?!0:i._stdErrSerialize),i._logEvent.ts=o,i._logEvent.messages=t.filter(function(p){return g.indexOf(p)===-1}),i._logEvent.level.label=c,i._logEvent.level.value=l,s(c,i._logEvent,f),i._logEvent=Uu(g)}function Uu(i){return{ts:0,messages:[],bindings:i||[],level:{label:"",value:0}}}function Q3(i){const e={type:i.constructor.name,msg:i.message,stack:i.stack};for(const t in i)e[t]===void 0&&(e[t]=i[t]);return e}function X3(i){return typeof i.timestamp=="function"?i.timestamp:i.timestamp===!1?Cp:Ap}function Wo(){return{}}function au(i){return i}function Cs(){}function Cp(){return!1}function Ap(){return Date.now()}function Z3(){return Math.round(Date.now()/1e3)}function e2(){return new Date(Date.now()).toISOString()}function t2(){function i(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return i(self)||i(window)||i(this)||{}}}const ma=ca(k3),r2={level:"info"},Ms="custom_context";var i2=Object.defineProperty,n2=Object.defineProperties,s2=Object.getOwnPropertyDescriptors,ed=Object.getOwnPropertySymbols,o2=Object.prototype.hasOwnProperty,a2=Object.prototype.propertyIsEnumerable,td=(i,e,t)=>e in i?i2(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,c2=(i,e)=>{for(var t in e||(e={}))o2.call(e,t)&&td(i,t,e[t]);if(ed)for(var t of ed(e))a2.call(e,t)&&td(i,t,e[t]);return i},u2=(i,e)=>n2(i,s2(e));function _a(i){return u2(c2({},i),{level:(i==null?void 0:i.level)||r2.level})}function h2(i,e=Ms){return i[e]||""}function l2(i,e,t=Ms){return i[t]=e,i}function _r(i,e=Ms){let t="";return typeof i.bindings>"u"?t=h2(i,e):t=i.bindings().context||"",t}function f2(i,e,t=Ms){const s=_r(i,t);return s.trim()?`${s}/${e}`:e}function wr(i,e,t=Ms){const s=f2(i,e,t),o=i.child({context:s});return l2(o,s,t)}class d2 extends ln{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}let p2=class extends ln{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}},g2=class{constructor(e,t){this.logger=e,this.core=t}},y2=class extends ln{constructor(e,t){super(),this.relayer=e,this.logger=t}},v2=class extends ln{constructor(e){super()}},m2=class{constructor(e,t,s,o){this.core=e,this.logger=t,this.name=s}};class _2 extends ln{constructor(e,t){super(),this.relayer=e,this.logger=t}}let w2=class extends ln{constructor(e,t){super(),this.core=e,this.logger=t}},b2=class{constructor(e,t){this.projectId=e,this.logger=t}},E2=class{constructor(e,t){this.projectId=e,this.logger=t}},D2=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},S2=class{constructor(e){this.client=e}};var sh={},Tp={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=je,t=Cr;i.DIGEST_LENGTH=64,i.BLOCK_SIZE=128;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},f.prototype.update=function(g,p){if(p===void 0&&(p=g.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var v=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<i.BLOCK_SIZE&&p>0;)this._buffer[this._bufferLength++]=g[v++],p--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(v=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,g,v,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=g[v++],p--;return this},f.prototype.finish=function(g){if(!this._finished){var p=this._bytesHashed,v=this._bufferLength,w=p/536870912|0,E=p<<3,x=p%128<112?128:256;this._buffer[v]=128;for(var I=v+1;I<x-8;I++)this._buffer[I]=0;e.writeUint32BE(w,this._buffer,x-8),e.writeUint32BE(E,this._buffer,x-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,x),this._finished=!0}for(var I=0;I<this.digestLength/8;I++)e.writeUint32BE(this._stateHi[I],g,I*8),e.writeUint32BE(this._stateLo[I],g,I*8+4);return this},f.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(g){return this._stateHi.set(g.stateHi),this._stateLo.set(g.stateLo),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(g){t.wipe(g.stateHi),t.wipe(g.stateLo),g.buffer&&t.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},f}();i.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(f,g,p,v,w,E,x){for(var I=p[0],B=p[1],K=p[2],Z=p[3],$=p[4],L=p[5],P=p[6],C=p[7],A=v[0],h=v[1],b=v[2],ee=v[3],ne=v[4],ue=v[5],ge=v[6],ye=v[7],S,R,X,J,k,V,te,ie;x>=128;){for(var De=0;De<16;De++){var oe=8*De+E;f[De]=e.readUint32BE(w,oe),g[De]=e.readUint32BE(w,oe+4)}for(var De=0;De<80;De++){var Se=I,le=B,Ae=K,z=Z,F=$,U=L,d=P,T=C,se=A,he=h,Ee=b,He=ee,ke=ne,Le=ue,dt=ge,pt=ye;if(S=C,R=ye,k=R&65535,V=R>>>16,te=S&65535,ie=S>>>16,S=($>>>14|ne<<18)^($>>>18|ne<<14)^(ne>>>9|$<<23),R=(ne>>>14|$<<18)^(ne>>>18|$<<14)^($>>>9|ne<<23),k+=R&65535,V+=R>>>16,te+=S&65535,ie+=S>>>16,S=$&L^~$&P,R=ne&ue^~ne&ge,k+=R&65535,V+=R>>>16,te+=S&65535,ie+=S>>>16,S=o[De*2],R=o[De*2+1],k+=R&65535,V+=R>>>16,te+=S&65535,ie+=S>>>16,S=f[De%16],R=g[De%16],k+=R&65535,V+=R>>>16,te+=S&65535,ie+=S>>>16,V+=k>>>16,te+=V>>>16,ie+=te>>>16,X=te&65535|ie<<16,J=k&65535|V<<16,S=X,R=J,k=R&65535,V=R>>>16,te=S&65535,ie=S>>>16,S=(I>>>28|A<<4)^(A>>>2|I<<30)^(A>>>7|I<<25),R=(A>>>28|I<<4)^(I>>>2|A<<30)^(I>>>7|A<<25),k+=R&65535,V+=R>>>16,te+=S&65535,ie+=S>>>16,S=I&B^I&K^B&K,R=A&h^A&b^h&b,k+=R&65535,V+=R>>>16,te+=S&65535,ie+=S>>>16,V+=k>>>16,te+=V>>>16,ie+=te>>>16,T=te&65535|ie<<16,pt=k&65535|V<<16,S=z,R=He,k=R&65535,V=R>>>16,te=S&65535,ie=S>>>16,S=X,R=J,k+=R&65535,V+=R>>>16,te+=S&65535,ie+=S>>>16,V+=k>>>16,te+=V>>>16,ie+=te>>>16,z=te&65535|ie<<16,He=k&65535|V<<16,B=Se,K=le,Z=Ae,$=z,L=F,P=U,C=d,I=T,h=se,b=he,ee=Ee,ne=He,ue=ke,ge=Le,ye=dt,A=pt,De%16===15)for(var oe=0;oe<16;oe++)S=f[oe],R=g[oe],k=R&65535,V=R>>>16,te=S&65535,ie=S>>>16,S=f[(oe+9)%16],R=g[(oe+9)%16],k+=R&65535,V+=R>>>16,te+=S&65535,ie+=S>>>16,X=f[(oe+1)%16],J=g[(oe+1)%16],S=(X>>>1|J<<31)^(X>>>8|J<<24)^X>>>7,R=(J>>>1|X<<31)^(J>>>8|X<<24)^(J>>>7|X<<25),k+=R&65535,V+=R>>>16,te+=S&65535,ie+=S>>>16,X=f[(oe+14)%16],J=g[(oe+14)%16],S=(X>>>19|J<<13)^(J>>>29|X<<3)^X>>>6,R=(J>>>19|X<<13)^(X>>>29|J<<3)^(J>>>6|X<<26),k+=R&65535,V+=R>>>16,te+=S&65535,ie+=S>>>16,V+=k>>>16,te+=V>>>16,ie+=te>>>16,f[oe]=te&65535|ie<<16,g[oe]=k&65535|V<<16}S=I,R=A,k=R&65535,V=R>>>16,te=S&65535,ie=S>>>16,S=p[0],R=v[0],k+=R&65535,V+=R>>>16,te+=S&65535,ie+=S>>>16,V+=k>>>16,te+=V>>>16,ie+=te>>>16,p[0]=I=te&65535|ie<<16,v[0]=A=k&65535|V<<16,S=B,R=h,k=R&65535,V=R>>>16,te=S&65535,ie=S>>>16,S=p[1],R=v[1],k+=R&65535,V+=R>>>16,te+=S&65535,ie+=S>>>16,V+=k>>>16,te+=V>>>16,ie+=te>>>16,p[1]=B=te&65535|ie<<16,v[1]=h=k&65535|V<<16,S=K,R=b,k=R&65535,V=R>>>16,te=S&65535,ie=S>>>16,S=p[2],R=v[2],k+=R&65535,V+=R>>>16,te+=S&65535,ie+=S>>>16,V+=k>>>16,te+=V>>>16,ie+=te>>>16,p[2]=K=te&65535|ie<<16,v[2]=b=k&65535|V<<16,S=Z,R=ee,k=R&65535,V=R>>>16,te=S&65535,ie=S>>>16,S=p[3],R=v[3],k+=R&65535,V+=R>>>16,te+=S&65535,ie+=S>>>16,V+=k>>>16,te+=V>>>16,ie+=te>>>16,p[3]=Z=te&65535|ie<<16,v[3]=ee=k&65535|V<<16,S=$,R=ne,k=R&65535,V=R>>>16,te=S&65535,ie=S>>>16,S=p[4],R=v[4],k+=R&65535,V+=R>>>16,te+=S&65535,ie+=S>>>16,V+=k>>>16,te+=V>>>16,ie+=te>>>16,p[4]=$=te&65535|ie<<16,v[4]=ne=k&65535|V<<16,S=L,R=ue,k=R&65535,V=R>>>16,te=S&65535,ie=S>>>16,S=p[5],R=v[5],k+=R&65535,V+=R>>>16,te+=S&65535,ie+=S>>>16,V+=k>>>16,te+=V>>>16,ie+=te>>>16,p[5]=L=te&65535|ie<<16,v[5]=ue=k&65535|V<<16,S=P,R=ge,k=R&65535,V=R>>>16,te=S&65535,ie=S>>>16,S=p[6],R=v[6],k+=R&65535,V+=R>>>16,te+=S&65535,ie+=S>>>16,V+=k>>>16,te+=V>>>16,ie+=te>>>16,p[6]=P=te&65535|ie<<16,v[6]=ge=k&65535|V<<16,S=C,R=ye,k=R&65535,V=R>>>16,te=S&65535,ie=S>>>16,S=p[7],R=v[7],k+=R&65535,V+=R>>>16,te+=S&65535,ie+=S>>>16,V+=k>>>16,te+=V>>>16,ie+=te>>>16,p[7]=C=te&65535|ie<<16,v[7]=ye=k&65535|V<<16,E+=128,x-=128}return E}function l(f){var g=new s;g.update(f);var p=g.digest();return g.clean(),p}i.hash=l})(Tp);(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.convertSecretKeyToX25519=i.convertPublicKeyToX25519=i.verify=i.sign=i.extractPublicKeyFromSecretKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.SEED_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=i.SIGNATURE_LENGTH=void 0;const e=zn,t=Tp,s=Cr;i.SIGNATURE_LENGTH=64,i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=64,i.SEED_LENGTH=32;function o(z){const F=new Float64Array(16);if(z)for(let U=0;U<z.length;U++)F[U]=z[U];return F}const c=new Uint8Array(32);c[0]=9;const l=o(),f=o([1]),g=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),v=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),w=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),E=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function x(z,F){for(let U=0;U<16;U++)z[U]=F[U]|0}function I(z){let F=1;for(let U=0;U<16;U++){let d=z[U]+F+65535;F=Math.floor(d/65536),z[U]=d-F*65536}z[0]+=F-1+37*(F-1)}function B(z,F,U){const d=~(U-1);for(let T=0;T<16;T++){const se=d&(z[T]^F[T]);z[T]^=se,F[T]^=se}}function K(z,F){const U=o(),d=o();for(let T=0;T<16;T++)d[T]=F[T];I(d),I(d),I(d);for(let T=0;T<2;T++){U[0]=d[0]-65517;for(let he=1;he<15;he++)U[he]=d[he]-65535-(U[he-1]>>16&1),U[he-1]&=65535;U[15]=d[15]-32767-(U[14]>>16&1);const se=U[15]>>16&1;U[14]&=65535,B(d,U,1-se)}for(let T=0;T<16;T++)z[2*T]=d[T]&255,z[2*T+1]=d[T]>>8}function Z(z,F){let U=0;for(let d=0;d<32;d++)U|=z[d]^F[d];return(1&U-1>>>8)-1}function $(z,F){const U=new Uint8Array(32),d=new Uint8Array(32);return K(U,z),K(d,F),Z(U,d)}function L(z){const F=new Uint8Array(32);return K(F,z),F[0]&1}function P(z,F){for(let U=0;U<16;U++)z[U]=F[2*U]+(F[2*U+1]<<8);z[15]&=32767}function C(z,F,U){for(let d=0;d<16;d++)z[d]=F[d]+U[d]}function A(z,F,U){for(let d=0;d<16;d++)z[d]=F[d]-U[d]}function h(z,F,U){let d,T,se=0,he=0,Ee=0,He=0,ke=0,Le=0,dt=0,pt=0,qe=0,Ie=0,Ne=0,$e=0,Fe=0,Pe=0,Ue=0,be=0,Oe=0,Be=0,xe=0,Ve=0,We=0,Ze=0,et=0,Je=0,er=0,hr=0,Jr=0,tr=0,oi=0,xi=0,Hi=0,Et=U[0],gt=U[1],Dt=U[2],St=U[3],wt=U[4],yt=U[5],$t=U[6],Ut=U[7],It=U[8],jt=U[9],xt=U[10],Ct=U[11],Pt=U[12],ut=U[13],Lt=U[14],Mt=U[15];d=F[0],se+=d*Et,he+=d*gt,Ee+=d*Dt,He+=d*St,ke+=d*wt,Le+=d*yt,dt+=d*$t,pt+=d*Ut,qe+=d*It,Ie+=d*jt,Ne+=d*xt,$e+=d*Ct,Fe+=d*Pt,Pe+=d*ut,Ue+=d*Lt,be+=d*Mt,d=F[1],he+=d*Et,Ee+=d*gt,He+=d*Dt,ke+=d*St,Le+=d*wt,dt+=d*yt,pt+=d*$t,qe+=d*Ut,Ie+=d*It,Ne+=d*jt,$e+=d*xt,Fe+=d*Ct,Pe+=d*Pt,Ue+=d*ut,be+=d*Lt,Oe+=d*Mt,d=F[2],Ee+=d*Et,He+=d*gt,ke+=d*Dt,Le+=d*St,dt+=d*wt,pt+=d*yt,qe+=d*$t,Ie+=d*Ut,Ne+=d*It,$e+=d*jt,Fe+=d*xt,Pe+=d*Ct,Ue+=d*Pt,be+=d*ut,Oe+=d*Lt,Be+=d*Mt,d=F[3],He+=d*Et,ke+=d*gt,Le+=d*Dt,dt+=d*St,pt+=d*wt,qe+=d*yt,Ie+=d*$t,Ne+=d*Ut,$e+=d*It,Fe+=d*jt,Pe+=d*xt,Ue+=d*Ct,be+=d*Pt,Oe+=d*ut,Be+=d*Lt,xe+=d*Mt,d=F[4],ke+=d*Et,Le+=d*gt,dt+=d*Dt,pt+=d*St,qe+=d*wt,Ie+=d*yt,Ne+=d*$t,$e+=d*Ut,Fe+=d*It,Pe+=d*jt,Ue+=d*xt,be+=d*Ct,Oe+=d*Pt,Be+=d*ut,xe+=d*Lt,Ve+=d*Mt,d=F[5],Le+=d*Et,dt+=d*gt,pt+=d*Dt,qe+=d*St,Ie+=d*wt,Ne+=d*yt,$e+=d*$t,Fe+=d*Ut,Pe+=d*It,Ue+=d*jt,be+=d*xt,Oe+=d*Ct,Be+=d*Pt,xe+=d*ut,Ve+=d*Lt,We+=d*Mt,d=F[6],dt+=d*Et,pt+=d*gt,qe+=d*Dt,Ie+=d*St,Ne+=d*wt,$e+=d*yt,Fe+=d*$t,Pe+=d*Ut,Ue+=d*It,be+=d*jt,Oe+=d*xt,Be+=d*Ct,xe+=d*Pt,Ve+=d*ut,We+=d*Lt,Ze+=d*Mt,d=F[7],pt+=d*Et,qe+=d*gt,Ie+=d*Dt,Ne+=d*St,$e+=d*wt,Fe+=d*yt,Pe+=d*$t,Ue+=d*Ut,be+=d*It,Oe+=d*jt,Be+=d*xt,xe+=d*Ct,Ve+=d*Pt,We+=d*ut,Ze+=d*Lt,et+=d*Mt,d=F[8],qe+=d*Et,Ie+=d*gt,Ne+=d*Dt,$e+=d*St,Fe+=d*wt,Pe+=d*yt,Ue+=d*$t,be+=d*Ut,Oe+=d*It,Be+=d*jt,xe+=d*xt,Ve+=d*Ct,We+=d*Pt,Ze+=d*ut,et+=d*Lt,Je+=d*Mt,d=F[9],Ie+=d*Et,Ne+=d*gt,$e+=d*Dt,Fe+=d*St,Pe+=d*wt,Ue+=d*yt,be+=d*$t,Oe+=d*Ut,Be+=d*It,xe+=d*jt,Ve+=d*xt,We+=d*Ct,Ze+=d*Pt,et+=d*ut,Je+=d*Lt,er+=d*Mt,d=F[10],Ne+=d*Et,$e+=d*gt,Fe+=d*Dt,Pe+=d*St,Ue+=d*wt,be+=d*yt,Oe+=d*$t,Be+=d*Ut,xe+=d*It,Ve+=d*jt,We+=d*xt,Ze+=d*Ct,et+=d*Pt,Je+=d*ut,er+=d*Lt,hr+=d*Mt,d=F[11],$e+=d*Et,Fe+=d*gt,Pe+=d*Dt,Ue+=d*St,be+=d*wt,Oe+=d*yt,Be+=d*$t,xe+=d*Ut,Ve+=d*It,We+=d*jt,Ze+=d*xt,et+=d*Ct,Je+=d*Pt,er+=d*ut,hr+=d*Lt,Jr+=d*Mt,d=F[12],Fe+=d*Et,Pe+=d*gt,Ue+=d*Dt,be+=d*St,Oe+=d*wt,Be+=d*yt,xe+=d*$t,Ve+=d*Ut,We+=d*It,Ze+=d*jt,et+=d*xt,Je+=d*Ct,er+=d*Pt,hr+=d*ut,Jr+=d*Lt,tr+=d*Mt,d=F[13],Pe+=d*Et,Ue+=d*gt,be+=d*Dt,Oe+=d*St,Be+=d*wt,xe+=d*yt,Ve+=d*$t,We+=d*Ut,Ze+=d*It,et+=d*jt,Je+=d*xt,er+=d*Ct,hr+=d*Pt,Jr+=d*ut,tr+=d*Lt,oi+=d*Mt,d=F[14],Ue+=d*Et,be+=d*gt,Oe+=d*Dt,Be+=d*St,xe+=d*wt,Ve+=d*yt,We+=d*$t,Ze+=d*Ut,et+=d*It,Je+=d*jt,er+=d*xt,hr+=d*Ct,Jr+=d*Pt,tr+=d*ut,oi+=d*Lt,xi+=d*Mt,d=F[15],be+=d*Et,Oe+=d*gt,Be+=d*Dt,xe+=d*St,Ve+=d*wt,We+=d*yt,Ze+=d*$t,et+=d*Ut,Je+=d*It,er+=d*jt,hr+=d*xt,Jr+=d*Ct,tr+=d*Pt,oi+=d*ut,xi+=d*Lt,Hi+=d*Mt,se+=38*Oe,he+=38*Be,Ee+=38*xe,He+=38*Ve,ke+=38*We,Le+=38*Ze,dt+=38*et,pt+=38*Je,qe+=38*er,Ie+=38*hr,Ne+=38*Jr,$e+=38*tr,Fe+=38*oi,Pe+=38*xi,Ue+=38*Hi,T=1,d=se+T+65535,T=Math.floor(d/65536),se=d-T*65536,d=he+T+65535,T=Math.floor(d/65536),he=d-T*65536,d=Ee+T+65535,T=Math.floor(d/65536),Ee=d-T*65536,d=He+T+65535,T=Math.floor(d/65536),He=d-T*65536,d=ke+T+65535,T=Math.floor(d/65536),ke=d-T*65536,d=Le+T+65535,T=Math.floor(d/65536),Le=d-T*65536,d=dt+T+65535,T=Math.floor(d/65536),dt=d-T*65536,d=pt+T+65535,T=Math.floor(d/65536),pt=d-T*65536,d=qe+T+65535,T=Math.floor(d/65536),qe=d-T*65536,d=Ie+T+65535,T=Math.floor(d/65536),Ie=d-T*65536,d=Ne+T+65535,T=Math.floor(d/65536),Ne=d-T*65536,d=$e+T+65535,T=Math.floor(d/65536),$e=d-T*65536,d=Fe+T+65535,T=Math.floor(d/65536),Fe=d-T*65536,d=Pe+T+65535,T=Math.floor(d/65536),Pe=d-T*65536,d=Ue+T+65535,T=Math.floor(d/65536),Ue=d-T*65536,d=be+T+65535,T=Math.floor(d/65536),be=d-T*65536,se+=T-1+37*(T-1),T=1,d=se+T+65535,T=Math.floor(d/65536),se=d-T*65536,d=he+T+65535,T=Math.floor(d/65536),he=d-T*65536,d=Ee+T+65535,T=Math.floor(d/65536),Ee=d-T*65536,d=He+T+65535,T=Math.floor(d/65536),He=d-T*65536,d=ke+T+65535,T=Math.floor(d/65536),ke=d-T*65536,d=Le+T+65535,T=Math.floor(d/65536),Le=d-T*65536,d=dt+T+65535,T=Math.floor(d/65536),dt=d-T*65536,d=pt+T+65535,T=Math.floor(d/65536),pt=d-T*65536,d=qe+T+65535,T=Math.floor(d/65536),qe=d-T*65536,d=Ie+T+65535,T=Math.floor(d/65536),Ie=d-T*65536,d=Ne+T+65535,T=Math.floor(d/65536),Ne=d-T*65536,d=$e+T+65535,T=Math.floor(d/65536),$e=d-T*65536,d=Fe+T+65535,T=Math.floor(d/65536),Fe=d-T*65536,d=Pe+T+65535,T=Math.floor(d/65536),Pe=d-T*65536,d=Ue+T+65535,T=Math.floor(d/65536),Ue=d-T*65536,d=be+T+65535,T=Math.floor(d/65536),be=d-T*65536,se+=T-1+37*(T-1),z[0]=se,z[1]=he,z[2]=Ee,z[3]=He,z[4]=ke,z[5]=Le,z[6]=dt,z[7]=pt,z[8]=qe,z[9]=Ie,z[10]=Ne,z[11]=$e,z[12]=Fe,z[13]=Pe,z[14]=Ue,z[15]=be}function b(z,F){h(z,F,F)}function ee(z,F){const U=o();let d;for(d=0;d<16;d++)U[d]=F[d];for(d=253;d>=0;d--)b(U,U),d!==2&&d!==4&&h(U,U,F);for(d=0;d<16;d++)z[d]=U[d]}function ne(z,F){const U=o();let d;for(d=0;d<16;d++)U[d]=F[d];for(d=250;d>=0;d--)b(U,U),d!==1&&h(U,U,F);for(d=0;d<16;d++)z[d]=U[d]}function ue(z,F){const U=o(),d=o(),T=o(),se=o(),he=o(),Ee=o(),He=o(),ke=o(),Le=o();A(U,z[1],z[0]),A(Le,F[1],F[0]),h(U,U,Le),C(d,z[0],z[1]),C(Le,F[0],F[1]),h(d,d,Le),h(T,z[3],F[3]),h(T,T,p),h(se,z[2],F[2]),C(se,se,se),A(he,d,U),A(Ee,se,T),C(He,se,T),C(ke,d,U),h(z[0],he,Ee),h(z[1],ke,He),h(z[2],He,Ee),h(z[3],he,ke)}function ge(z,F,U){for(let d=0;d<4;d++)B(z[d],F[d],U)}function ye(z,F){const U=o(),d=o(),T=o();ee(T,F[2]),h(U,F[0],T),h(d,F[1],T),K(z,d),z[31]^=L(U)<<7}function S(z,F,U){x(z[0],l),x(z[1],f),x(z[2],f),x(z[3],l);for(let d=255;d>=0;--d){const T=U[d/8|0]>>(d&7)&1;ge(z,F,T),ue(F,z),ue(z,z),ge(z,F,T)}}function R(z,F){const U=[o(),o(),o(),o()];x(U[0],v),x(U[1],w),x(U[2],f),h(U[3],v,w),S(z,U,F)}function X(z){if(z.length!==i.SEED_LENGTH)throw new Error(`ed25519: seed must be ${i.SEED_LENGTH} bytes`);const F=(0,t.hash)(z);F[0]&=248,F[31]&=127,F[31]|=64;const U=new Uint8Array(32),d=[o(),o(),o(),o()];R(d,F),ye(U,d);const T=new Uint8Array(64);return T.set(z),T.set(U,32),{publicKey:U,secretKey:T}}i.generateKeyPairFromSeed=X;function J(z){const F=(0,e.randomBytes)(32,z),U=X(F);return(0,s.wipe)(F),U}i.generateKeyPair=J;function k(z){if(z.length!==i.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${i.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(z.subarray(32))}i.extractPublicKeyFromSecretKey=k;const V=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function te(z,F){let U,d,T,se;for(d=63;d>=32;--d){for(U=0,T=d-32,se=d-12;T<se;++T)F[T]+=U-16*F[d]*V[T-(d-32)],U=Math.floor((F[T]+128)/256),F[T]-=U*256;F[T]+=U,F[d]=0}for(U=0,T=0;T<32;T++)F[T]+=U-(F[31]>>4)*V[T],U=F[T]>>8,F[T]&=255;for(T=0;T<32;T++)F[T]-=U*V[T];for(d=0;d<32;d++)F[d+1]+=F[d]>>8,z[d]=F[d]&255}function ie(z){const F=new Float64Array(64);for(let U=0;U<64;U++)F[U]=z[U];for(let U=0;U<64;U++)z[U]=0;te(z,F)}function De(z,F){const U=new Float64Array(64),d=[o(),o(),o(),o()],T=(0,t.hash)(z.subarray(0,32));T[0]&=248,T[31]&=127,T[31]|=64;const se=new Uint8Array(64);se.set(T.subarray(32),32);const he=new t.SHA512;he.update(se.subarray(32)),he.update(F);const Ee=he.digest();he.clean(),ie(Ee),R(d,Ee),ye(se,d),he.reset(),he.update(se.subarray(0,32)),he.update(z.subarray(32)),he.update(F);const He=he.digest();ie(He);for(let ke=0;ke<32;ke++)U[ke]=Ee[ke];for(let ke=0;ke<32;ke++)for(let Le=0;Le<32;Le++)U[ke+Le]+=He[ke]*T[Le];return te(se.subarray(32),U),se}i.sign=De;function oe(z,F){const U=o(),d=o(),T=o(),se=o(),he=o(),Ee=o(),He=o();return x(z[2],f),P(z[1],F),b(T,z[1]),h(se,T,g),A(T,T,z[2]),C(se,z[2],se),b(he,se),b(Ee,he),h(He,Ee,he),h(U,He,T),h(U,U,se),ne(U,U),h(U,U,T),h(U,U,se),h(U,U,se),h(z[0],U,se),b(d,z[0]),h(d,d,se),$(d,T)&&h(z[0],z[0],E),b(d,z[0]),h(d,d,se),$(d,T)?-1:(L(z[0])===F[31]>>7&&A(z[0],l,z[0]),h(z[3],z[0],z[1]),0)}function Se(z,F,U){const d=new Uint8Array(32),T=[o(),o(),o(),o()],se=[o(),o(),o(),o()];if(U.length!==i.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${i.SIGNATURE_LENGTH} bytes`);if(oe(se,z))return!1;const he=new t.SHA512;he.update(U.subarray(0,32)),he.update(z),he.update(F);const Ee=he.digest();return ie(Ee),S(T,se,Ee),R(se,U.subarray(32)),ue(T,se),ye(d,T),!Z(U,d)}i.verify=Se;function le(z){let F=[o(),o(),o(),o()];if(oe(F,z))throw new Error("Ed25519: invalid public key");let U=o(),d=o(),T=F[1];C(U,f,T),A(d,f,T),ee(d,d),h(U,U,d);let se=new Uint8Array(32);return K(se,U),se}i.convertPublicKeyToX25519=le;function Ae(z){const F=(0,t.hash)(z.subarray(0,32));F[0]&=248,F[31]&=127,F[31]|=64;const U=new Uint8Array(F.subarray(0,32));return(0,s.wipe)(F),U}i.convertSecretKeyToX25519=Ae})(sh);const I2="EdDSA",x2="JWT",Rp=".",Np="base64url",P2="utf8",O2="utf8",C2=":",A2="did",T2="key",rd="base58btc",R2="z",N2="K36",$2=32;function sa(i){return ur(mr(an(i),P2),Np)}function $p(i){const e=mr(N2,rd),t=R2+ur(Eu([e,i]),rd);return[A2,T2,t].join(C2)}function U2(i){return ur(i,Np)}function j2(i){return mr([sa(i.header),sa(i.payload)].join(Rp),O2)}function L2(i){return[sa(i.header),sa(i.payload),U2(i.signature)].join(Rp)}function id(i=zn.randomBytes($2)){return sh.generateKeyPairFromSeed(i)}async function M2(i,e,t,s,o=ve.fromMiliseconds(Date.now())){const c={alg:I2,typ:x2},l=$p(s.publicKey),f=o+t,g={iss:l,sub:i,aud:e,iat:o,exp:f},p=j2({header:c,payload:g}),v=sh.sign(s.secretKey,p);return L2({header:c,payload:g,signature:v})}const q2="PARSE_ERROR",F2="INVALID_REQUEST",z2="METHOD_NOT_FOUND",H2="INVALID_PARAMS",Up="INTERNAL_ERROR",oh="SERVER_ERROR",B2=[-32700,-32600,-32601,-32602,-32603],Es={[q2]:{code:-32700,message:"Parse error"},[F2]:{code:-32600,message:"Invalid Request"},[z2]:{code:-32601,message:"Method not found"},[H2]:{code:-32602,message:"Invalid params"},[Up]:{code:-32603,message:"Internal error"},[oh]:{code:-32e3,message:"Server error"}},jp=oh;function K2(i){return B2.includes(i)}function nd(i){return Object.keys(Es).includes(i)?Es[i]:Es[jp]}function k2(i){const e=Object.values(Es).find(t=>t.code===i);return e||Es[jp]}function Lp(i,e,t){return i.message.includes("getaddrinfo ENOTFOUND")||i.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):i}var Mp={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ju=function(i,e){return ju=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},ju(i,e)};function V2(i,e){ju(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Lu=function(){return Lu=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Lu.apply(this,arguments)};function G2(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function W2(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(l=i[f])&&(c=(o<3?l(c):o>3?l(e,t,c):l(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function Y2(i,e){return function(t,s){e(t,s,i)}}function J2(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function Q2(i,e,t,s){function o(c){return c instanceof t?c:new t(function(l){l(c)})}return new(t||(t=Promise))(function(c,l){function f(v){try{p(s.next(v))}catch(w){l(w)}}function g(v){try{p(s.throw(v))}catch(w){l(w)}}function p(v){v.done?c(v.value):o(v.value).then(f,g)}p((s=s.apply(i,e||[])).next())})}function X2(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,l;return l={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function f(p){return function(v){return g([p,v])}}function g(p){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(i,t)}catch(v){p=[6,v],o=0}finally{s=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function Z2(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function e6(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function Mu(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function qp(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],l;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){l={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(l)throw l.error}}return c}function t6(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(qp(arguments[e]));return i}function r6(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],l=0,f=c.length;l<f;l++,o++)s[o]=c[l];return s}function As(i){return this instanceof As?(this.v=i,this):new As(i)}function i6(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(E){s[E]&&(o[E]=function(x){return new Promise(function(I,B){c.push([E,x,I,B])>1||f(E,x)})})}function f(E,x){try{g(s[E](x))}catch(I){w(c[0][3],I)}}function g(E){E.value instanceof As?Promise.resolve(E.value.v).then(p,v):w(c[0][2],E)}function p(E){f("next",E)}function v(E){f("throw",E)}function w(E,x){E(x),c.shift(),c.length&&f(c[0][0],c[0][1])}}function n6(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(l){return(t=!t)?{value:As(i[o](l)),done:o==="return"}:c?c(l):l}:c}}function s6(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof Mu=="function"?Mu(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(l){return new Promise(function(f,g){l=i[c](l),o(f,g,l.done,l.value)})}}function o(c,l,f,g){Promise.resolve(g).then(function(p){c({value:p,done:f})},l)}}function o6(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function a6(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function c6(i){return i&&i.__esModule?i:{default:i}}function u6(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function h6(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const l6=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Lu},__asyncDelegator:n6,__asyncGenerator:i6,__asyncValues:s6,__await:As,__awaiter:Q2,__classPrivateFieldGet:u6,__classPrivateFieldSet:h6,__createBinding:Z2,__decorate:W2,__exportStar:e6,__extends:V2,__generator:X2,__importDefault:c6,__importStar:a6,__makeTemplateObject:o6,__metadata:J2,__param:Y2,__read:qp,__rest:G2,__spread:t6,__spreadArrays:r6,__values:Mu},Symbol.toStringTag,{value:"Module"})),f6=Ts(l6);var mi={},sd;function d6(){if(sd)return mi;sd=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.isBrowserCryptoAvailable=mi.getSubtleCrypto=mi.getBrowerCrypto=void 0;function i(){return(Yr===null||Yr===void 0?void 0:Yr.crypto)||(Yr===null||Yr===void 0?void 0:Yr.msCrypto)||{}}mi.getBrowerCrypto=i;function e(){const s=i();return s.subtle||s.webkitSubtle}mi.getSubtleCrypto=e;function t(){return!!i()&&!!e()}return mi.isBrowserCryptoAvailable=t,mi}var _i={},od;function p6(){if(od)return _i;od=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.isBrowser=_i.isNode=_i.isReactNative=void 0;function i(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}_i.isReactNative=i;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}_i.isNode=e;function t(){return!i()&&!e()}return _i.isBrowser=t,_i}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=f6;e.__exportStar(d6(),i),e.__exportStar(p6(),i)})(Mp);function ah(i=3){const e=Date.now()*Math.pow(10,i),t=Math.floor(Math.random()*Math.pow(10,i));return e+t}function Fp(i=6){return BigInt(ah(i))}function Fn(i,e,t){return{id:t||ah(),jsonrpc:"2.0",method:i,params:e}}function wa(i,e){return{id:i,jsonrpc:"2.0",result:e}}function ba(i,e,t){return{id:i,jsonrpc:"2.0",error:g6(e,t)}}function g6(i,e){return typeof i>"u"?nd(Up):(typeof i=="string"&&(i=Object.assign(Object.assign({},nd(oh)),{message:i})),typeof e<"u"&&(i.data=e),K2(i.code)&&(i=k2(i.code)),i)}class y6{}class v6 extends y6{constructor(){super()}}class m6 extends v6{constructor(e){super()}}const _6="^https?:",w6="^wss?:";function b6(i){const e=i.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function zp(i,e){const t=b6(i);return typeof t>"u"?!1:new RegExp(e).test(t)}function ad(i){return zp(i,_6)}function cd(i){return zp(i,w6)}function E6(i){return new RegExp("wss?://localhost(:d{2,5})?").test(i)}function Hp(i){return typeof i=="object"&&"id"in i&&"jsonrpc"in i&&i.jsonrpc==="2.0"}function ch(i){return Hp(i)&&"method"in i}function Ea(i){return Hp(i)&&(Di(i)||Wr(i))}function Di(i){return"result"in i}function Wr(i){return"error"in i}class Si extends m6{constructor(e){super(e),this.events=new Fr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Fn(e.method,e.params||[],e.id||Fp().toString()),t)}async requestStrict(e,t){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${e.id}`,c=>{Wr(c)?o(c.error):s(c.result)});try{await this.connection.send(e,t)}catch(c){o(c)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Ea(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const D6=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),S6=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",ud=i=>i.split("?")[0],hd=10,I6=D6();let x6=class{constructor(e){if(this.url=e,this.events=new Fr.EventEmitter,this.registering=!1,!cd(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(an(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!cd(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,s)=>{const o=new URLSearchParams(e).get("origin"),c=Mp.isReactNative()?{headers:{origin:o}}:{rejectUnauthorized:!E6(e)},l=new I6(e,[],c);S6()?l.onerror=f=>{const g=f;s(this.emitError(g.error))}:l.on("error",f=>{s(this.emitError(f))}),l.onopen=()=>{this.onOpen(l),t(l)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Ls(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=ba(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return Lp(e,ud(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>hd&&this.events.setMaxListeners(hd)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${ud(this.url)}`));return this.events.emit("register_error",t),t}};var oa={exports:{}};oa.exports;(function(i,e){var t=200,s="__lodash_hash_undefined__",o=1,c=2,l=9007199254740991,f="[object Arguments]",g="[object Array]",p="[object AsyncFunction]",v="[object Boolean]",w="[object Date]",E="[object Error]",x="[object Function]",I="[object GeneratorFunction]",B="[object Map]",K="[object Number]",Z="[object Null]",$="[object Object]",L="[object Promise]",P="[object Proxy]",C="[object RegExp]",A="[object Set]",h="[object String]",b="[object Symbol]",ee="[object Undefined]",ne="[object WeakMap]",ue="[object ArrayBuffer]",ge="[object DataView]",ye="[object Float32Array]",S="[object Float64Array]",R="[object Int8Array]",X="[object Int16Array]",J="[object Int32Array]",k="[object Uint8Array]",V="[object Uint8ClampedArray]",te="[object Uint16Array]",ie="[object Uint32Array]",De=/[\\^$.*+?()[\]{}|]/g,oe=/^\[object .+?Constructor\]$/,Se=/^(?:0|[1-9]\d*)$/,le={};le[ye]=le[S]=le[R]=le[X]=le[J]=le[k]=le[V]=le[te]=le[ie]=!0,le[f]=le[g]=le[ue]=le[v]=le[ge]=le[w]=le[E]=le[x]=le[B]=le[K]=le[$]=le[C]=le[A]=le[h]=le[ne]=!1;var Ae=typeof Yr=="object"&&Yr&&Yr.Object===Object&&Yr,z=typeof self=="object"&&self&&self.Object===Object&&self,F=Ae||z||Function("return this")(),U=e&&!e.nodeType&&e,d=U&&!0&&i&&!i.nodeType&&i,T=d&&d.exports===U,se=T&&Ae.process,he=function(){try{return se&&se.binding&&se.binding("util")}catch{}}(),Ee=he&&he.isTypedArray;function He(D,j){for(var Q=-1,fe=D==null?0:D.length,ot=0,Te=[];++Q<fe;){var lt=D[Q];j(lt,Q,D)&&(Te[ot++]=lt)}return Te}function ke(D,j){for(var Q=-1,fe=j.length,ot=D.length;++Q<fe;)D[ot+Q]=j[Q];return D}function Le(D,j){for(var Q=-1,fe=D==null?0:D.length;++Q<fe;)if(j(D[Q],Q,D))return!0;return!1}function dt(D,j){for(var Q=-1,fe=Array(D);++Q<D;)fe[Q]=j(Q);return fe}function pt(D){return function(j){return D(j)}}function qe(D,j){return D.has(j)}function Ie(D,j){return D==null?void 0:D[j]}function Ne(D){var j=-1,Q=Array(D.size);return D.forEach(function(fe,ot){Q[++j]=[ot,fe]}),Q}function $e(D,j){return function(Q){return D(j(Q))}}function Fe(D){var j=-1,Q=Array(D.size);return D.forEach(function(fe){Q[++j]=fe}),Q}var Pe=Array.prototype,Ue=Function.prototype,be=Object.prototype,Oe=F["__core-js_shared__"],Be=Ue.toString,xe=be.hasOwnProperty,Ve=function(){var D=/[^.]+$/.exec(Oe&&Oe.keys&&Oe.keys.IE_PROTO||"");return D?"Symbol(src)_1."+D:""}(),We=be.toString,Ze=RegExp("^"+Be.call(xe).replace(De,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),et=T?F.Buffer:void 0,Je=F.Symbol,er=F.Uint8Array,hr=be.propertyIsEnumerable,Jr=Pe.splice,tr=Je?Je.toStringTag:void 0,oi=Object.getOwnPropertySymbols,xi=et?et.isBuffer:void 0,Hi=$e(Object.keys,Object),Et=br(F,"DataView"),gt=br(F,"Map"),Dt=br(F,"Promise"),St=br(F,"Set"),wt=br(F,"WeakMap"),yt=br(Object,"create"),$t=ci(Et),Ut=ci(gt),It=ci(Dt),jt=ci(St),xt=ci(wt),Ct=Je?Je.prototype:void 0,Pt=Ct?Ct.valueOf:void 0;function ut(D){var j=-1,Q=D==null?0:D.length;for(this.clear();++j<Q;){var fe=D[j];this.set(fe[0],fe[1])}}function Lt(){this.__data__=yt?yt(null):{},this.size=0}function Mt(D){var j=this.has(D)&&delete this.__data__[D];return this.size-=j?1:0,j}function Ia(D){var j=this.__data__;if(yt){var Q=j[D];return Q===s?void 0:Q}return xe.call(j,D)?j[D]:void 0}function xa(D){var j=this.__data__;return yt?j[D]!==void 0:xe.call(j,D)}function Pa(D,j){var Q=this.__data__;return this.size+=this.has(D)?0:1,Q[D]=yt&&j===void 0?s:j,this}ut.prototype.clear=Lt,ut.prototype.delete=Mt,ut.prototype.get=Ia,ut.prototype.has=xa,ut.prototype.set=Pa;function Ar(D){var j=-1,Q=D==null?0:D.length;for(this.clear();++j<Q;){var fe=D[j];this.set(fe[0],fe[1])}}function Oa(){this.__data__=[],this.size=0}function Ca(D){var j=this.__data__,Q=Bi(j,D);if(Q<0)return!1;var fe=j.length-1;return Q==fe?j.pop():Jr.call(j,Q,1),--this.size,!0}function Aa(D){var j=this.__data__,Q=Bi(j,D);return Q<0?void 0:j[Q][1]}function Ta(D){return Bi(this.__data__,D)>-1}function Ra(D,j){var Q=this.__data__,fe=Bi(Q,D);return fe<0?(++this.size,Q.push([D,j])):Q[fe][1]=j,this}Ar.prototype.clear=Oa,Ar.prototype.delete=Ca,Ar.prototype.get=Aa,Ar.prototype.has=Ta,Ar.prototype.set=Ra;function ai(D){var j=-1,Q=D==null?0:D.length;for(this.clear();++j<Q;){var fe=D[j];this.set(fe[0],fe[1])}}function dn(){this.size=0,this.__data__={hash:new ut,map:new(gt||Ar),string:new ut}}function Na(D){var j=Pi(this,D).delete(D);return this.size-=j?1:0,j}function pn(D){return Pi(this,D).get(D)}function $a(D){return Pi(this,D).has(D)}function Ua(D,j){var Q=Pi(this,D),fe=Q.size;return Q.set(D,j),this.size+=Q.size==fe?0:1,this}ai.prototype.clear=dn,ai.prototype.delete=Na,ai.prototype.get=pn,ai.prototype.has=$a,ai.prototype.set=Ua;function gn(D){var j=-1,Q=D==null?0:D.length;for(this.__data__=new ai;++j<Q;)this.add(D[j])}function Fs(D){return this.__data__.set(D,s),this}function zs(D){return this.__data__.has(D)}gn.prototype.add=gn.prototype.push=Fs,gn.prototype.has=zs;function zr(D){var j=this.__data__=new Ar(D);this.size=j.size}function ja(){this.__data__=new Ar,this.size=0}function La(D){var j=this.__data__,Q=j.delete(D);return this.size=j.size,Q}function Ma(D){return this.__data__.get(D)}function qa(D){return this.__data__.has(D)}function Hs(D,j){var Q=this.__data__;if(Q instanceof Ar){var fe=Q.__data__;if(!gt||fe.length<t-1)return fe.push([D,j]),this.size=++Q.size,this;Q=this.__data__=new ai(fe)}return Q.set(D,j),this.size=Q.size,this}zr.prototype.clear=ja,zr.prototype.delete=La,zr.prototype.get=Ma,zr.prototype.has=qa,zr.prototype.set=Hs;function Bs(D,j){var Q=mn(D),fe=!Q&&to(D),ot=!Q&&!fe&&Yn(D),Te=!Q&&!fe&&!ot&&no(D),lt=Q||fe||ot||Te,qt=lt?dt(D.length,String):[],Qe=qt.length;for(var at in D)(j||xe.call(D,at))&&!(lt&&(at=="length"||ot&&(at=="offset"||at=="parent")||Te&&(at=="buffer"||at=="byteLength"||at=="byteOffset")||Js(at,Qe)))&&qt.push(at);return qt}function Bi(D,j){for(var Q=D.length;Q--;)if(eo(D[Q][0],j))return Q;return-1}function Gn(D,j,Q){var fe=j(D);return mn(D)?fe:ke(fe,Q(D))}function Ki(D){return D==null?D===void 0?ee:Z:tr&&tr in Object(D)?Ws(D):Ha(D)}function Wn(D){return Vi(D)&&Ki(D)==f}function ki(D,j,Q,fe,ot){return D===j?!0:D==null||j==null||!Vi(D)&&!Vi(j)?D!==D&&j!==j:Ks(D,j,Q,fe,ki,ot)}function Ks(D,j,Q,fe,ot,Te){var lt=mn(D),qt=mn(j),Qe=lt?g:Qr(D),at=qt?g:Qr(j);Qe=Qe==f?$:Qe,at=at==f?$:at;var At=Qe==$,lr=at==$,Ft=Qe==at;if(Ft&&Yn(D)){if(!Yn(j))return!1;lt=!0,At=!1}if(Ft&&!At)return Te||(Te=new zr),lt||no(D)?yn(D,j,Q,fe,ot,Te):za(D,j,Qe,Q,fe,ot,Te);if(!(Q&o)){var ft=At&&xe.call(D,"__wrapped__"),rr=lr&&xe.call(j,"__wrapped__");if(ft||rr){var Hr=ft?D.value():D,Tr=rr?j.value():j;return Te||(Te=new zr),ot(Hr,Tr,Q,fe,Te)}}return Ft?(Te||(Te=new zr),Gs(D,j,Q,fe,ot,Te)):!1}function Fa(D){if(!io(D)||Xs(D))return!1;var j=_n(D)?Ze:oe;return j.test(ci(D))}function ks(D){return Vi(D)&&ro(D.length)&&!!le[Ki(D)]}function Vs(D){if(!Zs(D))return Hi(D);var j=[];for(var Q in Object(D))xe.call(D,Q)&&Q!="constructor"&&j.push(Q);return j}function yn(D,j,Q,fe,ot,Te){var lt=Q&o,qt=D.length,Qe=j.length;if(qt!=Qe&&!(lt&&Qe>qt))return!1;var at=Te.get(D);if(at&&Te.get(j))return at==j;var At=-1,lr=!0,Ft=Q&c?new gn:void 0;for(Te.set(D,j),Te.set(j,D);++At<qt;){var ft=D[At],rr=j[At];if(fe)var Hr=lt?fe(rr,ft,At,j,D,Te):fe(ft,rr,At,D,j,Te);if(Hr!==void 0){if(Hr)continue;lr=!1;break}if(Ft){if(!Le(j,function(Tr,Xr){if(!qe(Ft,Xr)&&(ft===Tr||ot(ft,Tr,Q,fe,Te)))return Ft.push(Xr)})){lr=!1;break}}else if(!(ft===rr||ot(ft,rr,Q,fe,Te))){lr=!1;break}}return Te.delete(D),Te.delete(j),lr}function za(D,j,Q,fe,ot,Te,lt){switch(Q){case ge:if(D.byteLength!=j.byteLength||D.byteOffset!=j.byteOffset)return!1;D=D.buffer,j=j.buffer;case ue:return!(D.byteLength!=j.byteLength||!Te(new er(D),new er(j)));case v:case w:case K:return eo(+D,+j);case E:return D.name==j.name&&D.message==j.message;case C:case h:return D==j+"";case B:var qt=Ne;case A:var Qe=fe&o;if(qt||(qt=Fe),D.size!=j.size&&!Qe)return!1;var at=lt.get(D);if(at)return at==j;fe|=c,lt.set(D,j);var At=yn(qt(D),qt(j),fe,ot,Te,lt);return lt.delete(D),At;case b:if(Pt)return Pt.call(D)==Pt.call(j)}return!1}function Gs(D,j,Q,fe,ot,Te){var lt=Q&o,qt=vn(D),Qe=qt.length,at=vn(j),At=at.length;if(Qe!=At&&!lt)return!1;for(var lr=Qe;lr--;){var Ft=qt[lr];if(!(lt?Ft in j:xe.call(j,Ft)))return!1}var ft=Te.get(D);if(ft&&Te.get(j))return ft==j;var rr=!0;Te.set(D,j),Te.set(j,D);for(var Hr=lt;++lr<Qe;){Ft=qt[lr];var Tr=D[Ft],Xr=j[Ft];if(fe)var Jn=lt?fe(Xr,Tr,Ft,j,D,Te):fe(Tr,Xr,Ft,D,j,Te);if(!(Jn===void 0?Tr===Xr||ot(Tr,Xr,Q,fe,Te):Jn)){rr=!1;break}Hr||(Hr=Ft=="constructor")}if(rr&&!Hr){var Gi=D.constructor,Bt=j.constructor;Gi!=Bt&&"constructor"in D&&"constructor"in j&&!(typeof Gi=="function"&&Gi instanceof Gi&&typeof Bt=="function"&&Bt instanceof Bt)&&(rr=!1)}return Te.delete(D),Te.delete(j),rr}function vn(D){return Gn(D,ka,Ys)}function Pi(D,j){var Q=D.__data__;return Qs(j)?Q[typeof j=="string"?"string":"hash"]:Q.map}function br(D,j){var Q=Ie(D,j);return Fa(Q)?Q:void 0}function Ws(D){var j=xe.call(D,tr),Q=D[tr];try{D[tr]=void 0;var fe=!0}catch{}var ot=We.call(D);return fe&&(j?D[tr]=Q:delete D[tr]),ot}var Ys=oi?function(D){return D==null?[]:(D=Object(D),He(oi(D),function(j){return hr.call(D,j)}))}:st,Qr=Ki;(Et&&Qr(new Et(new ArrayBuffer(1)))!=ge||gt&&Qr(new gt)!=B||Dt&&Qr(Dt.resolve())!=L||St&&Qr(new St)!=A||wt&&Qr(new wt)!=ne)&&(Qr=function(D){var j=Ki(D),Q=j==$?D.constructor:void 0,fe=Q?ci(Q):"";if(fe)switch(fe){case $t:return ge;case Ut:return B;case It:return L;case jt:return A;case xt:return ne}return j});function Js(D,j){return j=j??l,!!j&&(typeof D=="number"||Se.test(D))&&D>-1&&D%1==0&&D<j}function Qs(D){var j=typeof D;return j=="string"||j=="number"||j=="symbol"||j=="boolean"?D!=="__proto__":D===null}function Xs(D){return!!Ve&&Ve in D}function Zs(D){var j=D&&D.constructor,Q=typeof j=="function"&&j.prototype||be;return D===Q}function Ha(D){return We.call(D)}function ci(D){if(D!=null){try{return Be.call(D)}catch{}try{return D+""}catch{}}return""}function eo(D,j){return D===j||D!==D&&j!==j}var to=Wn(function(){return arguments}())?Wn:function(D){return Vi(D)&&xe.call(D,"callee")&&!hr.call(D,"callee")},mn=Array.isArray;function Ba(D){return D!=null&&ro(D.length)&&!_n(D)}var Yn=xi||nt;function Ka(D,j){return ki(D,j)}function _n(D){if(!io(D))return!1;var j=Ki(D);return j==x||j==I||j==p||j==P}function ro(D){return typeof D=="number"&&D>-1&&D%1==0&&D<=l}function io(D){var j=typeof D;return D!=null&&(j=="object"||j=="function")}function Vi(D){return D!=null&&typeof D=="object"}var no=Ee?pt(Ee):ks;function ka(D){return Ba(D)?Bs(D):Vs(D)}function st(){return[]}function nt(){return!1}i.exports=Ka})(oa,oa.exports);var P6=oa.exports;const O6=ca(P6);function C6(i,e){return e=e||{},new Promise(function(t,s){var o=new XMLHttpRequest,c=[],l=[],f={},g=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:g,headers:{keys:function(){return c},entries:function(){return l},get:function(v){return f[v.toLowerCase()]},has:function(v){return v.toLowerCase()in f}}}};for(var p in o.open(e.method||"get",i,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(v,w,E){c.push(w=w.toLowerCase()),l.push([w,E]),f[w]=f[w]?f[w]+","+E:E}),t(g())},o.onerror=s,o.withCredentials=e.credentials=="include",e.headers)o.setRequestHeader(p,e.headers[p]);o.send(e.body||null)})}const A6=Object.freeze(Object.defineProperty({__proto__:null,default:C6},Symbol.toStringTag,{value:"Module"})),ld=Ts(A6);var T6=self.fetch||(self.fetch=ld.default||ld);const R6=ca(T6);var N6={};function $6(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<i.length;o++){var c=i.charAt(o),l=c.charCodeAt(0);if(t[l]!==255)throw new TypeError(c+" is ambiguous");t[l]=o}var f=i.length,g=i.charAt(0),p=Math.log(f)/Math.log(256),v=Math.log(256)/Math.log(f);function w(I){if(I instanceof Uint8Array||(ArrayBuffer.isView(I)?I=new Uint8Array(I.buffer,I.byteOffset,I.byteLength):Array.isArray(I)&&(I=Uint8Array.from(I))),!(I instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(I.length===0)return"";for(var B=0,K=0,Z=0,$=I.length;Z!==$&&I[Z]===0;)Z++,B++;for(var L=($-Z)*v+1>>>0,P=new Uint8Array(L);Z!==$;){for(var C=I[Z],A=0,h=L-1;(C!==0||A<K)&&h!==-1;h--,A++)C+=256*P[h]>>>0,P[h]=C%f>>>0,C=C/f>>>0;if(C!==0)throw new Error("Non-zero carry");K=A,Z++}for(var b=L-K;b!==L&&P[b]===0;)b++;for(var ee=g.repeat(B);b<L;++b)ee+=i.charAt(P[b]);return ee}function E(I){if(typeof I!="string")throw new TypeError("Expected String");if(I.length===0)return new Uint8Array;var B=0;if(I[B]!==" "){for(var K=0,Z=0;I[B]===g;)K++,B++;for(var $=(I.length-B)*p+1>>>0,L=new Uint8Array($);I[B];){var P=t[I.charCodeAt(B)];if(P===255)return;for(var C=0,A=$-1;(P!==0||C<Z)&&A!==-1;A--,C++)P+=f*L[A]>>>0,L[A]=P%256>>>0,P=P/256>>>0;if(P!==0)throw new Error("Non-zero carry");Z=C,B++}if(I[B]!==" "){for(var h=$-Z;h!==$&&L[h]===0;)h++;for(var b=new Uint8Array(K+($-h)),ee=K;h!==$;)b[ee++]=L[h++];return b}}}function x(I){var B=E(I);if(B)return B;throw new Error(`Non-${e} character`)}return{encode:w,decodeUnsafe:E,decode:x}}var U6=$6,j6=U6;const Bp=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},L6=i=>new TextEncoder().encode(i),M6=i=>new TextDecoder().decode(i);class q6{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class F6{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Kp(this,e)}}class z6{constructor(e){this.decoders=e}or(e){return Kp(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Kp=(i,e)=>new z6({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}});class H6{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new q6(e,t,s),this.decoder=new F6(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Da=({name:i,prefix:e,encode:t,decode:s})=>new H6(i,e,t,s),qs=({prefix:i,name:e,alphabet:t})=>{const{encode:s,decode:o}=j6(t,e);return Da({prefix:i,name:e,encode:s,decode:c=>Bp(o(c))})},B6=(i,e,t,s)=>{const o={};for(let v=0;v<e.length;++v)o[e[v]]=v;let c=i.length;for(;i[c-1]==="=";)--c;const l=new Uint8Array(c*t/8|0);let f=0,g=0,p=0;for(let v=0;v<c;++v){const w=o[i[v]];if(w===void 0)throw new SyntaxError(`Non-${s} character`);g=g<<t|w,f+=t,f>=8&&(f-=8,l[p++]=255&g>>f)}if(f>=t||255&g<<8-f)throw new SyntaxError("Unexpected end of data");return l},K6=(i,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",l=0,f=0;for(let g=0;g<i.length;++g)for(f=f<<8|i[g],l+=8;l>t;)l-=t,c+=e[o&f>>l];if(l&&(c+=e[o&f<<t-l]),s)for(;c.length*t&7;)c+="=";return c},Yt=({name:i,prefix:e,bitsPerChar:t,alphabet:s})=>Da({prefix:e,name:i,encode(o){return K6(o,s,t)},decode(o){return B6(o,s,t,i)}}),k6=Da({prefix:"\0",name:"identity",encode:i=>M6(i),decode:i=>L6(i)});var V6=Object.freeze({__proto__:null,identity:k6});const G6=Yt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var W6=Object.freeze({__proto__:null,base2:G6});const Y6=Yt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var J6=Object.freeze({__proto__:null,base8:Y6});const Q6=qs({prefix:"9",name:"base10",alphabet:"0123456789"});var X6=Object.freeze({__proto__:null,base10:Q6});const Z6=Yt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),eS=Yt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var tS=Object.freeze({__proto__:null,base16:Z6,base16upper:eS});const rS=Yt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),iS=Yt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),nS=Yt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),sS=Yt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),oS=Yt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),aS=Yt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),cS=Yt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),uS=Yt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),hS=Yt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var lS=Object.freeze({__proto__:null,base32:rS,base32upper:iS,base32pad:nS,base32padupper:sS,base32hex:oS,base32hexupper:aS,base32hexpad:cS,base32hexpadupper:uS,base32z:hS});const fS=qs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),dS=qs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var pS=Object.freeze({__proto__:null,base36:fS,base36upper:dS});const gS=qs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),yS=qs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var vS=Object.freeze({__proto__:null,base58btc:gS,base58flickr:yS});const mS=Yt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),_S=Yt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),wS=Yt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),bS=Yt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var ES=Object.freeze({__proto__:null,base64:mS,base64pad:_S,base64url:wS,base64urlpad:bS});const kp=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),DS=kp.reduce((i,e,t)=>(i[t]=e,i),[]),SS=kp.reduce((i,e,t)=>(i[e.codePointAt(0)]=t,i),[]);function IS(i){return i.reduce((e,t)=>(e+=DS[t],e),"")}function xS(i){const e=[];for(const t of i){const s=SS[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const PS=Da({prefix:"🚀",name:"base256emoji",encode:IS,decode:xS});var OS=Object.freeze({__proto__:null,base256emoji:PS}),CS=Vp,fd=128,AS=127,TS=~AS,RS=Math.pow(2,31);function Vp(i,e,t){e=e||[],t=t||0;for(var s=t;i>=RS;)e[t++]=i&255|fd,i/=128;for(;i&TS;)e[t++]=i&255|fd,i>>>=7;return e[t]=i|0,Vp.bytes=t-s+1,e}var NS=qu,$S=128,dd=127;function qu(i,s){var t=0,s=s||0,o=0,c=s,l,f=i.length;do{if(c>=f)throw qu.bytes=0,new RangeError("Could not decode varint");l=i[c++],t+=o<28?(l&dd)<<o:(l&dd)*Math.pow(2,o),o+=7}while(l>=$S);return qu.bytes=c-s,t}var US=Math.pow(2,7),jS=Math.pow(2,14),LS=Math.pow(2,21),MS=Math.pow(2,28),qS=Math.pow(2,35),FS=Math.pow(2,42),zS=Math.pow(2,49),HS=Math.pow(2,56),BS=Math.pow(2,63),KS=function(i){return i<US?1:i<jS?2:i<LS?3:i<MS?4:i<qS?5:i<FS?6:i<zS?7:i<HS?8:i<BS?9:10},kS={encode:CS,decode:NS,encodingLength:KS},Gp=kS;const pd=(i,e,t=0)=>(Gp.encode(i,e,t),e),gd=i=>Gp.encodingLength(i),Fu=(i,e)=>{const t=e.byteLength,s=gd(i),o=s+gd(t),c=new Uint8Array(o+t);return pd(i,c,0),pd(t,c,s),c.set(e,o),new VS(i,t,e,c)};class VS{constructor(e,t,s,o){this.code=e,this.size=t,this.digest=s,this.bytes=o}}const Wp=({name:i,code:e,encode:t})=>new GS(i,e,t);class GS{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Fu(this.code,t):t.then(s=>Fu(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Yp=i=>async e=>new Uint8Array(await crypto.subtle.digest(i,e)),WS=Wp({name:"sha2-256",code:18,encode:Yp("SHA-256")}),YS=Wp({name:"sha2-512",code:19,encode:Yp("SHA-512")});var JS=Object.freeze({__proto__:null,sha256:WS,sha512:YS});const Jp=0,QS="identity",Qp=Bp,XS=i=>Fu(Jp,Qp(i)),ZS={code:Jp,name:QS,encode:Qp,digest:XS};var eI=Object.freeze({__proto__:null,identity:ZS});new TextEncoder,new TextDecoder;const yd={...V6,...W6,...J6,...X6,...tS,...lS,...pS,...vS,...ES,...OS};({...JS,...eI});function Xp(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function tI(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Xp(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function Zp(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const vd=Zp("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),cu=Zp("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=tI(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),rI={utf8:vd,"utf-8":vd,hex:yd.base16,latin1:cu,ascii:cu,binary:cu,...yd};function iI(i,e="utf8"){const t=rI[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Xp(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}const eg="wc",nI=2,uh="core",Mi=`${eg}@2:${uh}:`,sI={name:uh,logger:"error"},oI={database:":memory:"},aI="crypto",md="client_ed25519_seed",cI=ve.ONE_DAY,uI="keychain",hI="0.3",lI="messages",fI="0.3",dI=ve.SIX_HOURS,pI="publisher",tg="irn",gI="error",rg="wss://relay.walletconnect.com",_d="wss://relay.walletconnect.org",yI="relayer",Zt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},vI="_subscription",wi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},mI=ve.ONE_SECOND,_I="2.11.2",wI=1e4,bI="0.3",EI="WALLETCONNECT_CLIENT_ID",Gr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},DI="subscription",SI="0.3",II=ve.FIVE_SECONDS*1e3,xI="pairing",PI="0.3",ys={wc_pairingDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:0},res:{ttl:ve.ONE_DAY,prompt:!1,tag:0}}},ws={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},ii={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},OI="history",CI="0.3",AI="expirer",qr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},TI="0.3",uu="verify-api",Mn="https://verify.walletconnect.com",zu="https://verify.walletconnect.org",RI=[Mn,zu],NI="echo",$I="https://echo.walletconnect.com";class UI{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=uI,this.version=hI,this.initialized=!1,this.storagePrefix=Mi,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:c}=ae("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(c)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=wr(t,this.name)}get context(){return _r(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,mp(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?_p(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}class jI{constructor(e,t,s){this.core=e,this.logger=t,this.name=aI,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=id(o);return $p(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=DE();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),l=id(c),f=Cu();return await M2(f,o,cI,l)},this.generateSharedKey=(o,c,l)=>{this.isInitialized();const f=this.getPrivateKey(o),g=SE(f,c);return this.setSymKey(g,l)},this.setSymKey=async(o,c)=>{this.isInitialized();const l=c||IE(o);return await this.keychain.set(l,o),l},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,l)=>{this.isInitialized();const f=vp(l),g=an(c);if(Rf(f)){const E=f.senderPublicKey,x=f.receiverPublicKey;o=await this.generateSharedKey(E,x)}const p=this.getSymKey(o),{type:v,senderPublicKey:w}=f;return PE({type:v,symKey:p,message:g,senderPublicKey:w})},this.decode=async(o,c,l)=>{this.isInitialized();const f=AE(c,l);if(Rf(f)){const g=f.receiverPublicKey,p=f.senderPublicKey;o=await this.generateSharedKey(g,p)}try{const g=this.getSymKey(o),p=OE({symKey:g,encoded:c});return Ls(p)}catch(g){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(g)}},this.getPayloadType=o=>{const c=ia(o);return $s(c.type)},this.getPayloadSenderPublicKey=o=>{const c=ia(o);return c.senderPublicKey?ur(c.senderPublicKey,cr):void 0},this.core=e,this.logger=wr(t,this.name),this.keychain=s||new UI(this.core,this.logger)}get context(){return _r(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(md)}catch{e=Cu(),await this.keychain.set(md,e)}return iI(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}class LI extends g2{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=lI,this.version=fI,this.initialized=!1,this.storagePrefix=Mi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const c=qn(o);let l=this.messages.get(s);return typeof l>"u"&&(l={}),typeof l[c]<"u"||(l[c]=o,this.messages.set(s,l),await this.persist()),c},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const c=this.get(s),l=qn(o);return typeof c[l]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=wr(e,this.name),this.core=t}get context(){return _r(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,mp(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?_p(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}class MI extends y2{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new Fr.EventEmitter,this.name=pI,this.queue=new Map,this.publishTimeout=ve.toMiliseconds(ve.TEN_SECONDS*2),this.needsTransportRestart=!1,this.publish=async(s,o,c)=>{var l;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}});try{const f=(c==null?void 0:c.ttl)||dI,g=Au(c),p=(c==null?void 0:c.prompt)||!1,v=(c==null?void 0:c.tag)||0,w=(c==null?void 0:c.id)||Fp().toString(),E={topic:s,message:o,opts:{ttl:f,relay:g,prompt:p,tag:v,id:w}},x=setTimeout(()=>this.queue.set(w,E),this.publishTimeout);try{await await Is(this.rpcPublish(s,o,f,g,p,v,w),this.publishTimeout,`Failed to publish payload, please try again. id:${w} tag:${v}`),this.removeRequestFromQueue(w),this.relayer.events.emit(Zt.publish,E)}catch(I){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(l=c==null?void 0:c.internal)!=null&&l.throwOnFailedPublish)throw this.removeRequestFromQueue(w),I;return}finally{clearTimeout(x)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}})}catch(f){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(f),f}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=e,this.logger=wr(t,this.name),this.registerEventListeners()}get context(){return _r(this.logger)}rpcPublish(e,t,s,o,c,l,f){var g,p,v,w;const E={method:Xo(o.protocol).publish,params:{topic:e,message:t,ttl:s,prompt:c,tag:l},id:f};return ar((g=E.params)==null?void 0:g.prompt)&&((p=E.params)==null||delete p.prompt),ar((v=E.params)==null?void 0:v.tag)&&((w=E.params)==null||delete w.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:E}),this.relayer.request(E)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:s,opts:o}=e;await this.publish(t,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(Vn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Zt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Zt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class qI{constructor(){this.map=new Map,this.set=(e,t)=>{const s=this.get(e);this.exists(e,t)||this.map.set(e,[...s,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,t))return;const o=s.filter(c=>c!==t);if(!o.length){this.map.delete(e);return}this.map.set(e,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var FI=Object.defineProperty,zI=Object.defineProperties,HI=Object.getOwnPropertyDescriptors,wd=Object.getOwnPropertySymbols,BI=Object.prototype.hasOwnProperty,KI=Object.prototype.propertyIsEnumerable,bd=(i,e,t)=>e in i?FI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,vs=(i,e)=>{for(var t in e||(e={}))BI.call(e,t)&&bd(i,t,e[t]);if(wd)for(var t of wd(e))KI.call(e,t)&&bd(i,t,e[t]);return i},hu=(i,e)=>zI(i,HI(e));class kI extends _2{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new qI,this.events=new Fr.EventEmitter,this.name=DI,this.version=SI,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Mi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const c=Au(o),l={topic:s,relay:c};this.pending.set(s,l);const f=await this.rpcSubscribe(s,c);return this.onSubscribe(f,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),f}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>{if(this.topics.includes(s))return!0;const o=`${this.pendingSubscriptionWatchLabel}_${s}`;return await new Promise((c,l)=>{const f=new ve.Watch;f.start(o);const g=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(g),f.stop(o),c(!0)),f.elapsed(o)>=II&&(clearInterval(g),f.stop(o),l(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=wr(t,this.name),this.clientId=""}get context(){return _r(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let s=!1;try{s=this.getSubscription(e).topic===t}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const s=this.topicMap.get(e);await Promise.all(s.map(async o=>await this.unsubscribeById(e,o,t)))}async unsubscribeById(e,t,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}});try{const o=Au(s);await this.rpcUnsubscribe(e,t,o);const c=mt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(e,t){const s={method:Xo(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Is(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Zt.connection_stalled)}return qn(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,s={method:Xo(t.protocol).batchSubscribe,params:{topics:e.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Is(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Zt.connection_stalled)}}rpcUnsubscribe(e,t,s){const o={method:Xo(s.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(e,t){this.setSubscription(e,hu(vs({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,vs({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,s){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,vs({},t)),this.topicMap.set(t.topic,e),this.events.emit(Gr.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:s}=ae("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(Gr.deleted,hu(vs({},s),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Gr.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(Gr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=ae("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);si(t)&&this.onBatchSubscribe(t.map((s,o)=>hu(vs({},e[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(Vn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Zt.connect,async()=>{await this.onConnect()}),this.relayer.on(Zt.disconnect,()=>{this.onDisconnect()}),this.events.on(Gr.created,async e=>{const t=Gr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(Gr.deleted,async e=>{const t=Gr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var VI=Object.defineProperty,Ed=Object.getOwnPropertySymbols,GI=Object.prototype.hasOwnProperty,WI=Object.prototype.propertyIsEnumerable,Dd=(i,e,t)=>e in i?VI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,YI=(i,e)=>{for(var t in e||(e={}))GI.call(e,t)&&Dd(i,t,e[t]);if(Ed)for(var t of Ed(e))WI.call(e,t)&&Dd(i,t,e[t]);return i};class JI extends v2{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Fr.EventEmitter,this.name=yI,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.request=async t=>{this.logger.debug("Publishing Request Payload");const s=t.id;try{await this.toEstablishConnection();const o=this.provider.request(t);return this.requestsInFlight.set(s,{promise:o,request:t}),await o}catch(o){throw this.logger.debug("Failed to Publish Request"),this.logger.error(o),o}finally{this.requestsInFlight.delete(s)}},this.onPayloadHandler=t=>{this.onProviderPayload(t)},this.onConnectHandler=()=>{this.events.emit(Zt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(Zt.error,t),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(wi.payload,this.onPayloadHandler),this.provider.on(wi.connect,this.onConnectHandler),this.provider.on(wi.disconnect,this.onDisconnectHandler),this.provider.on(wi.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?wr(e.logger,this.name):ma(_a({level:e.logger||gI})),this.messages=new LI(this.logger,e.core),this.subscriber=new kI(this,this.logger),this.publisher=new MI(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||rg,this.projectId=e.projectId,this.bundleId=jE(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${_d}...`),await this.restartTransport(_d)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},wI)}get context(){return _r(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,s){this.isInitialized(),await this.publisher.publish(e,t,s),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";if(o)return o;let c;const l=f=>{f.topic===e&&(this.subscriber.off(Gr.created,l),c())};return await Promise.all([new Promise(f=>{c=f,this.subscriber.on(Gr.created,l)}),new Promise(async f=>{o=await this.subscriber.subscribe(e,t),f()})]),o}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.requestsInFlight.size>0&&(this.logger.debug("Waiting for all in-flight requests to finish before closing transport..."),this.requestsInFlight.forEach(async e=>{await e.promise})),this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Is(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(e){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(t=>{if(!this.initialized)return t();this.subscriber.once(Gr.resubscribed,()=>{t()})}),new Promise(async(t,s)=>{try{await Is(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){s(o);return}t()})])}catch(t){this.logger.error(t);const s=t;if(!this.isConnectionStalled(s.message))throw t;this.provider.events.emit(wi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(e){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Bf())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Si(new x6(HE({sdkVersion:_I,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:s}=e;await this.messages.set(t,s)}async shouldIgnoreMessageEvent(e){const{topic:t,message:s}=e;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const o=this.messages.has(t,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),ch(e)){if(!e.method.endsWith(vI))return;const t=e.params,{topic:s,message:o,publishedAt:c}=t.data,l={topic:s,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(YI({type:"event",event:t.id},l)),this.events.emit(t.id,l),await this.acknowledgePayload(e),await this.onMessageEvent(l)}else Ea(e)&&this.events.emit(Zt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Zt.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=wa(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(wi.payload,this.onPayloadHandler),this.provider.off(wi.connect,this.onConnectHandler),this.provider.off(wi.disconnect,this.onDisconnectHandler),this.provider.off(wi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Zt.connection_stalled,()=>{this.restartTransport().catch(t=>this.logger.error(t))});let e=await Bf();jD(async t=>{this.initialized&&e!==t&&(e=t,t?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(Zt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(e=>this.logger.error(e))},ve.toMiliseconds(mI)))}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var QI=Object.defineProperty,Sd=Object.getOwnPropertySymbols,XI=Object.prototype.hasOwnProperty,ZI=Object.prototype.propertyIsEnumerable,Id=(i,e,t)=>e in i?QI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,xd=(i,e)=>{for(var t in e||(e={}))XI.call(e,t)&&Id(i,t,e[t]);if(Sd)for(var t of Sd(e))ZI.call(e,t)&&Id(i,t,e[t]);return i};class Sa extends m2{constructor(e,t,s,o=Mi,c=void 0){super(e,t,s,o),this.core=e,this.logger=t,this.name=s,this.map=new Map,this.version=bI,this.cached=[],this.initialized=!1,this.storagePrefix=Mi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{this.getKey&&l!==null&&!ar(l)?this.map.set(this.getKey(l),l):dD(l)?this.map.set(l.id,l):pD(l)&&this.map.set(l.topic,l)}),this.cached=[],this.initialized=!0)},this.set=async(l,f)=>{this.isInitialized(),this.map.has(l)?await this.update(l,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:f}),this.map.set(l,f),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(f=>Object.keys(l).every(g=>O6(f[g],l[g]))):this.values),this.update=async(l,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:f});const g=xd(xd({},this.getData(l)),f);this.map.set(l,g),await this.persist()},this.delete=async(l,f)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:f}),this.map.delete(l),await this.persist())},this.logger=wr(t,this.name),this.storagePrefix=o,this.getKey=c}get context(){return _r(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:s}=ae("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=ae("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}class e5{constructor(e,t){this.core=e,this.logger=t,this.name=xI,this.version=PI,this.events=new Vu,this.initialized=!1,this.storagePrefix=Mi,this.ignoredPayloadTypes=[un],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Cu(),o=await this.core.crypto.setSymKey(s),c=Pr(ve.FIVE_MINUTES),l={protocol:tg},f={topic:o,expiry:c,relay:l,active:!1},g=nD({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:l,expiryTimestamp:c});return await this.pairings.set(o,f),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:g}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:c,relay:l,expiryTimestamp:f}=Mf(s.uri);let g;if(this.pairings.keys.includes(o)&&(g=this.pairings.get(o),g.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const p=f||Pr(ve.FIVE_MINUTES),v={topic:o,relay:l,expiry:p,active:!1};return await this.pairings.set(o,v),this.core.expirer.set(o,p),s.activatePairing&&await this.activate({topic:o}),this.events.emit(ws.create,v),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:l})),v},this.activate=async({topic:s})=>{this.isInitialized();const o=Pr(ve.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:l,resolve:f,reject:g}=Ln();this.events.once(Nt("pairing_ping",c),({error:p})=>{p?g(p):f()}),await l()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",mt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,c)=>{const l=Fn(o,c),f=await this.core.crypto.encode(s,l),g=ys[o].req;return this.core.history.set(s,l),this.core.relayer.publish(s,f,g),l.id},this.sendResult=async(s,o,c)=>{const l=wa(s,c),f=await this.core.crypto.encode(o,l),g=await this.core.history.get(o,s),p=ys[g.request.method].res;await this.core.relayer.publish(o,f,p),await this.core.history.resolve(l)},this.sendError=async(s,o,c)=>{const l=ba(s,c),f=await this.core.crypto.encode(o,l),g=await this.core.history.get(o,s),p=ys[g.request.method]?ys[g.request.method].res:ys.unregistered_method.res;await this.core.relayer.publish(o,f,p),await this.core.history.resolve(l)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,mt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>Li(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:c}=s;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:c}=s,l=(await this.core.history.get(o,c.id)).request.method;switch(l){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(s,o)=>{const{id:c}=o;try{this.isValidPing({topic:s}),await this.sendResult(c,s,!0),this.events.emit(ws.ping,{id:c,topic:s})}catch(l){await this.sendError(c,s,l),this.logger.error(l)}},this.onPairingPingResponse=(s,o)=>{const{id:c}=o;setTimeout(()=>{Di(o)?this.events.emit(Nt("pairing_ping",c),{}):Wr(o)&&this.events.emit(Nt("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(ws.delete,{id:c,topic:s})}catch(l){await this.sendError(c,s,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:c,method:l}=o;try{if(this.registeredMethods.includes(l))return;const f=mt("WC_METHOD_UNSUPPORTED",l);await this.sendError(c,s,f),this.logger.error(f)}catch(f){await this.sendError(c,s,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(mt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var o;if(!vr(s)){const{message:l}=ae("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(l)}if(!fD(s.uri)){const{message:l}=ae("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(l)}const c=Mf(s.uri);if(!((o=c==null?void 0:c.relay)!=null&&o.protocol)){const{message:l}=ae("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(l)}if(!(c!=null&&c.symKey)){const{message:l}=ae("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(l)}if(c!=null&&c.expiryTimestamp&&ve.toMiliseconds(c==null?void 0:c.expiryTimestamp)<Date.now()){const{message:l}=ae("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(l)}},this.isValidPing=async s=>{if(!vr(s)){const{message:c}=ae("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!vr(s)){const{message:c}=ae("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Vt(s,!1)){const{message:o}=ae("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=ae("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if(Li(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=ae("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=e,this.logger=wr(t,this.name),this.pairings=new Sa(this.core,this.logger,this.name,this.storagePrefix)}get context(){return _r(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Zt.message,async e=>{const{topic:t,message:s}=e;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(t,s);try{ch(o)?(this.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):Ea(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.core.history.delete(t,o.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(qr.expired,async e=>{const{topic:t}=bp(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(ws.expire,{topic:t}))})}}class t5 extends p2{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new Fr.EventEmitter,this.name=OI,this.version=CI,this.cached=[],this.initialized=!1,this.storagePrefix=Mi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:c}),this.records.has(o.id))return;const l={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:c,expiry:Pr(ve.THIRTY_DAYS)};this.records.set(l.id,l),this.events.emit(ii.created,l)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=Wr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(ii.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===s){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(ii.deleted,c)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=wr(t,this.name)}get context(){return _r(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const s={topic:t.topic,request:Fn(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:s}=ae("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ii.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=ae("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(ii.created,e=>{const t=ii.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(ii.updated,e=>{const t=ii.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(ii.deleted,e=>{const t=ii.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.core.heartbeat.on(Vn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{ve.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}class r5 extends w2{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new Fr.EventEmitter,this.name=AI,this.version=TI,this.cached=[],this.initialized=!1,this.storagePrefix=Mi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const c=this.formatTarget(s),l={target:c,expiry:o};this.expirations.set(c,l),this.checkExpiry(c,l),this.events.emit(qr.created,{target:c,expiration:l})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(qr.deleted,{target:o,expiration:c})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=wr(t,this.name)}get context(){return _r(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return BE(e);if(typeof e=="number")return KE(e);const{message:t}=ae("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(qr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=ae("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:s}=ae("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}checkExpiry(e,t){const{expiry:s}=t;ve.toMiliseconds(s)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(qr.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(Vn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(qr.created,e=>{const t=qr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(qr.expired,e=>{const t=qr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(qr.deleted,e=>{const t=qr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}}}class i5 extends b2{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=uu,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||Bn()||!Kn())return;const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=zu;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let c;try{c=await this.fetchAttestation(s.attestationId,o)}catch(l){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${o}`),this.logger.info(l),c=await this.fetchAttestation(s.attestationId,zu)}return c},this.fetchAttestation=async(s,o)=>{this.logger.info(`resolving attestation: ${s} from url: ${o}`);const c=this.startAbortTimer(ve.ONE_SECOND*2),l=await fetch(`${o}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(c),l.status===200?await l.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),s())};await Promise.race([new Promise(c=>{if(document.getElementById(uu))return c();window.addEventListener("message",o);const l=document.createElement("iframe");l.id=uu,l.src=`${this.verifyUrl}/${this.projectId}`,l.style.display="none",document.body.append(l),this.iframe=l,s=c}),new Promise((c,l)=>setTimeout(()=>{window.removeEventListener("message",o),l("verify iframe load timeout")},ve.toMiliseconds(ve.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let o=s||Mn;return RI.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${Mn}`),o=Mn),o},this.logger=wr(t,this.name),this.verifyUrl=Mn,this.abortController=new AbortController,this.isDevEnv=rh()&&N6.IS_VITEST}get context(){return _r(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ve.toMiliseconds(e))}}class n5 extends E2{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.context=NI,this.registerDeviceToken=async s=>{const{clientId:o,token:c,notificationType:l,enableEncrypted:f=!1}=s,g=`${$I}/${this.projectId}/clients`;await R6(g,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:l,token:c,always_raw:f})})},this.logger=wr(t,this.context)}}var s5=Object.defineProperty,Pd=Object.getOwnPropertySymbols,o5=Object.prototype.hasOwnProperty,a5=Object.prototype.propertyIsEnumerable,Od=(i,e,t)=>e in i?s5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Cd=(i,e)=>{for(var t in e||(e={}))o5.call(e,t)&&Od(i,t,e[t]);if(Pd)for(var t of Pd(e))a5.call(e,t)&&Od(i,t,e[t]);return i};class hh extends d2{constructor(e){super(e),this.protocol=eg,this.version=nI,this.name=uh,this.events=new Fr.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||rg,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:ma(_a({level:(e==null?void 0:e.logger)||sI.logger}));this.logger=wr(t,this.name),this.heartbeat=new Vn.HeartBeat,this.crypto=new jI(this,this.logger,e==null?void 0:e.keychain),this.history=new t5(this,this.logger),this.expirer=new r5(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new y3(Cd(Cd({},oI),e==null?void 0:e.storageOptions)),this.relayer=new JI({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new e5(this,this.logger),this.verify=new i5(this.projectId||"",this.logger),this.echoClient=new n5(this.projectId||"",this.logger)}static async init(e){const t=new hh(e);await t.initialize();const s=await t.crypto.getClientId();return await t.storage.setItem(EI,s),t}get context(){return _r(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const c5=hh,ig="wc",ng=2,sg="client",lh=`${ig}@${ng}:${sg}:`,lu={name:sg,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Ad="WALLETCONNECT_DEEPLINK_CHOICE",u5="proposal",og="Proposal expired",h5="session",Yo=ve.SEVEN_DAYS,l5="engine",bi={wc_sessionPropose:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ve.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ve.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ve.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ve.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ve.THIRTY_SECONDS,prompt:!1,tag:1115}}},fu={min:ve.FIVE_MINUTES,max:ve.SEVEN_DAYS},Ei={idle:"IDLE",active:"ACTIVE"},f5="request",d5=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var p5=Object.defineProperty,g5=Object.defineProperties,y5=Object.getOwnPropertyDescriptors,Td=Object.getOwnPropertySymbols,v5=Object.prototype.hasOwnProperty,m5=Object.prototype.propertyIsEnumerable,Rd=(i,e,t)=>e in i?p5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,or=(i,e)=>{for(var t in e||(e={}))v5.call(e,t)&&Rd(i,t,e[t]);if(Td)for(var t of Td(e))m5.call(e,t)&&Rd(i,t,e[t]);return i},jn=(i,e)=>g5(i,y5(e));class _5 extends S2{constructor(e){super(e),this.name=l5,this.events=new Vu,this.initialized=!1,this.ignoredPayloadTypes=[un],this.requestQueue={state:Ei.idle,queue:[]},this.sessionRequestQueue={state:Ei.idle,queue:[]},this.requestQueueDelay=ve.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(bi)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ve.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{await this.isInitialized();const s=jn(or({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:l,sessionProperties:f,relays:g}=s;let p=o,v,w=!1;if(p&&(w=this.client.core.pairing.pairings.get(p).active),!p||!w){const{topic:P,uri:C}=await this.client.core.pairing.create();p=P,v=C}const E=await this.client.core.crypto.generateKeyPair(),x=bi.wc_sessionPropose.req.ttl||ve.FIVE_MINUTES,I=Pr(x),B=or({requiredNamespaces:c,optionalNamespaces:l,relays:g??[{protocol:tg}],proposer:{publicKey:E,metadata:this.client.metadata},expiryTimestamp:I},f&&{sessionProperties:f}),{reject:K,resolve:Z,done:$}=Ln(x,og);if(this.events.once(Nt("session_connect"),async({error:P,session:C})=>{if(P)K(P);else if(C){C.self.publicKey=E;const A=jn(or({},C),{requiredNamespaces:B.requiredNamespaces,optionalNamespaces:B.optionalNamespaces});await this.client.session.set(C.topic,A),await this.setExpiry(C.topic,C.expiry),p&&await this.client.core.pairing.updateMetadata({topic:p,metadata:C.peer.metadata}),Z(A)}}),!p){const{message:P}=ae("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(P)}const L=await this.sendRequest({topic:p,method:"wc_sessionPropose",params:B,throwOnFailedPublish:!0});return await this.setProposal(L,or({id:L},B)),{uri:v,approval:$}},this.pair=async t=>(await this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{await this.isInitialized(),await this.isValidApprove(t);const{id:s,relayProtocol:o,namespaces:c,sessionProperties:l}=t,f=this.client.proposal.get(s);let{pairingTopic:g,proposer:p,requiredNamespaces:v,optionalNamespaces:w}=f;g=g||"";const E=await this.client.core.crypto.generateKeyPair(),x=p.publicKey,I=await this.client.core.crypto.generateSharedKey(E,x);g&&s&&(await this.client.core.pairing.updateMetadata({topic:g,metadata:p.metadata}),await this.sendResult({id:s,topic:g,result:{relay:{protocol:o??"irn"},responderPublicKey:E}}),await this.client.proposal.delete(s,mt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:g}));const B=or({relay:{protocol:o??"irn"},namespaces:c,pairingTopic:g,controller:{publicKey:E,metadata:this.client.metadata},expiry:Pr(Yo)},l&&{sessionProperties:l});await this.client.core.relayer.subscribe(I);const K=jn(or({},B),{topic:I,requiredNamespaces:v,optionalNamespaces:w,pairingTopic:g,acknowledged:!1,self:B.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:E});await this.client.session.set(I,K);try{await this.sendRequest({topic:I,method:"wc_sessionSettle",params:B,throwOnFailedPublish:!0})}catch(Z){throw this.client.logger.error(Z),this.client.session.delete(I,mt("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(I),Z}return await this.setExpiry(I,Pr(Yo)),{topic:I,acknowledged:()=>new Promise(Z=>setTimeout(()=>Z(this.client.session.get(I)),500))}},this.reject=async t=>{await this.isInitialized(),await this.isValidReject(t);const{id:s,reason:o}=t,{pairingTopic:c}=this.client.proposal.get(s);c&&(await this.sendError(s,c,o),await this.client.proposal.delete(s,mt("USER_DISCONNECTED")))},this.update=async t=>{await this.isInitialized(),await this.isValidUpdate(t);const{topic:s,namespaces:o}=t,c=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:l,resolve:f,reject:g}=Ln();return this.events.once(Nt("session_update",c),({error:p})=>{p?g(p):f()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:l}},this.extend=async t=>{await this.isInitialized(),await this.isValidExtend(t);const{topic:s}=t,o=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:c,resolve:l,reject:f}=Ln();return this.events.once(Nt("session_extend",o),({error:g})=>{g?f(g):l()}),await this.setExpiry(s,Pr(Yo)),{acknowledged:c}},this.request=async t=>{await this.isInitialized(),await this.isValidRequest(t);const{chainId:s,request:o,topic:c,expiry:l=bi.wc_sessionRequest.req.ttl}=t,f=ah(),{done:g,resolve:p,reject:v}=Ln(l,"Request expired. Please try again.");return this.events.once(Nt("session_request",f),({error:w,result:E})=>{w?v(w):p(E)}),await Promise.all([new Promise(async w=>{await this.sendRequest({clientRpcId:f,topic:c,method:"wc_sessionRequest",params:{request:jn(or({},o),{expiryTimestamp:Pr(l)}),chainId:s},expiry:l,throwOnFailedPublish:!0}).catch(E=>v(E)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:s,id:f}),w()}),new Promise(async w=>{const E=await VE(this.client.core.storage,Ad);kE({id:f,topic:c,wcDeepLink:E}),w()}),g()]).then(w=>w[2])},this.respond=async t=>{await this.isInitialized(),await this.isValidRespond(t);const{topic:s,response:o}=t,{id:c}=o;Di(o)?await this.sendResult({id:c,topic:s,result:o.result,throwOnFailedPublish:!0}):Wr(o)&&await this.sendError(c,s,o.error),this.cleanupAfterResponse(t)},this.ping=async t=>{await this.isInitialized(),await this.isValidPing(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const o=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:c,resolve:l,reject:f}=Ln();this.events.once(Nt("session_ping",o),({error:g})=>{g?f(g):l()}),await c()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async t=>{await this.isInitialized(),await this.isValidEmit(t);const{topic:s,event:o,chainId:c}=t;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:o,chainId:c}})},this.disconnect=async t=>{await this.isInitialized(),await this.isValidDisconnect(t);const{topic:s}=t;if(this.client.session.keys.includes(s))await this.sendRequest({topic:s,method:"wc_sessionDelete",params:mt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:s,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(s))await this.client.core.pairing.disconnect({topic:s});else{const{message:o}=ae("MISMATCHED_TOPIC",`Session or pairing topic not found: ${s}`);throw new Error(o)}},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(s=>hD(s,t))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const s=this.client.core.pairing.pairings.get(t.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var l,f;return((l=c.peerMetadata)==null?void 0:l.url)&&((f=c.peerMetadata)==null?void 0:f.url)===t.peer.metadata.url&&c.topic&&c.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async t=>{const{topic:s,expirerHasDeleted:o=!1,emitEvent:c=!0,id:l=0}=t,{self:f}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,mt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(f.publicKey)&&await this.client.core.crypto.deleteKeyPair(f.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),o||this.client.core.expirer.del(s),this.client.core.storage.removeItem(Ad).catch(g=>this.client.logger.warn(g)),this.getPendingSessionRequests().forEach(g=>{g.topic===s&&this.deletePendingSessionRequest(g.id,mt("USER_DISCONNECTED"))}),c&&this.client.events.emit("session_delete",{id:l,topic:s})},this.deleteProposal=async(t,s)=>{await Promise.all([this.client.proposal.delete(t,mt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,s),o?Promise.resolve():this.client.core.expirer.del(t)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==t),o&&(this.sessionRequestQueue.state=Ei.idle,this.client.events.emit("session_request_expire",{id:t}))},this.setExpiry=async(t,s)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:s}),this.client.core.expirer.set(t,s)},this.setProposal=async(t,s)=>{await this.client.proposal.set(t,s),this.client.core.expirer.set(t,Pr(bi.wc_sessionPropose.req.ttl))},this.setPendingSessionRequest=async t=>{const{id:s,topic:o,params:c,verifyContext:l}=t,f=c.request.expiryTimestamp||Pr(bi.wc_sessionRequest.req.ttl);await this.client.pendingRequest.set(s,{id:s,topic:o,params:c,verifyContext:l}),f&&this.client.core.expirer.set(s,f)},this.sendRequest=async t=>{const{topic:s,method:o,params:c,expiry:l,relayRpcId:f,clientRpcId:g,throwOnFailedPublish:p}=t,v=Fn(o,c,g);if(Kn()&&d5.includes(o)){const x=qn(JSON.stringify(v));this.client.core.verify.register({attestationId:x})}const w=await this.client.core.crypto.encode(s,v),E=bi[o].req;return l&&(E.ttl=l),f&&(E.id=f),this.client.core.history.set(s,v),p?(E.internal=jn(or({},E.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,w,E)):this.client.core.relayer.publish(s,w,E).catch(x=>this.client.logger.error(x)),v.id},this.sendResult=async t=>{const{id:s,topic:o,result:c,throwOnFailedPublish:l}=t,f=wa(s,c),g=await this.client.core.crypto.encode(o,f),p=await this.client.core.history.get(o,s),v=bi[p.request.method].res;l?(v.internal=jn(or({},v.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,g,v)):this.client.core.relayer.publish(o,g,v).catch(w=>this.client.logger.error(w)),await this.client.core.history.resolve(f)},this.sendError=async(t,s,o)=>{const c=ba(t,o),l=await this.client.core.crypto.encode(s,c),f=await this.client.core.history.get(s,t),g=bi[f.request.method].res;this.client.core.relayer.publish(s,l,g),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],s=[];this.client.session.getAll().forEach(o=>{let c=!1;Li(o.expiry)&&(c=!0),this.client.core.crypto.keychain.has(o.topic)||(c=!0),c&&t.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Li(o.expiryTimestamp)&&s.push(o.id)}),await Promise.all([...t.map(o=>this.deleteSession({topic:o})),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===Ei.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Ei.active;const t=this.requestQueue.queue.shift();if(t)try{this.processRequest(t),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=Ei.idle},this.processRequest=t=>{const{topic:s,payload:o}=t,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:s,payload:o}=t,c=(await this.client.core.history.get(s,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:s}=t,{message:o}=ae("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(t,s)=>{const{params:o,id:c}=s;try{this.isValidConnect(or({},s.params));const l=o.expiryTimestamp||Pr(bi.wc_sessionPropose.req.ttl),f=or({id:c,pairingTopic:t,expiryTimestamp:l},o);await this.setProposal(c,f);const g=qn(JSON.stringify(s)),p=await this.getVerifyContext(g,f.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:f,verifyContext:p})}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(t,s)=>{const{id:o}=s;if(Di(s)){const{result:c}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const l=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const f=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const g=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:g});const p=await this.client.core.crypto.generateSharedKey(f,g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:p});const v=await this.client.core.relayer.subscribe(p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:v}),await this.client.core.pairing.activate({topic:t})}else Wr(s)&&(await this.client.proposal.delete(o,mt("USER_DISCONNECTED")),this.events.emit(Nt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidSessionSettleRequest(c);const{relay:l,controller:f,expiry:g,namespaces:p,sessionProperties:v,pairingTopic:w}=s.params,E=or({topic:t,relay:l,expiry:g,namespaces:p,acknowledged:!0,pairingTopic:w,requiredNamespaces:{},optionalNamespaces:{},controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},v&&{sessionProperties:v});await this.sendResult({id:s.id,topic:t,result:!0}),this.events.emit(Nt("session_connect"),{session:E}),this.cleanupDuplicatePairings(E)}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(t,s)=>{const{id:o}=s;Di(s)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Nt("session_approve",o),{})):Wr(s)&&(await this.client.session.delete(t,mt("USER_DISCONNECTED")),this.events.emit(Nt("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(t,s)=>{const{params:o,id:c}=s;try{const l=`${t}_session_update`,f=ko.get(l);if(f&&this.isRequestOutOfSync(f,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(or({topic:t},o)),await this.client.session.update(t,{namespaces:o.namespaces}),await this.sendResult({id:c,topic:t,result:!0}),this.client.events.emit("session_update",{id:c,topic:t,params:o}),ko.set(l,c)}catch(l){await this.sendError(c,t,l),this.client.logger.error(l)}},this.isRequestOutOfSync=(t,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,s)=>{const{id:o}=s;Di(s)?this.events.emit(Nt("session_update",o),{}):Wr(s)&&this.events.emit(Nt("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(t,s)=>{const{id:o}=s;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Pr(Yo)),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_extend",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,s)=>{const{id:o}=s;Di(s)?this.events.emit(Nt("session_extend",o),{}):Wr(s)&&this.events.emit(Nt("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(t,s)=>{const{id:o}=s;try{this.isValidPing({topic:t}),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_ping",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,s)=>{const{id:o}=s;setTimeout(()=>{Di(s)?this.events.emit(Nt("session_ping",o),{}):Wr(s)&&this.events.emit(Nt("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(t,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:t,reason:s.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(Zt.publish,async()=>{c(await this.deleteSession({topic:t,id:o}))})}),this.sendResult({id:o,topic:t,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:t,error:mt("USER_DISCONNECTED")})])}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidRequest(or({topic:t},c));const l=qn(JSON.stringify(Fn("wc_sessionRequest",c,o))),f=this.client.session.get(t),g=await this.getVerifyContext(l,f.peer.metadata),p={id:o,topic:t,params:c,verifyContext:g};await this.setPendingSessionRequest(p),this.addSessionRequestToSessionRequestQueue(p),this.processSessionRequestQueue()}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(t,s)=>{const{id:o}=s;Di(s)?this.events.emit(Nt("session_request",o),{result:s.result}):Wr(s)&&this.events.emit(Nt("session_request",o),{error:s.error})},this.onSessionEventRequest=async(t,s)=>{const{id:o,params:c}=s;try{const l=`${t}_session_event_${c.event.name}`,f=ko.get(l);if(f&&this.isRequestOutOfSync(f,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(or({topic:t},c)),this.client.events.emit("session_event",{id:o,topic:t,params:c}),ko.set(l,o)}catch(l){await this.sendError(o,t,l),this.client.logger.error(l)}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Ei.idle,this.processSessionRequestQueue()},ve.toMiliseconds(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:t,error:s})=>{const o=this.client.core.history.pending;o.length>0&&o.filter(c=>c.topic===t&&c.request.method==="wc_sessionRequest").forEach(c=>{this.events.emit(Nt("session_request",c.request.id),{error:s})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===Ei.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=Ei.active,this.client.events.emit("session_request",t)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=t=>{if(t.active)return;const s=this.client.proposal.getAll().find(o=>o.pairingTopic===t.topic);s&&this.onSessionProposeRequest(t.topic,Fn("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async t=>{if(!vr(t)){const{message:g}=ae("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(g)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:l,relays:f}=t;if(ar(s)||await this.isValidPairingTopic(s),!ED(f,!0)){const{message:g}=ae("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(g)}!ar(o)&&xs(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!ar(c)&&xs(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),ar(l)||this.validateSessionProps(l,"sessionProperties")},this.validateNamespaces=(t,s)=>{const o=bD(t,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async t=>{if(!vr(t))throw new Error(ae("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:s,namespaces:o,relayProtocol:c,sessionProperties:l}=t;await this.isValidProposalId(s);const f=this.client.proposal.get(s),g=tu(o,"approve()");if(g)throw new Error(g.message);const p=zf(f.requiredNamespaces,o,"approve()");if(p)throw new Error(p.message);if(!Vt(c,!0)){const{message:v}=ae("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(v)}ar(l)||this.validateSessionProps(l,"sessionProperties")},this.isValidReject=async t=>{if(!vr(t)){const{message:c}=ae("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:s,reason:o}=t;if(await this.isValidProposalId(s),!SD(o)){const{message:c}=ae("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!vr(t)){const{message:p}=ae("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(p)}const{relay:s,controller:o,namespaces:c,expiry:l}=t;if(!Dp(s)){const{message:p}=ae("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(p)}const f=gD(o,"onSessionSettleRequest()");if(f)throw new Error(f.message);const g=tu(c,"onSessionSettleRequest()");if(g)throw new Error(g.message);if(Li(l)){const{message:p}=ae("EXPIRED","onSessionSettleRequest()");throw new Error(p)}},this.isValidUpdate=async t=>{if(!vr(t)){const{message:g}=ae("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(g)}const{topic:s,namespaces:o}=t;await this.isValidSessionTopic(s);const c=this.client.session.get(s),l=tu(o,"update()");if(l)throw new Error(l.message);const f=zf(c.requiredNamespaces,o,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async t=>{if(!vr(t)){const{message:o}=ae("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionTopic(s)},this.isValidRequest=async t=>{if(!vr(t)){const{message:g}=ae("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(g)}const{topic:s,request:o,chainId:c,expiry:l}=t;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!Ff(f,c)){const{message:g}=ae("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(g)}if(!ID(o)){const{message:g}=ae("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(g)}if(!OD(f,c,o.method)){const{message:g}=ae("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(g)}if(l&&!RD(l,fu)){const{message:g}=ae("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${fu.min} and ${fu.max}`);throw new Error(g)}},this.isValidRespond=async t=>{var s;if(!vr(t)){const{message:l}=ae("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(l)}const{topic:o,response:c}=t;try{await this.isValidSessionTopic(o)}catch(l){throw(s=t==null?void 0:t.response)!=null&&s.id&&this.cleanupAfterResponse(t),l}if(!xD(c)){const{message:l}=ae("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(c)}`);throw new Error(l)}},this.isValidPing=async t=>{if(!vr(t)){const{message:o}=ae("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async t=>{if(!vr(t)){const{message:f}=ae("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(f)}const{topic:s,event:o,chainId:c}=t;await this.isValidSessionTopic(s);const{namespaces:l}=this.client.session.get(s);if(!Ff(l,c)){const{message:f}=ae("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(f)}if(!PD(o)){const{message:f}=ae("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}if(!CD(l,c,o.name)){const{message:f}=ae("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}},this.isValidDisconnect=async t=>{if(!vr(t)){const{message:o}=ae("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(t,s)=>{const o={verified:{verifyUrl:s.verifyUrl||Mn,validation:"UNKNOWN",origin:s.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:s.verifyUrl});c&&(o.verified.origin=c.origin,o.verified.isScam=c.isScam,o.verified.validation=c.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(t,s)=>{Object.values(t).forEach(o=>{if(!Vt(o,!1)){const{message:c}=ae("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:e}=ae("NOT_INITIALIZED",this.name);throw new Error(e)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Zt.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(t,s);try{ch(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):Ea(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(qr.expired,async e=>{const{topic:t,id:s}=bp(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ae("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(ws.create,e=>this.onPairingCreated(e))}isValidPairingTopic(e){if(!Vt(e,!1)){const{message:t}=ae("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=ae("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Li(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=ae("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Vt(e,!1)){const{message:t}=ae("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=ae("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(Li(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=ae("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=ae("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Vt(e,!1)){const{message:t}=ae("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=ae("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!DD(e)){const{message:t}=ae("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=ae("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(Li(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=ae("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class w5 extends Sa{constructor(e,t){super(e,t,u5,lh),this.core=e,this.logger=t}}let b5=class extends Sa{constructor(e,t){super(e,t,h5,lh),this.core=e,this.logger=t}};class E5 extends Sa{constructor(e,t){super(e,t,f5,lh,s=>s.id),this.core=e,this.logger=t}}let D5=class ag extends D2{constructor(e){super(e),this.protocol=ig,this.version=ng,this.name=lu.name,this.events=new Fr.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||lu.name,this.metadata=(e==null?void 0:e.metadata)||ME();const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:ma(_a({level:(e==null?void 0:e.logger)||lu.logger}));this.core=(e==null?void 0:e.core)||new c5(e),this.logger=wr(t,this.name),this.session=new b5(this.core,this.logger),this.proposal=new w5(this.core,this.logger),this.pendingRequest=new E5(this.core,this.logger),this.engine=new _5(this)}static async init(e){const t=new ag(e);return await t.initialize(),t}get context(){return _r(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var Hu={exports:{}};(function(i,e){var t=typeof self<"u"?self:Yr,s=function(){function c(){this.fetch=!1,this.DOMException=t.DOMException}return c.prototype=t,new c}();(function(c){(function(l){var f={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function g(S){return S&&DataView.prototype.isPrototypeOf(S)}if(f.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],v=ArrayBuffer.isView||function(S){return S&&p.indexOf(Object.prototype.toString.call(S))>-1};function w(S){if(typeof S!="string"&&(S=String(S)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(S))throw new TypeError("Invalid character in header field name");return S.toLowerCase()}function E(S){return typeof S!="string"&&(S=String(S)),S}function x(S){var R={next:function(){var X=S.shift();return{done:X===void 0,value:X}}};return f.iterable&&(R[Symbol.iterator]=function(){return R}),R}function I(S){this.map={},S instanceof I?S.forEach(function(R,X){this.append(X,R)},this):Array.isArray(S)?S.forEach(function(R){this.append(R[0],R[1])},this):S&&Object.getOwnPropertyNames(S).forEach(function(R){this.append(R,S[R])},this)}I.prototype.append=function(S,R){S=w(S),R=E(R);var X=this.map[S];this.map[S]=X?X+", "+R:R},I.prototype.delete=function(S){delete this.map[w(S)]},I.prototype.get=function(S){return S=w(S),this.has(S)?this.map[S]:null},I.prototype.has=function(S){return this.map.hasOwnProperty(w(S))},I.prototype.set=function(S,R){this.map[w(S)]=E(R)},I.prototype.forEach=function(S,R){for(var X in this.map)this.map.hasOwnProperty(X)&&S.call(R,this.map[X],X,this)},I.prototype.keys=function(){var S=[];return this.forEach(function(R,X){S.push(X)}),x(S)},I.prototype.values=function(){var S=[];return this.forEach(function(R){S.push(R)}),x(S)},I.prototype.entries=function(){var S=[];return this.forEach(function(R,X){S.push([X,R])}),x(S)},f.iterable&&(I.prototype[Symbol.iterator]=I.prototype.entries);function B(S){if(S.bodyUsed)return Promise.reject(new TypeError("Already read"));S.bodyUsed=!0}function K(S){return new Promise(function(R,X){S.onload=function(){R(S.result)},S.onerror=function(){X(S.error)}})}function Z(S){var R=new FileReader,X=K(R);return R.readAsArrayBuffer(S),X}function $(S){var R=new FileReader,X=K(R);return R.readAsText(S),X}function L(S){for(var R=new Uint8Array(S),X=new Array(R.length),J=0;J<R.length;J++)X[J]=String.fromCharCode(R[J]);return X.join("")}function P(S){if(S.slice)return S.slice(0);var R=new Uint8Array(S.byteLength);return R.set(new Uint8Array(S)),R.buffer}function C(){return this.bodyUsed=!1,this._initBody=function(S){this._bodyInit=S,S?typeof S=="string"?this._bodyText=S:f.blob&&Blob.prototype.isPrototypeOf(S)?this._bodyBlob=S:f.formData&&FormData.prototype.isPrototypeOf(S)?this._bodyFormData=S:f.searchParams&&URLSearchParams.prototype.isPrototypeOf(S)?this._bodyText=S.toString():f.arrayBuffer&&f.blob&&g(S)?(this._bodyArrayBuffer=P(S.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):f.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(S)||v(S))?this._bodyArrayBuffer=P(S):this._bodyText=S=Object.prototype.toString.call(S):this._bodyText="",this.headers.get("content-type")||(typeof S=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):f.searchParams&&URLSearchParams.prototype.isPrototypeOf(S)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},f.blob&&(this.blob=function(){var S=B(this);if(S)return S;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?B(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(Z)}),this.text=function(){var S=B(this);if(S)return S;if(this._bodyBlob)return $(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(L(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},f.formData&&(this.formData=function(){return this.text().then(ee)}),this.json=function(){return this.text().then(JSON.parse)},this}var A=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function h(S){var R=S.toUpperCase();return A.indexOf(R)>-1?R:S}function b(S,R){R=R||{};var X=R.body;if(S instanceof b){if(S.bodyUsed)throw new TypeError("Already read");this.url=S.url,this.credentials=S.credentials,R.headers||(this.headers=new I(S.headers)),this.method=S.method,this.mode=S.mode,this.signal=S.signal,!X&&S._bodyInit!=null&&(X=S._bodyInit,S.bodyUsed=!0)}else this.url=String(S);if(this.credentials=R.credentials||this.credentials||"same-origin",(R.headers||!this.headers)&&(this.headers=new I(R.headers)),this.method=h(R.method||this.method||"GET"),this.mode=R.mode||this.mode||null,this.signal=R.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&X)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(X)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})};function ee(S){var R=new FormData;return S.trim().split("&").forEach(function(X){if(X){var J=X.split("="),k=J.shift().replace(/\+/g," "),V=J.join("=").replace(/\+/g," ");R.append(decodeURIComponent(k),decodeURIComponent(V))}}),R}function ne(S){var R=new I,X=S.replace(/\r?\n[\t ]+/g," ");return X.split(/\r?\n/).forEach(function(J){var k=J.split(":"),V=k.shift().trim();if(V){var te=k.join(":").trim();R.append(V,te)}}),R}C.call(b.prototype);function ue(S,R){R||(R={}),this.type="default",this.status=R.status===void 0?200:R.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in R?R.statusText:"OK",this.headers=new I(R.headers),this.url=R.url||"",this._initBody(S)}C.call(ue.prototype),ue.prototype.clone=function(){return new ue(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new I(this.headers),url:this.url})},ue.error=function(){var S=new ue(null,{status:0,statusText:""});return S.type="error",S};var ge=[301,302,303,307,308];ue.redirect=function(S,R){if(ge.indexOf(R)===-1)throw new RangeError("Invalid status code");return new ue(null,{status:R,headers:{location:S}})},l.DOMException=c.DOMException;try{new l.DOMException}catch{l.DOMException=function(R,X){this.message=R,this.name=X;var J=Error(R);this.stack=J.stack},l.DOMException.prototype=Object.create(Error.prototype),l.DOMException.prototype.constructor=l.DOMException}function ye(S,R){return new Promise(function(X,J){var k=new b(S,R);if(k.signal&&k.signal.aborted)return J(new l.DOMException("Aborted","AbortError"));var V=new XMLHttpRequest;function te(){V.abort()}V.onload=function(){var ie={status:V.status,statusText:V.statusText,headers:ne(V.getAllResponseHeaders()||"")};ie.url="responseURL"in V?V.responseURL:ie.headers.get("X-Request-URL");var De="response"in V?V.response:V.responseText;X(new ue(De,ie))},V.onerror=function(){J(new TypeError("Network request failed"))},V.ontimeout=function(){J(new TypeError("Network request failed"))},V.onabort=function(){J(new l.DOMException("Aborted","AbortError"))},V.open(k.method,k.url,!0),k.credentials==="include"?V.withCredentials=!0:k.credentials==="omit"&&(V.withCredentials=!1),"responseType"in V&&f.blob&&(V.responseType="blob"),k.headers.forEach(function(ie,De){V.setRequestHeader(De,ie)}),k.signal&&(k.signal.addEventListener("abort",te),V.onreadystatechange=function(){V.readyState===4&&k.signal.removeEventListener("abort",te)}),V.send(typeof k._bodyInit>"u"?null:k._bodyInit)})}return ye.polyfill=!0,c.fetch||(c.fetch=ye,c.Headers=I,c.Request=b,c.Response=ue),l.Headers=I,l.Request=b,l.Response=ue,l.fetch=ye,Object.defineProperty(l,"__esModule",{value:!0}),l})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var o=s;e=o.fetch,e.default=o.fetch,e.fetch=o.fetch,e.Headers=o.Headers,e.Request=o.Request,e.Response=o.Response,i.exports=e})(Hu,Hu.exports);var S5=Hu.exports;const Nd=ca(S5),I5={Accept:"application/json","Content-Type":"application/json"},x5="POST",$d={headers:I5,method:x5},Ud=10;class zi{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new Fr.EventEmitter,this.isAvailable=!1,this.registering=!1,!ad(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,t){this.isAvailable||await this.register();try{const s=an(e),c=await(await Nd(this.url,Object.assign(Object.assign({},$d),{body:s}))).json();this.onPayload({data:c})}catch(s){this.onError(e.id,s)}}async register(e=this.url){if(!ad(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=an({id:1,jsonrpc:"2.0",method:"test",params:[]});await Nd(e,Object.assign(Object.assign({},$d),{body:t}))}this.onOpen()}catch(t){const s=this.parseError(t);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?Ls(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=ba(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return Lp(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Ud&&this.events.setMaxListeners(Ud)}}const jd="error",P5="wss://relay.walletconnect.com",O5="wc",C5="universal_provider",Ld=`${O5}@2:${C5}:`,A5="https://rpc.walletconnect.com/v1/",Ii={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ms=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Bu={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(i,e){(function(){var t,s="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",f="Invalid `variable` option passed into `_.template`",g="__lodash_hash_undefined__",p=500,v="__lodash_placeholder__",w=1,E=2,x=4,I=1,B=2,K=1,Z=2,$=4,L=8,P=16,C=32,A=64,h=128,b=256,ee=512,ne=30,ue="...",ge=800,ye=16,S=1,R=2,X=3,J=1/0,k=9007199254740991,V=17976931348623157e292,te=NaN,ie=4294967295,De=ie-1,oe=ie>>>1,Se=[["ary",h],["bind",K],["bindKey",Z],["curry",L],["curryRight",P],["flip",ee],["partial",C],["partialRight",A],["rearg",b]],le="[object Arguments]",Ae="[object Array]",z="[object AsyncFunction]",F="[object Boolean]",U="[object Date]",d="[object DOMException]",T="[object Error]",se="[object Function]",he="[object GeneratorFunction]",Ee="[object Map]",He="[object Number]",ke="[object Null]",Le="[object Object]",dt="[object Promise]",pt="[object Proxy]",qe="[object RegExp]",Ie="[object Set]",Ne="[object String]",$e="[object Symbol]",Fe="[object Undefined]",Pe="[object WeakMap]",Ue="[object WeakSet]",be="[object ArrayBuffer]",Oe="[object DataView]",Be="[object Float32Array]",xe="[object Float64Array]",Ve="[object Int8Array]",We="[object Int16Array]",Ze="[object Int32Array]",et="[object Uint8Array]",Je="[object Uint8ClampedArray]",er="[object Uint16Array]",hr="[object Uint32Array]",Jr=/\b__p \+= '';/g,tr=/\b(__p \+=) '' \+/g,oi=/(__e\(.*?\)|\b__t\)) \+\n'';/g,xi=/&(?:amp|lt|gt|quot|#39);/g,Hi=/[&<>"']/g,Et=RegExp(xi.source),gt=RegExp(Hi.source),Dt=/<%-([\s\S]+?)%>/g,St=/<%([\s\S]+?)%>/g,wt=/<%=([\s\S]+?)%>/g,yt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$t=/^\w*$/,Ut=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,It=/[\\^$.*+?()[\]{}|]/g,jt=RegExp(It.source),xt=/^\s+/,Ct=/\s/,Pt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ut=/\{\n\/\* \[wrapped with (.+)\] \*/,Lt=/,? & /,Mt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ia=/[()=,{}\[\]\/\s]/,xa=/\\(\\)?/g,Pa=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ar=/\w*$/,Oa=/^[-+]0x[0-9a-f]+$/i,Ca=/^0b[01]+$/i,Aa=/^\[object .+?Constructor\]$/,Ta=/^0o[0-7]+$/i,Ra=/^(?:0|[1-9]\d*)$/,ai=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,dn=/($^)/,Na=/['\n\r\u2028\u2029\\]/g,pn="\\ud800-\\udfff",$a="\\u0300-\\u036f",Ua="\\ufe20-\\ufe2f",gn="\\u20d0-\\u20ff",Fs=$a+Ua+gn,zs="\\u2700-\\u27bf",zr="a-z\\xdf-\\xf6\\xf8-\\xff",ja="\\xac\\xb1\\xd7\\xf7",La="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Ma="\\u2000-\\u206f",qa=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Hs="A-Z\\xc0-\\xd6\\xd8-\\xde",Bs="\\ufe0e\\ufe0f",Bi=ja+La+Ma+qa,Gn="['’]",Ki="["+pn+"]",Wn="["+Bi+"]",ki="["+Fs+"]",Ks="\\d+",Fa="["+zs+"]",ks="["+zr+"]",Vs="[^"+pn+Bi+Ks+zs+zr+Hs+"]",yn="\\ud83c[\\udffb-\\udfff]",za="(?:"+ki+"|"+yn+")",Gs="[^"+pn+"]",vn="(?:\\ud83c[\\udde6-\\uddff]){2}",Pi="[\\ud800-\\udbff][\\udc00-\\udfff]",br="["+Hs+"]",Ws="\\u200d",Ys="(?:"+ks+"|"+Vs+")",Qr="(?:"+br+"|"+Vs+")",Js="(?:"+Gn+"(?:d|ll|m|re|s|t|ve))?",Qs="(?:"+Gn+"(?:D|LL|M|RE|S|T|VE))?",Xs=za+"?",Zs="["+Bs+"]?",Ha="(?:"+Ws+"(?:"+[Gs,vn,Pi].join("|")+")"+Zs+Xs+")*",ci="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",eo="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",to=Zs+Xs+Ha,mn="(?:"+[Fa,vn,Pi].join("|")+")"+to,Ba="(?:"+[Gs+ki+"?",ki,vn,Pi,Ki].join("|")+")",Yn=RegExp(Gn,"g"),Ka=RegExp(ki,"g"),_n=RegExp(yn+"(?="+yn+")|"+Ba+to,"g"),ro=RegExp([br+"?"+ks+"+"+Js+"(?="+[Wn,br,"$"].join("|")+")",Qr+"+"+Qs+"(?="+[Wn,br+Ys,"$"].join("|")+")",br+"?"+Ys+"+"+Js,br+"+"+Qs,eo,ci,Ks,mn].join("|"),"g"),io=RegExp("["+Ws+pn+Fs+Bs+"]"),Vi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,no=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ka=-1,st={};st[Be]=st[xe]=st[Ve]=st[We]=st[Ze]=st[et]=st[Je]=st[er]=st[hr]=!0,st[le]=st[Ae]=st[be]=st[F]=st[Oe]=st[U]=st[T]=st[se]=st[Ee]=st[He]=st[Le]=st[qe]=st[Ie]=st[Ne]=st[Pe]=!1;var nt={};nt[le]=nt[Ae]=nt[be]=nt[Oe]=nt[F]=nt[U]=nt[Be]=nt[xe]=nt[Ve]=nt[We]=nt[Ze]=nt[Ee]=nt[He]=nt[Le]=nt[qe]=nt[Ie]=nt[Ne]=nt[$e]=nt[et]=nt[Je]=nt[er]=nt[hr]=!0,nt[T]=nt[se]=nt[Pe]=!1;var D={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},j={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Q={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},fe={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ot=parseFloat,Te=parseInt,lt=typeof ms=="object"&&ms&&ms.Object===Object&&ms,qt=typeof self=="object"&&self&&self.Object===Object&&self,Qe=lt||qt||Function("return this")(),at=e&&!e.nodeType&&e,At=at&&!0&&i&&!i.nodeType&&i,lr=At&&At.exports===at,Ft=lr&&lt.process,ft=function(){try{var M=At&&At.require&&At.require("util").types;return M||Ft&&Ft.binding&&Ft.binding("util")}catch{}}(),rr=ft&&ft.isArrayBuffer,Hr=ft&&ft.isDate,Tr=ft&&ft.isMap,Xr=ft&&ft.isRegExp,Jn=ft&&ft.isSet,Gi=ft&&ft.isTypedArray;function Bt(M,G,H){switch(H.length){case 0:return M.call(G);case 1:return M.call(G,H[0]);case 2:return M.call(G,H[0],H[1]);case 3:return M.call(G,H[0],H[1],H[2])}return M.apply(G,H)}function hg(M,G,H,de){for(var Ce=-1,tt=M==null?0:M.length;++Ce<tt;){var zt=M[Ce];G(de,zt,H(zt),M)}return de}function Rr(M,G){for(var H=-1,de=M==null?0:M.length;++H<de&&G(M[H],H,M)!==!1;);return M}function lg(M,G){for(var H=M==null?0:M.length;H--&&G(M[H],H,M)!==!1;);return M}function ph(M,G){for(var H=-1,de=M==null?0:M.length;++H<de;)if(!G(M[H],H,M))return!1;return!0}function Oi(M,G){for(var H=-1,de=M==null?0:M.length,Ce=0,tt=[];++H<de;){var zt=M[H];G(zt,H,M)&&(tt[Ce++]=zt)}return tt}function so(M,G){var H=M==null?0:M.length;return!!H&&wn(M,G,0)>-1}function Va(M,G,H){for(var de=-1,Ce=M==null?0:M.length;++de<Ce;)if(H(G,M[de]))return!0;return!1}function vt(M,G){for(var H=-1,de=M==null?0:M.length,Ce=Array(de);++H<de;)Ce[H]=G(M[H],H,M);return Ce}function Ci(M,G){for(var H=-1,de=G.length,Ce=M.length;++H<de;)M[Ce+H]=G[H];return M}function Ga(M,G,H,de){var Ce=-1,tt=M==null?0:M.length;for(de&&tt&&(H=M[++Ce]);++Ce<tt;)H=G(H,M[Ce],Ce,M);return H}function fg(M,G,H,de){var Ce=M==null?0:M.length;for(de&&Ce&&(H=M[--Ce]);Ce--;)H=G(H,M[Ce],Ce,M);return H}function Wa(M,G){for(var H=-1,de=M==null?0:M.length;++H<de;)if(G(M[H],H,M))return!0;return!1}var dg=Ya("length");function pg(M){return M.split("")}function gg(M){return M.match(Mt)||[]}function gh(M,G,H){var de;return H(M,function(Ce,tt,zt){if(G(Ce,tt,zt))return de=tt,!1}),de}function oo(M,G,H,de){for(var Ce=M.length,tt=H+(de?1:-1);de?tt--:++tt<Ce;)if(G(M[tt],tt,M))return tt;return-1}function wn(M,G,H){return G===G?Pg(M,G,H):oo(M,yh,H)}function yg(M,G,H,de){for(var Ce=H-1,tt=M.length;++Ce<tt;)if(de(M[Ce],G))return Ce;return-1}function yh(M){return M!==M}function vh(M,G){var H=M==null?0:M.length;return H?Qa(M,G)/H:te}function Ya(M){return function(G){return G==null?t:G[M]}}function Ja(M){return function(G){return M==null?t:M[G]}}function mh(M,G,H,de,Ce){return Ce(M,function(tt,zt,ct){H=de?(de=!1,tt):G(H,tt,zt,ct)}),H}function vg(M,G){var H=M.length;for(M.sort(G);H--;)M[H]=M[H].value;return M}function Qa(M,G){for(var H,de=-1,Ce=M.length;++de<Ce;){var tt=G(M[de]);tt!==t&&(H=H===t?tt:H+tt)}return H}function Xa(M,G){for(var H=-1,de=Array(M);++H<M;)de[H]=G(H);return de}function mg(M,G){return vt(G,function(H){return[H,M[H]]})}function _h(M){return M&&M.slice(0,Dh(M)+1).replace(xt,"")}function Er(M){return function(G){return M(G)}}function Za(M,G){return vt(G,function(H){return M[H]})}function Qn(M,G){return M.has(G)}function wh(M,G){for(var H=-1,de=M.length;++H<de&&wn(G,M[H],0)>-1;);return H}function bh(M,G){for(var H=M.length;H--&&wn(G,M[H],0)>-1;);return H}function _g(M,G){for(var H=M.length,de=0;H--;)M[H]===G&&++de;return de}var wg=Ja(D),bg=Ja(j);function Eg(M){return"\\"+fe[M]}function Dg(M,G){return M==null?t:M[G]}function bn(M){return io.test(M)}function Sg(M){return Vi.test(M)}function Ig(M){for(var G,H=[];!(G=M.next()).done;)H.push(G.value);return H}function ec(M){var G=-1,H=Array(M.size);return M.forEach(function(de,Ce){H[++G]=[Ce,de]}),H}function Eh(M,G){return function(H){return M(G(H))}}function Ai(M,G){for(var H=-1,de=M.length,Ce=0,tt=[];++H<de;){var zt=M[H];(zt===G||zt===v)&&(M[H]=v,tt[Ce++]=H)}return tt}function ao(M){var G=-1,H=Array(M.size);return M.forEach(function(de){H[++G]=de}),H}function xg(M){var G=-1,H=Array(M.size);return M.forEach(function(de){H[++G]=[de,de]}),H}function Pg(M,G,H){for(var de=H-1,Ce=M.length;++de<Ce;)if(M[de]===G)return de;return-1}function Og(M,G,H){for(var de=H+1;de--;)if(M[de]===G)return de;return de}function En(M){return bn(M)?Ag(M):dg(M)}function Br(M){return bn(M)?Tg(M):pg(M)}function Dh(M){for(var G=M.length;G--&&Ct.test(M.charAt(G)););return G}var Cg=Ja(Q);function Ag(M){for(var G=_n.lastIndex=0;_n.test(M);)++G;return G}function Tg(M){return M.match(_n)||[]}function Rg(M){return M.match(ro)||[]}var Ng=function M(G){G=G==null?Qe:Dn.defaults(Qe.Object(),G,Dn.pick(Qe,no));var H=G.Array,de=G.Date,Ce=G.Error,tt=G.Function,zt=G.Math,ct=G.Object,tc=G.RegExp,$g=G.String,Nr=G.TypeError,co=H.prototype,Ug=tt.prototype,Sn=ct.prototype,uo=G["__core-js_shared__"],ho=Ug.toString,it=Sn.hasOwnProperty,jg=0,Sh=function(){var r=/[^.]+$/.exec(uo&&uo.keys&&uo.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),lo=Sn.toString,Lg=ho.call(ct),Mg=Qe._,qg=tc("^"+ho.call(it).replace(It,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),fo=lr?G.Buffer:t,Ti=G.Symbol,po=G.Uint8Array,Ih=fo?fo.allocUnsafe:t,go=Eh(ct.getPrototypeOf,ct),xh=ct.create,Ph=Sn.propertyIsEnumerable,yo=co.splice,Oh=Ti?Ti.isConcatSpreadable:t,Xn=Ti?Ti.iterator:t,Wi=Ti?Ti.toStringTag:t,vo=function(){try{var r=Zi(ct,"defineProperty");return r({},"",{}),r}catch{}}(),Fg=G.clearTimeout!==Qe.clearTimeout&&G.clearTimeout,zg=de&&de.now!==Qe.Date.now&&de.now,Hg=G.setTimeout!==Qe.setTimeout&&G.setTimeout,mo=zt.ceil,_o=zt.floor,rc=ct.getOwnPropertySymbols,Bg=fo?fo.isBuffer:t,Ch=G.isFinite,Kg=co.join,kg=Eh(ct.keys,ct),Ht=zt.max,Jt=zt.min,Vg=de.now,Gg=G.parseInt,Ah=zt.random,Wg=co.reverse,ic=Zi(G,"DataView"),Zn=Zi(G,"Map"),nc=Zi(G,"Promise"),In=Zi(G,"Set"),es=Zi(G,"WeakMap"),ts=Zi(ct,"create"),wo=es&&new es,xn={},Yg=en(ic),Jg=en(Zn),Qg=en(nc),Xg=en(In),Zg=en(es),bo=Ti?Ti.prototype:t,rs=bo?bo.valueOf:t,Th=bo?bo.toString:t;function m(r){if(Ot(r)&&!Re(r)&&!(r instanceof Ye)){if(r instanceof $r)return r;if(it.call(r,"__wrapped__"))return Rl(r)}return new $r(r)}var Pn=function(){function r(){}return function(n){if(!bt(n))return{};if(xh)return xh(n);r.prototype=n;var a=new r;return r.prototype=t,a}}();function Eo(){}function $r(r,n){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=t}m.templateSettings={escape:Dt,evaluate:St,interpolate:wt,variable:"",imports:{_:m}},m.prototype=Eo.prototype,m.prototype.constructor=m,$r.prototype=Pn(Eo.prototype),$r.prototype.constructor=$r;function Ye(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ie,this.__views__=[]}function e0(){var r=new Ye(this.__wrapped__);return r.__actions__=fr(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=fr(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=fr(this.__views__),r}function t0(){if(this.__filtered__){var r=new Ye(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function r0(){var r=this.__wrapped__.value(),n=this.__dir__,a=Re(r),u=n<0,y=a?r.length:0,_=py(0,y,this.__views__),O=_.start,N=_.end,q=N-O,W=u?N:O-1,Y=this.__iteratees__,re=Y.length,ce=0,pe=Jt(q,this.__takeCount__);if(!a||!u&&y==q&&pe==q)return tl(r,this.__actions__);var _e=[];e:for(;q--&&ce<pe;){W+=n;for(var ze=-1,we=r[W];++ze<re;){var Ge=Y[ze],Xe=Ge.iteratee,Ir=Ge.type,sr=Xe(we);if(Ir==R)we=sr;else if(!sr){if(Ir==S)continue e;break e}}_e[ce++]=we}return _e}Ye.prototype=Pn(Eo.prototype),Ye.prototype.constructor=Ye;function Yi(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var u=r[n];this.set(u[0],u[1])}}function i0(){this.__data__=ts?ts(null):{},this.size=0}function n0(r){var n=this.has(r)&&delete this.__data__[r];return this.size-=n?1:0,n}function s0(r){var n=this.__data__;if(ts){var a=n[r];return a===g?t:a}return it.call(n,r)?n[r]:t}function o0(r){var n=this.__data__;return ts?n[r]!==t:it.call(n,r)}function a0(r,n){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=ts&&n===t?g:n,this}Yi.prototype.clear=i0,Yi.prototype.delete=n0,Yi.prototype.get=s0,Yi.prototype.has=o0,Yi.prototype.set=a0;function ui(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var u=r[n];this.set(u[0],u[1])}}function c0(){this.__data__=[],this.size=0}function u0(r){var n=this.__data__,a=Do(n,r);if(a<0)return!1;var u=n.length-1;return a==u?n.pop():yo.call(n,a,1),--this.size,!0}function h0(r){var n=this.__data__,a=Do(n,r);return a<0?t:n[a][1]}function l0(r){return Do(this.__data__,r)>-1}function f0(r,n){var a=this.__data__,u=Do(a,r);return u<0?(++this.size,a.push([r,n])):a[u][1]=n,this}ui.prototype.clear=c0,ui.prototype.delete=u0,ui.prototype.get=h0,ui.prototype.has=l0,ui.prototype.set=f0;function hi(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var u=r[n];this.set(u[0],u[1])}}function d0(){this.size=0,this.__data__={hash:new Yi,map:new(Zn||ui),string:new Yi}}function p0(r){var n=Uo(this,r).delete(r);return this.size-=n?1:0,n}function g0(r){return Uo(this,r).get(r)}function y0(r){return Uo(this,r).has(r)}function v0(r,n){var a=Uo(this,r),u=a.size;return a.set(r,n),this.size+=a.size==u?0:1,this}hi.prototype.clear=d0,hi.prototype.delete=p0,hi.prototype.get=g0,hi.prototype.has=y0,hi.prototype.set=v0;function Ji(r){var n=-1,a=r==null?0:r.length;for(this.__data__=new hi;++n<a;)this.add(r[n])}function m0(r){return this.__data__.set(r,g),this}function _0(r){return this.__data__.has(r)}Ji.prototype.add=Ji.prototype.push=m0,Ji.prototype.has=_0;function Kr(r){var n=this.__data__=new ui(r);this.size=n.size}function w0(){this.__data__=new ui,this.size=0}function b0(r){var n=this.__data__,a=n.delete(r);return this.size=n.size,a}function E0(r){return this.__data__.get(r)}function D0(r){return this.__data__.has(r)}function S0(r,n){var a=this.__data__;if(a instanceof ui){var u=a.__data__;if(!Zn||u.length<o-1)return u.push([r,n]),this.size=++a.size,this;a=this.__data__=new hi(u)}return a.set(r,n),this.size=a.size,this}Kr.prototype.clear=w0,Kr.prototype.delete=b0,Kr.prototype.get=E0,Kr.prototype.has=D0,Kr.prototype.set=S0;function Rh(r,n){var a=Re(r),u=!a&&tn(r),y=!a&&!u&&ji(r),_=!a&&!u&&!y&&Tn(r),O=a||u||y||_,N=O?Xa(r.length,$g):[],q=N.length;for(var W in r)(n||it.call(r,W))&&!(O&&(W=="length"||y&&(W=="offset"||W=="parent")||_&&(W=="buffer"||W=="byteLength"||W=="byteOffset")||pi(W,q)))&&N.push(W);return N}function Nh(r){var n=r.length;return n?r[gc(0,n-1)]:t}function I0(r,n){return jo(fr(r),Qi(n,0,r.length))}function x0(r){return jo(fr(r))}function sc(r,n,a){(a!==t&&!kr(r[n],a)||a===t&&!(n in r))&&li(r,n,a)}function is(r,n,a){var u=r[n];(!(it.call(r,n)&&kr(u,a))||a===t&&!(n in r))&&li(r,n,a)}function Do(r,n){for(var a=r.length;a--;)if(kr(r[a][0],n))return a;return-1}function P0(r,n,a,u){return Ri(r,function(y,_,O){n(u,y,a(y),O)}),u}function $h(r,n){return r&&ei(n,Kt(n),r)}function O0(r,n){return r&&ei(n,pr(n),r)}function li(r,n,a){n=="__proto__"&&vo?vo(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}function oc(r,n){for(var a=-1,u=n.length,y=H(u),_=r==null;++a<u;)y[a]=_?t:Fc(r,n[a]);return y}function Qi(r,n,a){return r===r&&(a!==t&&(r=r<=a?r:a),n!==t&&(r=r>=n?r:n)),r}function Ur(r,n,a,u,y,_){var O,N=n&w,q=n&E,W=n&x;if(a&&(O=y?a(r,u,y,_):a(r)),O!==t)return O;if(!bt(r))return r;var Y=Re(r);if(Y){if(O=yy(r),!N)return fr(r,O)}else{var re=Qt(r),ce=re==se||re==he;if(ji(r))return nl(r,N);if(re==Le||re==le||ce&&!y){if(O=q||ce?{}:Dl(r),!N)return q?sy(r,O0(O,r)):ny(r,$h(O,r))}else{if(!nt[re])return y?r:{};O=vy(r,re,N)}}_||(_=new Kr);var pe=_.get(r);if(pe)return pe;_.set(r,O),Xl(r)?r.forEach(function(we){O.add(Ur(we,n,a,we,r,_))}):Jl(r)&&r.forEach(function(we,Ge){O.set(Ge,Ur(we,n,a,Ge,r,_))});var _e=W?q?xc:Ic:q?pr:Kt,ze=Y?t:_e(r);return Rr(ze||r,function(we,Ge){ze&&(Ge=we,we=r[Ge]),is(O,Ge,Ur(we,n,a,Ge,r,_))}),O}function C0(r){var n=Kt(r);return function(a){return Uh(a,r,n)}}function Uh(r,n,a){var u=a.length;if(r==null)return!u;for(r=ct(r);u--;){var y=a[u],_=n[y],O=r[y];if(O===t&&!(y in r)||!_(O))return!1}return!0}function jh(r,n,a){if(typeof r!="function")throw new Nr(l);return hs(function(){r.apply(t,a)},n)}function ns(r,n,a,u){var y=-1,_=so,O=!0,N=r.length,q=[],W=n.length;if(!N)return q;a&&(n=vt(n,Er(a))),u?(_=Va,O=!1):n.length>=o&&(_=Qn,O=!1,n=new Ji(n));e:for(;++y<N;){var Y=r[y],re=a==null?Y:a(Y);if(Y=u||Y!==0?Y:0,O&&re===re){for(var ce=W;ce--;)if(n[ce]===re)continue e;q.push(Y)}else _(n,re,u)||q.push(Y)}return q}var Ri=ul(Zr),Lh=ul(cc,!0);function A0(r,n){var a=!0;return Ri(r,function(u,y,_){return a=!!n(u,y,_),a}),a}function So(r,n,a){for(var u=-1,y=r.length;++u<y;){var _=r[u],O=n(_);if(O!=null&&(N===t?O===O&&!Sr(O):a(O,N)))var N=O,q=_}return q}function T0(r,n,a,u){var y=r.length;for(a=Me(a),a<0&&(a=-a>y?0:y+a),u=u===t||u>y?y:Me(u),u<0&&(u+=y),u=a>u?0:ef(u);a<u;)r[a++]=n;return r}function Mh(r,n){var a=[];return Ri(r,function(u,y,_){n(u,y,_)&&a.push(u)}),a}function Gt(r,n,a,u,y){var _=-1,O=r.length;for(a||(a=_y),y||(y=[]);++_<O;){var N=r[_];n>0&&a(N)?n>1?Gt(N,n-1,a,u,y):Ci(y,N):u||(y[y.length]=N)}return y}var ac=hl(),qh=hl(!0);function Zr(r,n){return r&&ac(r,n,Kt)}function cc(r,n){return r&&qh(r,n,Kt)}function Io(r,n){return Oi(n,function(a){return gi(r[a])})}function Xi(r,n){n=$i(n,r);for(var a=0,u=n.length;r!=null&&a<u;)r=r[ti(n[a++])];return a&&a==u?r:t}function Fh(r,n,a){var u=n(r);return Re(r)?u:Ci(u,a(r))}function ir(r){return r==null?r===t?Fe:ke:Wi&&Wi in ct(r)?dy(r):xy(r)}function uc(r,n){return r>n}function R0(r,n){return r!=null&&it.call(r,n)}function N0(r,n){return r!=null&&n in ct(r)}function $0(r,n,a){return r>=Jt(n,a)&&r<Ht(n,a)}function hc(r,n,a){for(var u=a?Va:so,y=r[0].length,_=r.length,O=_,N=H(_),q=1/0,W=[];O--;){var Y=r[O];O&&n&&(Y=vt(Y,Er(n))),q=Jt(Y.length,q),N[O]=!a&&(n||y>=120&&Y.length>=120)?new Ji(O&&Y):t}Y=r[0];var re=-1,ce=N[0];e:for(;++re<y&&W.length<q;){var pe=Y[re],_e=n?n(pe):pe;if(pe=a||pe!==0?pe:0,!(ce?Qn(ce,_e):u(W,_e,a))){for(O=_;--O;){var ze=N[O];if(!(ze?Qn(ze,_e):u(r[O],_e,a)))continue e}ce&&ce.push(_e),W.push(pe)}}return W}function U0(r,n,a,u){return Zr(r,function(y,_,O){n(u,a(y),_,O)}),u}function ss(r,n,a){n=$i(n,r),r=Pl(r,n);var u=r==null?r:r[ti(Lr(n))];return u==null?t:Bt(u,r,a)}function zh(r){return Ot(r)&&ir(r)==le}function j0(r){return Ot(r)&&ir(r)==be}function L0(r){return Ot(r)&&ir(r)==U}function os(r,n,a,u,y){return r===n?!0:r==null||n==null||!Ot(r)&&!Ot(n)?r!==r&&n!==n:M0(r,n,a,u,os,y)}function M0(r,n,a,u,y,_){var O=Re(r),N=Re(n),q=O?Ae:Qt(r),W=N?Ae:Qt(n);q=q==le?Le:q,W=W==le?Le:W;var Y=q==Le,re=W==Le,ce=q==W;if(ce&&ji(r)){if(!ji(n))return!1;O=!0,Y=!1}if(ce&&!Y)return _||(_=new Kr),O||Tn(r)?wl(r,n,a,u,y,_):ly(r,n,q,a,u,y,_);if(!(a&I)){var pe=Y&&it.call(r,"__wrapped__"),_e=re&&it.call(n,"__wrapped__");if(pe||_e){var ze=pe?r.value():r,we=_e?n.value():n;return _||(_=new Kr),y(ze,we,a,u,_)}}return ce?(_||(_=new Kr),fy(r,n,a,u,y,_)):!1}function q0(r){return Ot(r)&&Qt(r)==Ee}function lc(r,n,a,u){var y=a.length,_=y,O=!u;if(r==null)return!_;for(r=ct(r);y--;){var N=a[y];if(O&&N[2]?N[1]!==r[N[0]]:!(N[0]in r))return!1}for(;++y<_;){N=a[y];var q=N[0],W=r[q],Y=N[1];if(O&&N[2]){if(W===t&&!(q in r))return!1}else{var re=new Kr;if(u)var ce=u(W,Y,q,r,n,re);if(!(ce===t?os(Y,W,I|B,u,re):ce))return!1}}return!0}function Hh(r){if(!bt(r)||by(r))return!1;var n=gi(r)?qg:Aa;return n.test(en(r))}function F0(r){return Ot(r)&&ir(r)==qe}function z0(r){return Ot(r)&&Qt(r)==Ie}function H0(r){return Ot(r)&&Ho(r.length)&&!!st[ir(r)]}function Bh(r){return typeof r=="function"?r:r==null?gr:typeof r=="object"?Re(r)?Vh(r[0],r[1]):kh(r):ff(r)}function fc(r){if(!us(r))return kg(r);var n=[];for(var a in ct(r))it.call(r,a)&&a!="constructor"&&n.push(a);return n}function B0(r){if(!bt(r))return Iy(r);var n=us(r),a=[];for(var u in r)u=="constructor"&&(n||!it.call(r,u))||a.push(u);return a}function dc(r,n){return r<n}function Kh(r,n){var a=-1,u=dr(r)?H(r.length):[];return Ri(r,function(y,_,O){u[++a]=n(y,_,O)}),u}function kh(r){var n=Oc(r);return n.length==1&&n[0][2]?Il(n[0][0],n[0][1]):function(a){return a===r||lc(a,r,n)}}function Vh(r,n){return Ac(r)&&Sl(n)?Il(ti(r),n):function(a){var u=Fc(a,r);return u===t&&u===n?zc(a,r):os(n,u,I|B)}}function xo(r,n,a,u,y){r!==n&&ac(n,function(_,O){if(y||(y=new Kr),bt(_))K0(r,n,O,a,xo,u,y);else{var N=u?u(Rc(r,O),_,O+"",r,n,y):t;N===t&&(N=_),sc(r,O,N)}},pr)}function K0(r,n,a,u,y,_,O){var N=Rc(r,a),q=Rc(n,a),W=O.get(q);if(W){sc(r,a,W);return}var Y=_?_(N,q,a+"",r,n,O):t,re=Y===t;if(re){var ce=Re(q),pe=!ce&&ji(q),_e=!ce&&!pe&&Tn(q);Y=q,ce||pe||_e?Re(N)?Y=N:Tt(N)?Y=fr(N):pe?(re=!1,Y=nl(q,!0)):_e?(re=!1,Y=sl(q,!0)):Y=[]:ls(q)||tn(q)?(Y=N,tn(N)?Y=tf(N):(!bt(N)||gi(N))&&(Y=Dl(q))):re=!1}re&&(O.set(q,Y),y(Y,q,u,_,O),O.delete(q)),sc(r,a,Y)}function Gh(r,n){var a=r.length;if(a)return n+=n<0?a:0,pi(n,a)?r[n]:t}function Wh(r,n,a){n.length?n=vt(n,function(_){return Re(_)?function(O){return Xi(O,_.length===1?_[0]:_)}:_}):n=[gr];var u=-1;n=vt(n,Er(me()));var y=Kh(r,function(_,O,N){var q=vt(n,function(W){return W(_)});return{criteria:q,index:++u,value:_}});return vg(y,function(_,O){return iy(_,O,a)})}function k0(r,n){return Yh(r,n,function(a,u){return zc(r,u)})}function Yh(r,n,a){for(var u=-1,y=n.length,_={};++u<y;){var O=n[u],N=Xi(r,O);a(N,O)&&as(_,$i(O,r),N)}return _}function V0(r){return function(n){return Xi(n,r)}}function pc(r,n,a,u){var y=u?yg:wn,_=-1,O=n.length,N=r;for(r===n&&(n=fr(n)),a&&(N=vt(r,Er(a)));++_<O;)for(var q=0,W=n[_],Y=a?a(W):W;(q=y(N,Y,q,u))>-1;)N!==r&&yo.call(N,q,1),yo.call(r,q,1);return r}function Jh(r,n){for(var a=r?n.length:0,u=a-1;a--;){var y=n[a];if(a==u||y!==_){var _=y;pi(y)?yo.call(r,y,1):mc(r,y)}}return r}function gc(r,n){return r+_o(Ah()*(n-r+1))}function G0(r,n,a,u){for(var y=-1,_=Ht(mo((n-r)/(a||1)),0),O=H(_);_--;)O[u?_:++y]=r,r+=a;return O}function yc(r,n){var a="";if(!r||n<1||n>k)return a;do n%2&&(a+=r),n=_o(n/2),n&&(r+=r);while(n);return a}function Ke(r,n){return Nc(xl(r,n,gr),r+"")}function W0(r){return Nh(Rn(r))}function Y0(r,n){var a=Rn(r);return jo(a,Qi(n,0,a.length))}function as(r,n,a,u){if(!bt(r))return r;n=$i(n,r);for(var y=-1,_=n.length,O=_-1,N=r;N!=null&&++y<_;){var q=ti(n[y]),W=a;if(q==="__proto__"||q==="constructor"||q==="prototype")return r;if(y!=O){var Y=N[q];W=u?u(Y,q,N):t,W===t&&(W=bt(Y)?Y:pi(n[y+1])?[]:{})}is(N,q,W),N=N[q]}return r}var Qh=wo?function(r,n){return wo.set(r,n),r}:gr,J0=vo?function(r,n){return vo(r,"toString",{configurable:!0,enumerable:!1,value:Bc(n),writable:!0})}:gr;function Q0(r){return jo(Rn(r))}function jr(r,n,a){var u=-1,y=r.length;n<0&&(n=-n>y?0:y+n),a=a>y?y:a,a<0&&(a+=y),y=n>a?0:a-n>>>0,n>>>=0;for(var _=H(y);++u<y;)_[u]=r[u+n];return _}function X0(r,n){var a;return Ri(r,function(u,y,_){return a=n(u,y,_),!a}),!!a}function Po(r,n,a){var u=0,y=r==null?u:r.length;if(typeof n=="number"&&n===n&&y<=oe){for(;u<y;){var _=u+y>>>1,O=r[_];O!==null&&!Sr(O)&&(a?O<=n:O<n)?u=_+1:y=_}return y}return vc(r,n,gr,a)}function vc(r,n,a,u){var y=0,_=r==null?0:r.length;if(_===0)return 0;n=a(n);for(var O=n!==n,N=n===null,q=Sr(n),W=n===t;y<_;){var Y=_o((y+_)/2),re=a(r[Y]),ce=re!==t,pe=re===null,_e=re===re,ze=Sr(re);if(O)var we=u||_e;else W?we=_e&&(u||ce):N?we=_e&&ce&&(u||!pe):q?we=_e&&ce&&!pe&&(u||!ze):pe||ze?we=!1:we=u?re<=n:re<n;we?y=Y+1:_=Y}return Jt(_,De)}function Xh(r,n){for(var a=-1,u=r.length,y=0,_=[];++a<u;){var O=r[a],N=n?n(O):O;if(!a||!kr(N,q)){var q=N;_[y++]=O===0?0:O}}return _}function Zh(r){return typeof r=="number"?r:Sr(r)?te:+r}function Dr(r){if(typeof r=="string")return r;if(Re(r))return vt(r,Dr)+"";if(Sr(r))return Th?Th.call(r):"";var n=r+"";return n=="0"&&1/r==-J?"-0":n}function Ni(r,n,a){var u=-1,y=so,_=r.length,O=!0,N=[],q=N;if(a)O=!1,y=Va;else if(_>=o){var W=n?null:uy(r);if(W)return ao(W);O=!1,y=Qn,q=new Ji}else q=n?[]:N;e:for(;++u<_;){var Y=r[u],re=n?n(Y):Y;if(Y=a||Y!==0?Y:0,O&&re===re){for(var ce=q.length;ce--;)if(q[ce]===re)continue e;n&&q.push(re),N.push(Y)}else y(q,re,a)||(q!==N&&q.push(re),N.push(Y))}return N}function mc(r,n){return n=$i(n,r),r=Pl(r,n),r==null||delete r[ti(Lr(n))]}function el(r,n,a,u){return as(r,n,a(Xi(r,n)),u)}function Oo(r,n,a,u){for(var y=r.length,_=u?y:-1;(u?_--:++_<y)&&n(r[_],_,r););return a?jr(r,u?0:_,u?_+1:y):jr(r,u?_+1:0,u?y:_)}function tl(r,n){var a=r;return a instanceof Ye&&(a=a.value()),Ga(n,function(u,y){return y.func.apply(y.thisArg,Ci([u],y.args))},a)}function _c(r,n,a){var u=r.length;if(u<2)return u?Ni(r[0]):[];for(var y=-1,_=H(u);++y<u;)for(var O=r[y],N=-1;++N<u;)N!=y&&(_[y]=ns(_[y]||O,r[N],n,a));return Ni(Gt(_,1),n,a)}function rl(r,n,a){for(var u=-1,y=r.length,_=n.length,O={};++u<y;){var N=u<_?n[u]:t;a(O,r[u],N)}return O}function wc(r){return Tt(r)?r:[]}function bc(r){return typeof r=="function"?r:gr}function $i(r,n){return Re(r)?r:Ac(r,n)?[r]:Tl(rt(r))}var Z0=Ke;function Ui(r,n,a){var u=r.length;return a=a===t?u:a,!n&&a>=u?r:jr(r,n,a)}var il=Fg||function(r){return Qe.clearTimeout(r)};function nl(r,n){if(n)return r.slice();var a=r.length,u=Ih?Ih(a):new r.constructor(a);return r.copy(u),u}function Ec(r){var n=new r.constructor(r.byteLength);return new po(n).set(new po(r)),n}function ey(r,n){var a=n?Ec(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.byteLength)}function ty(r){var n=new r.constructor(r.source,Ar.exec(r));return n.lastIndex=r.lastIndex,n}function ry(r){return rs?ct(rs.call(r)):{}}function sl(r,n){var a=n?Ec(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.length)}function ol(r,n){if(r!==n){var a=r!==t,u=r===null,y=r===r,_=Sr(r),O=n!==t,N=n===null,q=n===n,W=Sr(n);if(!N&&!W&&!_&&r>n||_&&O&&q&&!N&&!W||u&&O&&q||!a&&q||!y)return 1;if(!u&&!_&&!W&&r<n||W&&a&&y&&!u&&!_||N&&a&&y||!O&&y||!q)return-1}return 0}function iy(r,n,a){for(var u=-1,y=r.criteria,_=n.criteria,O=y.length,N=a.length;++u<O;){var q=ol(y[u],_[u]);if(q){if(u>=N)return q;var W=a[u];return q*(W=="desc"?-1:1)}}return r.index-n.index}function al(r,n,a,u){for(var y=-1,_=r.length,O=a.length,N=-1,q=n.length,W=Ht(_-O,0),Y=H(q+W),re=!u;++N<q;)Y[N]=n[N];for(;++y<O;)(re||y<_)&&(Y[a[y]]=r[y]);for(;W--;)Y[N++]=r[y++];return Y}function cl(r,n,a,u){for(var y=-1,_=r.length,O=-1,N=a.length,q=-1,W=n.length,Y=Ht(_-N,0),re=H(Y+W),ce=!u;++y<Y;)re[y]=r[y];for(var pe=y;++q<W;)re[pe+q]=n[q];for(;++O<N;)(ce||y<_)&&(re[pe+a[O]]=r[y++]);return re}function fr(r,n){var a=-1,u=r.length;for(n||(n=H(u));++a<u;)n[a]=r[a];return n}function ei(r,n,a,u){var y=!a;a||(a={});for(var _=-1,O=n.length;++_<O;){var N=n[_],q=u?u(a[N],r[N],N,a,r):t;q===t&&(q=r[N]),y?li(a,N,q):is(a,N,q)}return a}function ny(r,n){return ei(r,Cc(r),n)}function sy(r,n){return ei(r,bl(r),n)}function Co(r,n){return function(a,u){var y=Re(a)?hg:P0,_=n?n():{};return y(a,r,me(u,2),_)}}function On(r){return Ke(function(n,a){var u=-1,y=a.length,_=y>1?a[y-1]:t,O=y>2?a[2]:t;for(_=r.length>3&&typeof _=="function"?(y--,_):t,O&&nr(a[0],a[1],O)&&(_=y<3?t:_,y=1),n=ct(n);++u<y;){var N=a[u];N&&r(n,N,u,_)}return n})}function ul(r,n){return function(a,u){if(a==null)return a;if(!dr(a))return r(a,u);for(var y=a.length,_=n?y:-1,O=ct(a);(n?_--:++_<y)&&u(O[_],_,O)!==!1;);return a}}function hl(r){return function(n,a,u){for(var y=-1,_=ct(n),O=u(n),N=O.length;N--;){var q=O[r?N:++y];if(a(_[q],q,_)===!1)break}return n}}function oy(r,n,a){var u=n&K,y=cs(r);function _(){var O=this&&this!==Qe&&this instanceof _?y:r;return O.apply(u?a:this,arguments)}return _}function ll(r){return function(n){n=rt(n);var a=bn(n)?Br(n):t,u=a?a[0]:n.charAt(0),y=a?Ui(a,1).join(""):n.slice(1);return u[r]()+y}}function Cn(r){return function(n){return Ga(hf(uf(n).replace(Yn,"")),r,"")}}function cs(r){return function(){var n=arguments;switch(n.length){case 0:return new r;case 1:return new r(n[0]);case 2:return new r(n[0],n[1]);case 3:return new r(n[0],n[1],n[2]);case 4:return new r(n[0],n[1],n[2],n[3]);case 5:return new r(n[0],n[1],n[2],n[3],n[4]);case 6:return new r(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new r(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var a=Pn(r.prototype),u=r.apply(a,n);return bt(u)?u:a}}function ay(r,n,a){var u=cs(r);function y(){for(var _=arguments.length,O=H(_),N=_,q=An(y);N--;)O[N]=arguments[N];var W=_<3&&O[0]!==q&&O[_-1]!==q?[]:Ai(O,q);if(_-=W.length,_<a)return yl(r,n,Ao,y.placeholder,t,O,W,t,t,a-_);var Y=this&&this!==Qe&&this instanceof y?u:r;return Bt(Y,this,O)}return y}function fl(r){return function(n,a,u){var y=ct(n);if(!dr(n)){var _=me(a,3);n=Kt(n),a=function(N){return _(y[N],N,y)}}var O=r(n,a,u);return O>-1?y[_?n[O]:O]:t}}function dl(r){return di(function(n){var a=n.length,u=a,y=$r.prototype.thru;for(r&&n.reverse();u--;){var _=n[u];if(typeof _!="function")throw new Nr(l);if(y&&!O&&$o(_)=="wrapper")var O=new $r([],!0)}for(u=O?u:a;++u<a;){_=n[u];var N=$o(_),q=N=="wrapper"?Pc(_):t;q&&Tc(q[0])&&q[1]==(h|L|C|b)&&!q[4].length&&q[9]==1?O=O[$o(q[0])].apply(O,q[3]):O=_.length==1&&Tc(_)?O[N]():O.thru(_)}return function(){var W=arguments,Y=W[0];if(O&&W.length==1&&Re(Y))return O.plant(Y).value();for(var re=0,ce=a?n[re].apply(this,W):Y;++re<a;)ce=n[re].call(this,ce);return ce}})}function Ao(r,n,a,u,y,_,O,N,q,W){var Y=n&h,re=n&K,ce=n&Z,pe=n&(L|P),_e=n&ee,ze=ce?t:cs(r);function we(){for(var Ge=arguments.length,Xe=H(Ge),Ir=Ge;Ir--;)Xe[Ir]=arguments[Ir];if(pe)var sr=An(we),xr=_g(Xe,sr);if(u&&(Xe=al(Xe,u,y,pe)),_&&(Xe=cl(Xe,_,O,pe)),Ge-=xr,pe&&Ge<W){var Rt=Ai(Xe,sr);return yl(r,n,Ao,we.placeholder,a,Xe,Rt,N,q,W-Ge)}var Vr=re?a:this,vi=ce?Vr[r]:r;return Ge=Xe.length,N?Xe=Py(Xe,N):_e&&Ge>1&&Xe.reverse(),Y&&q<Ge&&(Xe.length=q),this&&this!==Qe&&this instanceof we&&(vi=ze||cs(vi)),vi.apply(Vr,Xe)}return we}function pl(r,n){return function(a,u){return U0(a,r,n(u),{})}}function To(r,n){return function(a,u){var y;if(a===t&&u===t)return n;if(a!==t&&(y=a),u!==t){if(y===t)return u;typeof a=="string"||typeof u=="string"?(a=Dr(a),u=Dr(u)):(a=Zh(a),u=Zh(u)),y=r(a,u)}return y}}function Dc(r){return di(function(n){return n=vt(n,Er(me())),Ke(function(a){var u=this;return r(n,function(y){return Bt(y,u,a)})})})}function Ro(r,n){n=n===t?" ":Dr(n);var a=n.length;if(a<2)return a?yc(n,r):n;var u=yc(n,mo(r/En(n)));return bn(n)?Ui(Br(u),0,r).join(""):u.slice(0,r)}function cy(r,n,a,u){var y=n&K,_=cs(r);function O(){for(var N=-1,q=arguments.length,W=-1,Y=u.length,re=H(Y+q),ce=this&&this!==Qe&&this instanceof O?_:r;++W<Y;)re[W]=u[W];for(;q--;)re[W++]=arguments[++N];return Bt(ce,y?a:this,re)}return O}function gl(r){return function(n,a,u){return u&&typeof u!="number"&&nr(n,a,u)&&(a=u=t),n=yi(n),a===t?(a=n,n=0):a=yi(a),u=u===t?n<a?1:-1:yi(u),G0(n,a,u,r)}}function No(r){return function(n,a){return typeof n=="string"&&typeof a=="string"||(n=Mr(n),a=Mr(a)),r(n,a)}}function yl(r,n,a,u,y,_,O,N,q,W){var Y=n&L,re=Y?O:t,ce=Y?t:O,pe=Y?_:t,_e=Y?t:_;n|=Y?C:A,n&=~(Y?A:C),n&$||(n&=~(K|Z));var ze=[r,n,y,pe,re,_e,ce,N,q,W],we=a.apply(t,ze);return Tc(r)&&Ol(we,ze),we.placeholder=u,Cl(we,r,n)}function Sc(r){var n=zt[r];return function(a,u){if(a=Mr(a),u=u==null?0:Jt(Me(u),292),u&&Ch(a)){var y=(rt(a)+"e").split("e"),_=n(y[0]+"e"+(+y[1]+u));return y=(rt(_)+"e").split("e"),+(y[0]+"e"+(+y[1]-u))}return n(a)}}var uy=In&&1/ao(new In([,-0]))[1]==J?function(r){return new In(r)}:Vc;function vl(r){return function(n){var a=Qt(n);return a==Ee?ec(n):a==Ie?xg(n):mg(n,r(n))}}function fi(r,n,a,u,y,_,O,N){var q=n&Z;if(!q&&typeof r!="function")throw new Nr(l);var W=u?u.length:0;if(W||(n&=~(C|A),u=y=t),O=O===t?O:Ht(Me(O),0),N=N===t?N:Me(N),W-=y?y.length:0,n&A){var Y=u,re=y;u=y=t}var ce=q?t:Pc(r),pe=[r,n,a,u,y,Y,re,_,O,N];if(ce&&Sy(pe,ce),r=pe[0],n=pe[1],a=pe[2],u=pe[3],y=pe[4],N=pe[9]=pe[9]===t?q?0:r.length:Ht(pe[9]-W,0),!N&&n&(L|P)&&(n&=~(L|P)),!n||n==K)var _e=oy(r,n,a);else n==L||n==P?_e=ay(r,n,N):(n==C||n==(K|C))&&!y.length?_e=cy(r,n,a,u):_e=Ao.apply(t,pe);var ze=ce?Qh:Ol;return Cl(ze(_e,pe),r,n)}function ml(r,n,a,u){return r===t||kr(r,Sn[a])&&!it.call(u,a)?n:r}function _l(r,n,a,u,y,_){return bt(r)&&bt(n)&&(_.set(n,r),xo(r,n,t,_l,_),_.delete(n)),r}function hy(r){return ls(r)?t:r}function wl(r,n,a,u,y,_){var O=a&I,N=r.length,q=n.length;if(N!=q&&!(O&&q>N))return!1;var W=_.get(r),Y=_.get(n);if(W&&Y)return W==n&&Y==r;var re=-1,ce=!0,pe=a&B?new Ji:t;for(_.set(r,n),_.set(n,r);++re<N;){var _e=r[re],ze=n[re];if(u)var we=O?u(ze,_e,re,n,r,_):u(_e,ze,re,r,n,_);if(we!==t){if(we)continue;ce=!1;break}if(pe){if(!Wa(n,function(Ge,Xe){if(!Qn(pe,Xe)&&(_e===Ge||y(_e,Ge,a,u,_)))return pe.push(Xe)})){ce=!1;break}}else if(!(_e===ze||y(_e,ze,a,u,_))){ce=!1;break}}return _.delete(r),_.delete(n),ce}function ly(r,n,a,u,y,_,O){switch(a){case Oe:if(r.byteLength!=n.byteLength||r.byteOffset!=n.byteOffset)return!1;r=r.buffer,n=n.buffer;case be:return!(r.byteLength!=n.byteLength||!_(new po(r),new po(n)));case F:case U:case He:return kr(+r,+n);case T:return r.name==n.name&&r.message==n.message;case qe:case Ne:return r==n+"";case Ee:var N=ec;case Ie:var q=u&I;if(N||(N=ao),r.size!=n.size&&!q)return!1;var W=O.get(r);if(W)return W==n;u|=B,O.set(r,n);var Y=wl(N(r),N(n),u,y,_,O);return O.delete(r),Y;case $e:if(rs)return rs.call(r)==rs.call(n)}return!1}function fy(r,n,a,u,y,_){var O=a&I,N=Ic(r),q=N.length,W=Ic(n),Y=W.length;if(q!=Y&&!O)return!1;for(var re=q;re--;){var ce=N[re];if(!(O?ce in n:it.call(n,ce)))return!1}var pe=_.get(r),_e=_.get(n);if(pe&&_e)return pe==n&&_e==r;var ze=!0;_.set(r,n),_.set(n,r);for(var we=O;++re<q;){ce=N[re];var Ge=r[ce],Xe=n[ce];if(u)var Ir=O?u(Xe,Ge,ce,n,r,_):u(Ge,Xe,ce,r,n,_);if(!(Ir===t?Ge===Xe||y(Ge,Xe,a,u,_):Ir)){ze=!1;break}we||(we=ce=="constructor")}if(ze&&!we){var sr=r.constructor,xr=n.constructor;sr!=xr&&"constructor"in r&&"constructor"in n&&!(typeof sr=="function"&&sr instanceof sr&&typeof xr=="function"&&xr instanceof xr)&&(ze=!1)}return _.delete(r),_.delete(n),ze}function di(r){return Nc(xl(r,t,Ul),r+"")}function Ic(r){return Fh(r,Kt,Cc)}function xc(r){return Fh(r,pr,bl)}var Pc=wo?function(r){return wo.get(r)}:Vc;function $o(r){for(var n=r.name+"",a=xn[n],u=it.call(xn,n)?a.length:0;u--;){var y=a[u],_=y.func;if(_==null||_==r)return y.name}return n}function An(r){var n=it.call(m,"placeholder")?m:r;return n.placeholder}function me(){var r=m.iteratee||Kc;return r=r===Kc?Bh:r,arguments.length?r(arguments[0],arguments[1]):r}function Uo(r,n){var a=r.__data__;return wy(n)?a[typeof n=="string"?"string":"hash"]:a.map}function Oc(r){for(var n=Kt(r),a=n.length;a--;){var u=n[a],y=r[u];n[a]=[u,y,Sl(y)]}return n}function Zi(r,n){var a=Dg(r,n);return Hh(a)?a:t}function dy(r){var n=it.call(r,Wi),a=r[Wi];try{r[Wi]=t;var u=!0}catch{}var y=lo.call(r);return u&&(n?r[Wi]=a:delete r[Wi]),y}var Cc=rc?function(r){return r==null?[]:(r=ct(r),Oi(rc(r),function(n){return Ph.call(r,n)}))}:Gc,bl=rc?function(r){for(var n=[];r;)Ci(n,Cc(r)),r=go(r);return n}:Gc,Qt=ir;(ic&&Qt(new ic(new ArrayBuffer(1)))!=Oe||Zn&&Qt(new Zn)!=Ee||nc&&Qt(nc.resolve())!=dt||In&&Qt(new In)!=Ie||es&&Qt(new es)!=Pe)&&(Qt=function(r){var n=ir(r),a=n==Le?r.constructor:t,u=a?en(a):"";if(u)switch(u){case Yg:return Oe;case Jg:return Ee;case Qg:return dt;case Xg:return Ie;case Zg:return Pe}return n});function py(r,n,a){for(var u=-1,y=a.length;++u<y;){var _=a[u],O=_.size;switch(_.type){case"drop":r+=O;break;case"dropRight":n-=O;break;case"take":n=Jt(n,r+O);break;case"takeRight":r=Ht(r,n-O);break}}return{start:r,end:n}}function gy(r){var n=r.match(ut);return n?n[1].split(Lt):[]}function El(r,n,a){n=$i(n,r);for(var u=-1,y=n.length,_=!1;++u<y;){var O=ti(n[u]);if(!(_=r!=null&&a(r,O)))break;r=r[O]}return _||++u!=y?_:(y=r==null?0:r.length,!!y&&Ho(y)&&pi(O,y)&&(Re(r)||tn(r)))}function yy(r){var n=r.length,a=new r.constructor(n);return n&&typeof r[0]=="string"&&it.call(r,"index")&&(a.index=r.index,a.input=r.input),a}function Dl(r){return typeof r.constructor=="function"&&!us(r)?Pn(go(r)):{}}function vy(r,n,a){var u=r.constructor;switch(n){case be:return Ec(r);case F:case U:return new u(+r);case Oe:return ey(r,a);case Be:case xe:case Ve:case We:case Ze:case et:case Je:case er:case hr:return sl(r,a);case Ee:return new u;case He:case Ne:return new u(r);case qe:return ty(r);case Ie:return new u;case $e:return ry(r)}}function my(r,n){var a=n.length;if(!a)return r;var u=a-1;return n[u]=(a>1?"& ":"")+n[u],n=n.join(a>2?", ":" "),r.replace(Pt,`{
/* [wrapped with `+n+`] */
`)}function _y(r){return Re(r)||tn(r)||!!(Oh&&r&&r[Oh])}function pi(r,n){var a=typeof r;return n=n??k,!!n&&(a=="number"||a!="symbol"&&Ra.test(r))&&r>-1&&r%1==0&&r<n}function nr(r,n,a){if(!bt(a))return!1;var u=typeof n;return(u=="number"?dr(a)&&pi(n,a.length):u=="string"&&n in a)?kr(a[n],r):!1}function Ac(r,n){if(Re(r))return!1;var a=typeof r;return a=="number"||a=="symbol"||a=="boolean"||r==null||Sr(r)?!0:$t.test(r)||!yt.test(r)||n!=null&&r in ct(n)}function wy(r){var n=typeof r;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?r!=="__proto__":r===null}function Tc(r){var n=$o(r),a=m[n];if(typeof a!="function"||!(n in Ye.prototype))return!1;if(r===a)return!0;var u=Pc(a);return!!u&&r===u[0]}function by(r){return!!Sh&&Sh in r}var Ey=uo?gi:Wc;function us(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||Sn;return r===a}function Sl(r){return r===r&&!bt(r)}function Il(r,n){return function(a){return a==null?!1:a[r]===n&&(n!==t||r in ct(a))}}function Dy(r){var n=Fo(r,function(u){return a.size===p&&a.clear(),u}),a=n.cache;return n}function Sy(r,n){var a=r[1],u=n[1],y=a|u,_=y<(K|Z|h),O=u==h&&a==L||u==h&&a==b&&r[7].length<=n[8]||u==(h|b)&&n[7].length<=n[8]&&a==L;if(!(_||O))return r;u&K&&(r[2]=n[2],y|=a&K?0:$);var N=n[3];if(N){var q=r[3];r[3]=q?al(q,N,n[4]):N,r[4]=q?Ai(r[3],v):n[4]}return N=n[5],N&&(q=r[5],r[5]=q?cl(q,N,n[6]):N,r[6]=q?Ai(r[5],v):n[6]),N=n[7],N&&(r[7]=N),u&h&&(r[8]=r[8]==null?n[8]:Jt(r[8],n[8])),r[9]==null&&(r[9]=n[9]),r[0]=n[0],r[1]=y,r}function Iy(r){var n=[];if(r!=null)for(var a in ct(r))n.push(a);return n}function xy(r){return lo.call(r)}function xl(r,n,a){return n=Ht(n===t?r.length-1:n,0),function(){for(var u=arguments,y=-1,_=Ht(u.length-n,0),O=H(_);++y<_;)O[y]=u[n+y];y=-1;for(var N=H(n+1);++y<n;)N[y]=u[y];return N[n]=a(O),Bt(r,this,N)}}function Pl(r,n){return n.length<2?r:Xi(r,jr(n,0,-1))}function Py(r,n){for(var a=r.length,u=Jt(n.length,a),y=fr(r);u--;){var _=n[u];r[u]=pi(_,a)?y[_]:t}return r}function Rc(r,n){if(!(n==="constructor"&&typeof r[n]=="function")&&n!="__proto__")return r[n]}var Ol=Al(Qh),hs=Hg||function(r,n){return Qe.setTimeout(r,n)},Nc=Al(J0);function Cl(r,n,a){var u=n+"";return Nc(r,my(u,Oy(gy(u),a)))}function Al(r){var n=0,a=0;return function(){var u=Vg(),y=ye-(u-a);if(a=u,y>0){if(++n>=ge)return arguments[0]}else n=0;return r.apply(t,arguments)}}function jo(r,n){var a=-1,u=r.length,y=u-1;for(n=n===t?u:n;++a<n;){var _=gc(a,y),O=r[_];r[_]=r[a],r[a]=O}return r.length=n,r}var Tl=Dy(function(r){var n=[];return r.charCodeAt(0)===46&&n.push(""),r.replace(Ut,function(a,u,y,_){n.push(y?_.replace(xa,"$1"):u||a)}),n});function ti(r){if(typeof r=="string"||Sr(r))return r;var n=r+"";return n=="0"&&1/r==-J?"-0":n}function en(r){if(r!=null){try{return ho.call(r)}catch{}try{return r+""}catch{}}return""}function Oy(r,n){return Rr(Se,function(a){var u="_."+a[0];n&a[1]&&!so(r,u)&&r.push(u)}),r.sort()}function Rl(r){if(r instanceof Ye)return r.clone();var n=new $r(r.__wrapped__,r.__chain__);return n.__actions__=fr(r.__actions__),n.__index__=r.__index__,n.__values__=r.__values__,n}function Cy(r,n,a){(a?nr(r,n,a):n===t)?n=1:n=Ht(Me(n),0);var u=r==null?0:r.length;if(!u||n<1)return[];for(var y=0,_=0,O=H(mo(u/n));y<u;)O[_++]=jr(r,y,y+=n);return O}function Ay(r){for(var n=-1,a=r==null?0:r.length,u=0,y=[];++n<a;){var _=r[n];_&&(y[u++]=_)}return y}function Ty(){var r=arguments.length;if(!r)return[];for(var n=H(r-1),a=arguments[0],u=r;u--;)n[u-1]=arguments[u];return Ci(Re(a)?fr(a):[a],Gt(n,1))}var Ry=Ke(function(r,n){return Tt(r)?ns(r,Gt(n,1,Tt,!0)):[]}),Ny=Ke(function(r,n){var a=Lr(n);return Tt(a)&&(a=t),Tt(r)?ns(r,Gt(n,1,Tt,!0),me(a,2)):[]}),$y=Ke(function(r,n){var a=Lr(n);return Tt(a)&&(a=t),Tt(r)?ns(r,Gt(n,1,Tt,!0),t,a):[]});function Uy(r,n,a){var u=r==null?0:r.length;return u?(n=a||n===t?1:Me(n),jr(r,n<0?0:n,u)):[]}function jy(r,n,a){var u=r==null?0:r.length;return u?(n=a||n===t?1:Me(n),n=u-n,jr(r,0,n<0?0:n)):[]}function Ly(r,n){return r&&r.length?Oo(r,me(n,3),!0,!0):[]}function My(r,n){return r&&r.length?Oo(r,me(n,3),!0):[]}function qy(r,n,a,u){var y=r==null?0:r.length;return y?(a&&typeof a!="number"&&nr(r,n,a)&&(a=0,u=y),T0(r,n,a,u)):[]}function Nl(r,n,a){var u=r==null?0:r.length;if(!u)return-1;var y=a==null?0:Me(a);return y<0&&(y=Ht(u+y,0)),oo(r,me(n,3),y)}function $l(r,n,a){var u=r==null?0:r.length;if(!u)return-1;var y=u-1;return a!==t&&(y=Me(a),y=a<0?Ht(u+y,0):Jt(y,u-1)),oo(r,me(n,3),y,!0)}function Ul(r){var n=r==null?0:r.length;return n?Gt(r,1):[]}function Fy(r){var n=r==null?0:r.length;return n?Gt(r,J):[]}function zy(r,n){var a=r==null?0:r.length;return a?(n=n===t?1:Me(n),Gt(r,n)):[]}function Hy(r){for(var n=-1,a=r==null?0:r.length,u={};++n<a;){var y=r[n];u[y[0]]=y[1]}return u}function jl(r){return r&&r.length?r[0]:t}function By(r,n,a){var u=r==null?0:r.length;if(!u)return-1;var y=a==null?0:Me(a);return y<0&&(y=Ht(u+y,0)),wn(r,n,y)}function Ky(r){var n=r==null?0:r.length;return n?jr(r,0,-1):[]}var ky=Ke(function(r){var n=vt(r,wc);return n.length&&n[0]===r[0]?hc(n):[]}),Vy=Ke(function(r){var n=Lr(r),a=vt(r,wc);return n===Lr(a)?n=t:a.pop(),a.length&&a[0]===r[0]?hc(a,me(n,2)):[]}),Gy=Ke(function(r){var n=Lr(r),a=vt(r,wc);return n=typeof n=="function"?n:t,n&&a.pop(),a.length&&a[0]===r[0]?hc(a,t,n):[]});function Wy(r,n){return r==null?"":Kg.call(r,n)}function Lr(r){var n=r==null?0:r.length;return n?r[n-1]:t}function Yy(r,n,a){var u=r==null?0:r.length;if(!u)return-1;var y=u;return a!==t&&(y=Me(a),y=y<0?Ht(u+y,0):Jt(y,u-1)),n===n?Og(r,n,y):oo(r,yh,y,!0)}function Jy(r,n){return r&&r.length?Gh(r,Me(n)):t}var Qy=Ke(Ll);function Ll(r,n){return r&&r.length&&n&&n.length?pc(r,n):r}function Xy(r,n,a){return r&&r.length&&n&&n.length?pc(r,n,me(a,2)):r}function Zy(r,n,a){return r&&r.length&&n&&n.length?pc(r,n,t,a):r}var ev=di(function(r,n){var a=r==null?0:r.length,u=oc(r,n);return Jh(r,vt(n,function(y){return pi(y,a)?+y:y}).sort(ol)),u});function tv(r,n){var a=[];if(!(r&&r.length))return a;var u=-1,y=[],_=r.length;for(n=me(n,3);++u<_;){var O=r[u];n(O,u,r)&&(a.push(O),y.push(u))}return Jh(r,y),a}function $c(r){return r==null?r:Wg.call(r)}function rv(r,n,a){var u=r==null?0:r.length;return u?(a&&typeof a!="number"&&nr(r,n,a)?(n=0,a=u):(n=n==null?0:Me(n),a=a===t?u:Me(a)),jr(r,n,a)):[]}function iv(r,n){return Po(r,n)}function nv(r,n,a){return vc(r,n,me(a,2))}function sv(r,n){var a=r==null?0:r.length;if(a){var u=Po(r,n);if(u<a&&kr(r[u],n))return u}return-1}function ov(r,n){return Po(r,n,!0)}function av(r,n,a){return vc(r,n,me(a,2),!0)}function cv(r,n){var a=r==null?0:r.length;if(a){var u=Po(r,n,!0)-1;if(kr(r[u],n))return u}return-1}function uv(r){return r&&r.length?Xh(r):[]}function hv(r,n){return r&&r.length?Xh(r,me(n,2)):[]}function lv(r){var n=r==null?0:r.length;return n?jr(r,1,n):[]}function fv(r,n,a){return r&&r.length?(n=a||n===t?1:Me(n),jr(r,0,n<0?0:n)):[]}function dv(r,n,a){var u=r==null?0:r.length;return u?(n=a||n===t?1:Me(n),n=u-n,jr(r,n<0?0:n,u)):[]}function pv(r,n){return r&&r.length?Oo(r,me(n,3),!1,!0):[]}function gv(r,n){return r&&r.length?Oo(r,me(n,3)):[]}var yv=Ke(function(r){return Ni(Gt(r,1,Tt,!0))}),vv=Ke(function(r){var n=Lr(r);return Tt(n)&&(n=t),Ni(Gt(r,1,Tt,!0),me(n,2))}),mv=Ke(function(r){var n=Lr(r);return n=typeof n=="function"?n:t,Ni(Gt(r,1,Tt,!0),t,n)});function _v(r){return r&&r.length?Ni(r):[]}function wv(r,n){return r&&r.length?Ni(r,me(n,2)):[]}function bv(r,n){return n=typeof n=="function"?n:t,r&&r.length?Ni(r,t,n):[]}function Uc(r){if(!(r&&r.length))return[];var n=0;return r=Oi(r,function(a){if(Tt(a))return n=Ht(a.length,n),!0}),Xa(n,function(a){return vt(r,Ya(a))})}function Ml(r,n){if(!(r&&r.length))return[];var a=Uc(r);return n==null?a:vt(a,function(u){return Bt(n,t,u)})}var Ev=Ke(function(r,n){return Tt(r)?ns(r,n):[]}),Dv=Ke(function(r){return _c(Oi(r,Tt))}),Sv=Ke(function(r){var n=Lr(r);return Tt(n)&&(n=t),_c(Oi(r,Tt),me(n,2))}),Iv=Ke(function(r){var n=Lr(r);return n=typeof n=="function"?n:t,_c(Oi(r,Tt),t,n)}),xv=Ke(Uc);function Pv(r,n){return rl(r||[],n||[],is)}function Ov(r,n){return rl(r||[],n||[],as)}var Cv=Ke(function(r){var n=r.length,a=n>1?r[n-1]:t;return a=typeof a=="function"?(r.pop(),a):t,Ml(r,a)});function ql(r){var n=m(r);return n.__chain__=!0,n}function Av(r,n){return n(r),r}function Lo(r,n){return n(r)}var Tv=di(function(r){var n=r.length,a=n?r[0]:0,u=this.__wrapped__,y=function(_){return oc(_,r)};return n>1||this.__actions__.length||!(u instanceof Ye)||!pi(a)?this.thru(y):(u=u.slice(a,+a+(n?1:0)),u.__actions__.push({func:Lo,args:[y],thisArg:t}),new $r(u,this.__chain__).thru(function(_){return n&&!_.length&&_.push(t),_}))});function Rv(){return ql(this)}function Nv(){return new $r(this.value(),this.__chain__)}function $v(){this.__values__===t&&(this.__values__=Zl(this.value()));var r=this.__index__>=this.__values__.length,n=r?t:this.__values__[this.__index__++];return{done:r,value:n}}function Uv(){return this}function jv(r){for(var n,a=this;a instanceof Eo;){var u=Rl(a);u.__index__=0,u.__values__=t,n?y.__wrapped__=u:n=u;var y=u;a=a.__wrapped__}return y.__wrapped__=r,n}function Lv(){var r=this.__wrapped__;if(r instanceof Ye){var n=r;return this.__actions__.length&&(n=new Ye(this)),n=n.reverse(),n.__actions__.push({func:Lo,args:[$c],thisArg:t}),new $r(n,this.__chain__)}return this.thru($c)}function Mv(){return tl(this.__wrapped__,this.__actions__)}var qv=Co(function(r,n,a){it.call(r,a)?++r[a]:li(r,a,1)});function Fv(r,n,a){var u=Re(r)?ph:A0;return a&&nr(r,n,a)&&(n=t),u(r,me(n,3))}function zv(r,n){var a=Re(r)?Oi:Mh;return a(r,me(n,3))}var Hv=fl(Nl),Bv=fl($l);function Kv(r,n){return Gt(Mo(r,n),1)}function kv(r,n){return Gt(Mo(r,n),J)}function Vv(r,n,a){return a=a===t?1:Me(a),Gt(Mo(r,n),a)}function Fl(r,n){var a=Re(r)?Rr:Ri;return a(r,me(n,3))}function zl(r,n){var a=Re(r)?lg:Lh;return a(r,me(n,3))}var Gv=Co(function(r,n,a){it.call(r,a)?r[a].push(n):li(r,a,[n])});function Wv(r,n,a,u){r=dr(r)?r:Rn(r),a=a&&!u?Me(a):0;var y=r.length;return a<0&&(a=Ht(y+a,0)),Bo(r)?a<=y&&r.indexOf(n,a)>-1:!!y&&wn(r,n,a)>-1}var Yv=Ke(function(r,n,a){var u=-1,y=typeof n=="function",_=dr(r)?H(r.length):[];return Ri(r,function(O){_[++u]=y?Bt(n,O,a):ss(O,n,a)}),_}),Jv=Co(function(r,n,a){li(r,a,n)});function Mo(r,n){var a=Re(r)?vt:Kh;return a(r,me(n,3))}function Qv(r,n,a,u){return r==null?[]:(Re(n)||(n=n==null?[]:[n]),a=u?t:a,Re(a)||(a=a==null?[]:[a]),Wh(r,n,a))}var Xv=Co(function(r,n,a){r[a?0:1].push(n)},function(){return[[],[]]});function Zv(r,n,a){var u=Re(r)?Ga:mh,y=arguments.length<3;return u(r,me(n,4),a,y,Ri)}function em(r,n,a){var u=Re(r)?fg:mh,y=arguments.length<3;return u(r,me(n,4),a,y,Lh)}function tm(r,n){var a=Re(r)?Oi:Mh;return a(r,zo(me(n,3)))}function rm(r){var n=Re(r)?Nh:W0;return n(r)}function im(r,n,a){(a?nr(r,n,a):n===t)?n=1:n=Me(n);var u=Re(r)?I0:Y0;return u(r,n)}function nm(r){var n=Re(r)?x0:Q0;return n(r)}function sm(r){if(r==null)return 0;if(dr(r))return Bo(r)?En(r):r.length;var n=Qt(r);return n==Ee||n==Ie?r.size:fc(r).length}function om(r,n,a){var u=Re(r)?Wa:X0;return a&&nr(r,n,a)&&(n=t),u(r,me(n,3))}var am=Ke(function(r,n){if(r==null)return[];var a=n.length;return a>1&&nr(r,n[0],n[1])?n=[]:a>2&&nr(n[0],n[1],n[2])&&(n=[n[0]]),Wh(r,Gt(n,1),[])}),qo=zg||function(){return Qe.Date.now()};function cm(r,n){if(typeof n!="function")throw new Nr(l);return r=Me(r),function(){if(--r<1)return n.apply(this,arguments)}}function Hl(r,n,a){return n=a?t:n,n=r&&n==null?r.length:n,fi(r,h,t,t,t,t,n)}function Bl(r,n){var a;if(typeof n!="function")throw new Nr(l);return r=Me(r),function(){return--r>0&&(a=n.apply(this,arguments)),r<=1&&(n=t),a}}var jc=Ke(function(r,n,a){var u=K;if(a.length){var y=Ai(a,An(jc));u|=C}return fi(r,u,n,a,y)}),Kl=Ke(function(r,n,a){var u=K|Z;if(a.length){var y=Ai(a,An(Kl));u|=C}return fi(n,u,r,a,y)});function kl(r,n,a){n=a?t:n;var u=fi(r,L,t,t,t,t,t,n);return u.placeholder=kl.placeholder,u}function Vl(r,n,a){n=a?t:n;var u=fi(r,P,t,t,t,t,t,n);return u.placeholder=Vl.placeholder,u}function Gl(r,n,a){var u,y,_,O,N,q,W=0,Y=!1,re=!1,ce=!0;if(typeof r!="function")throw new Nr(l);n=Mr(n)||0,bt(a)&&(Y=!!a.leading,re="maxWait"in a,_=re?Ht(Mr(a.maxWait)||0,n):_,ce="trailing"in a?!!a.trailing:ce);function pe(Rt){var Vr=u,vi=y;return u=y=t,W=Rt,O=r.apply(vi,Vr),O}function _e(Rt){return W=Rt,N=hs(Ge,n),Y?pe(Rt):O}function ze(Rt){var Vr=Rt-q,vi=Rt-W,df=n-Vr;return re?Jt(df,_-vi):df}function we(Rt){var Vr=Rt-q,vi=Rt-W;return q===t||Vr>=n||Vr<0||re&&vi>=_}function Ge(){var Rt=qo();if(we(Rt))return Xe(Rt);N=hs(Ge,ze(Rt))}function Xe(Rt){return N=t,ce&&u?pe(Rt):(u=y=t,O)}function Ir(){N!==t&&il(N),W=0,u=q=y=N=t}function sr(){return N===t?O:Xe(qo())}function xr(){var Rt=qo(),Vr=we(Rt);if(u=arguments,y=this,q=Rt,Vr){if(N===t)return _e(q);if(re)return il(N),N=hs(Ge,n),pe(q)}return N===t&&(N=hs(Ge,n)),O}return xr.cancel=Ir,xr.flush=sr,xr}var um=Ke(function(r,n){return jh(r,1,n)}),hm=Ke(function(r,n,a){return jh(r,Mr(n)||0,a)});function lm(r){return fi(r,ee)}function Fo(r,n){if(typeof r!="function"||n!=null&&typeof n!="function")throw new Nr(l);var a=function(){var u=arguments,y=n?n.apply(this,u):u[0],_=a.cache;if(_.has(y))return _.get(y);var O=r.apply(this,u);return a.cache=_.set(y,O)||_,O};return a.cache=new(Fo.Cache||hi),a}Fo.Cache=hi;function zo(r){if(typeof r!="function")throw new Nr(l);return function(){var n=arguments;switch(n.length){case 0:return!r.call(this);case 1:return!r.call(this,n[0]);case 2:return!r.call(this,n[0],n[1]);case 3:return!r.call(this,n[0],n[1],n[2])}return!r.apply(this,n)}}function fm(r){return Bl(2,r)}var dm=Z0(function(r,n){n=n.length==1&&Re(n[0])?vt(n[0],Er(me())):vt(Gt(n,1),Er(me()));var a=n.length;return Ke(function(u){for(var y=-1,_=Jt(u.length,a);++y<_;)u[y]=n[y].call(this,u[y]);return Bt(r,this,u)})}),Lc=Ke(function(r,n){var a=Ai(n,An(Lc));return fi(r,C,t,n,a)}),Wl=Ke(function(r,n){var a=Ai(n,An(Wl));return fi(r,A,t,n,a)}),pm=di(function(r,n){return fi(r,b,t,t,t,n)});function gm(r,n){if(typeof r!="function")throw new Nr(l);return n=n===t?n:Me(n),Ke(r,n)}function ym(r,n){if(typeof r!="function")throw new Nr(l);return n=n==null?0:Ht(Me(n),0),Ke(function(a){var u=a[n],y=Ui(a,0,n);return u&&Ci(y,u),Bt(r,this,y)})}function vm(r,n,a){var u=!0,y=!0;if(typeof r!="function")throw new Nr(l);return bt(a)&&(u="leading"in a?!!a.leading:u,y="trailing"in a?!!a.trailing:y),Gl(r,n,{leading:u,maxWait:n,trailing:y})}function mm(r){return Hl(r,1)}function _m(r,n){return Lc(bc(n),r)}function wm(){if(!arguments.length)return[];var r=arguments[0];return Re(r)?r:[r]}function bm(r){return Ur(r,x)}function Em(r,n){return n=typeof n=="function"?n:t,Ur(r,x,n)}function Dm(r){return Ur(r,w|x)}function Sm(r,n){return n=typeof n=="function"?n:t,Ur(r,w|x,n)}function Im(r,n){return n==null||Uh(r,n,Kt(n))}function kr(r,n){return r===n||r!==r&&n!==n}var xm=No(uc),Pm=No(function(r,n){return r>=n}),tn=zh(function(){return arguments}())?zh:function(r){return Ot(r)&&it.call(r,"callee")&&!Ph.call(r,"callee")},Re=H.isArray,Om=rr?Er(rr):j0;function dr(r){return r!=null&&Ho(r.length)&&!gi(r)}function Tt(r){return Ot(r)&&dr(r)}function Cm(r){return r===!0||r===!1||Ot(r)&&ir(r)==F}var ji=Bg||Wc,Am=Hr?Er(Hr):L0;function Tm(r){return Ot(r)&&r.nodeType===1&&!ls(r)}function Rm(r){if(r==null)return!0;if(dr(r)&&(Re(r)||typeof r=="string"||typeof r.splice=="function"||ji(r)||Tn(r)||tn(r)))return!r.length;var n=Qt(r);if(n==Ee||n==Ie)return!r.size;if(us(r))return!fc(r).length;for(var a in r)if(it.call(r,a))return!1;return!0}function Nm(r,n){return os(r,n)}function $m(r,n,a){a=typeof a=="function"?a:t;var u=a?a(r,n):t;return u===t?os(r,n,t,a):!!u}function Mc(r){if(!Ot(r))return!1;var n=ir(r);return n==T||n==d||typeof r.message=="string"&&typeof r.name=="string"&&!ls(r)}function Um(r){return typeof r=="number"&&Ch(r)}function gi(r){if(!bt(r))return!1;var n=ir(r);return n==se||n==he||n==z||n==pt}function Yl(r){return typeof r=="number"&&r==Me(r)}function Ho(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=k}function bt(r){var n=typeof r;return r!=null&&(n=="object"||n=="function")}function Ot(r){return r!=null&&typeof r=="object"}var Jl=Tr?Er(Tr):q0;function jm(r,n){return r===n||lc(r,n,Oc(n))}function Lm(r,n,a){return a=typeof a=="function"?a:t,lc(r,n,Oc(n),a)}function Mm(r){return Ql(r)&&r!=+r}function qm(r){if(Ey(r))throw new Ce(c);return Hh(r)}function Fm(r){return r===null}function zm(r){return r==null}function Ql(r){return typeof r=="number"||Ot(r)&&ir(r)==He}function ls(r){if(!Ot(r)||ir(r)!=Le)return!1;var n=go(r);if(n===null)return!0;var a=it.call(n,"constructor")&&n.constructor;return typeof a=="function"&&a instanceof a&&ho.call(a)==Lg}var qc=Xr?Er(Xr):F0;function Hm(r){return Yl(r)&&r>=-k&&r<=k}var Xl=Jn?Er(Jn):z0;function Bo(r){return typeof r=="string"||!Re(r)&&Ot(r)&&ir(r)==Ne}function Sr(r){return typeof r=="symbol"||Ot(r)&&ir(r)==$e}var Tn=Gi?Er(Gi):H0;function Bm(r){return r===t}function Km(r){return Ot(r)&&Qt(r)==Pe}function km(r){return Ot(r)&&ir(r)==Ue}var Vm=No(dc),Gm=No(function(r,n){return r<=n});function Zl(r){if(!r)return[];if(dr(r))return Bo(r)?Br(r):fr(r);if(Xn&&r[Xn])return Ig(r[Xn]());var n=Qt(r),a=n==Ee?ec:n==Ie?ao:Rn;return a(r)}function yi(r){if(!r)return r===0?r:0;if(r=Mr(r),r===J||r===-J){var n=r<0?-1:1;return n*V}return r===r?r:0}function Me(r){var n=yi(r),a=n%1;return n===n?a?n-a:n:0}function ef(r){return r?Qi(Me(r),0,ie):0}function Mr(r){if(typeof r=="number")return r;if(Sr(r))return te;if(bt(r)){var n=typeof r.valueOf=="function"?r.valueOf():r;r=bt(n)?n+"":n}if(typeof r!="string")return r===0?r:+r;r=_h(r);var a=Ca.test(r);return a||Ta.test(r)?Te(r.slice(2),a?2:8):Oa.test(r)?te:+r}function tf(r){return ei(r,pr(r))}function Wm(r){return r?Qi(Me(r),-k,k):r===0?r:0}function rt(r){return r==null?"":Dr(r)}var Ym=On(function(r,n){if(us(n)||dr(n)){ei(n,Kt(n),r);return}for(var a in n)it.call(n,a)&&is(r,a,n[a])}),rf=On(function(r,n){ei(n,pr(n),r)}),Ko=On(function(r,n,a,u){ei(n,pr(n),r,u)}),Jm=On(function(r,n,a,u){ei(n,Kt(n),r,u)}),Qm=di(oc);function Xm(r,n){var a=Pn(r);return n==null?a:$h(a,n)}var Zm=Ke(function(r,n){r=ct(r);var a=-1,u=n.length,y=u>2?n[2]:t;for(y&&nr(n[0],n[1],y)&&(u=1);++a<u;)for(var _=n[a],O=pr(_),N=-1,q=O.length;++N<q;){var W=O[N],Y=r[W];(Y===t||kr(Y,Sn[W])&&!it.call(r,W))&&(r[W]=_[W])}return r}),e_=Ke(function(r){return r.push(t,_l),Bt(nf,t,r)});function t_(r,n){return gh(r,me(n,3),Zr)}function r_(r,n){return gh(r,me(n,3),cc)}function i_(r,n){return r==null?r:ac(r,me(n,3),pr)}function n_(r,n){return r==null?r:qh(r,me(n,3),pr)}function s_(r,n){return r&&Zr(r,me(n,3))}function o_(r,n){return r&&cc(r,me(n,3))}function a_(r){return r==null?[]:Io(r,Kt(r))}function c_(r){return r==null?[]:Io(r,pr(r))}function Fc(r,n,a){var u=r==null?t:Xi(r,n);return u===t?a:u}function u_(r,n){return r!=null&&El(r,n,R0)}function zc(r,n){return r!=null&&El(r,n,N0)}var h_=pl(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=lo.call(n)),r[n]=a},Bc(gr)),l_=pl(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=lo.call(n)),it.call(r,n)?r[n].push(a):r[n]=[a]},me),f_=Ke(ss);function Kt(r){return dr(r)?Rh(r):fc(r)}function pr(r){return dr(r)?Rh(r,!0):B0(r)}function d_(r,n){var a={};return n=me(n,3),Zr(r,function(u,y,_){li(a,n(u,y,_),u)}),a}function p_(r,n){var a={};return n=me(n,3),Zr(r,function(u,y,_){li(a,y,n(u,y,_))}),a}var g_=On(function(r,n,a){xo(r,n,a)}),nf=On(function(r,n,a,u){xo(r,n,a,u)}),y_=di(function(r,n){var a={};if(r==null)return a;var u=!1;n=vt(n,function(_){return _=$i(_,r),u||(u=_.length>1),_}),ei(r,xc(r),a),u&&(a=Ur(a,w|E|x,hy));for(var y=n.length;y--;)mc(a,n[y]);return a});function v_(r,n){return sf(r,zo(me(n)))}var m_=di(function(r,n){return r==null?{}:k0(r,n)});function sf(r,n){if(r==null)return{};var a=vt(xc(r),function(u){return[u]});return n=me(n),Yh(r,a,function(u,y){return n(u,y[0])})}function __(r,n,a){n=$i(n,r);var u=-1,y=n.length;for(y||(y=1,r=t);++u<y;){var _=r==null?t:r[ti(n[u])];_===t&&(u=y,_=a),r=gi(_)?_.call(r):_}return r}function w_(r,n,a){return r==null?r:as(r,n,a)}function b_(r,n,a,u){return u=typeof u=="function"?u:t,r==null?r:as(r,n,a,u)}var of=vl(Kt),af=vl(pr);function E_(r,n,a){var u=Re(r),y=u||ji(r)||Tn(r);if(n=me(n,4),a==null){var _=r&&r.constructor;y?a=u?new _:[]:bt(r)?a=gi(_)?Pn(go(r)):{}:a={}}return(y?Rr:Zr)(r,function(O,N,q){return n(a,O,N,q)}),a}function D_(r,n){return r==null?!0:mc(r,n)}function S_(r,n,a){return r==null?r:el(r,n,bc(a))}function I_(r,n,a,u){return u=typeof u=="function"?u:t,r==null?r:el(r,n,bc(a),u)}function Rn(r){return r==null?[]:Za(r,Kt(r))}function x_(r){return r==null?[]:Za(r,pr(r))}function P_(r,n,a){return a===t&&(a=n,n=t),a!==t&&(a=Mr(a),a=a===a?a:0),n!==t&&(n=Mr(n),n=n===n?n:0),Qi(Mr(r),n,a)}function O_(r,n,a){return n=yi(n),a===t?(a=n,n=0):a=yi(a),r=Mr(r),$0(r,n,a)}function C_(r,n,a){if(a&&typeof a!="boolean"&&nr(r,n,a)&&(n=a=t),a===t&&(typeof n=="boolean"?(a=n,n=t):typeof r=="boolean"&&(a=r,r=t)),r===t&&n===t?(r=0,n=1):(r=yi(r),n===t?(n=r,r=0):n=yi(n)),r>n){var u=r;r=n,n=u}if(a||r%1||n%1){var y=Ah();return Jt(r+y*(n-r+ot("1e-"+((y+"").length-1))),n)}return gc(r,n)}var A_=Cn(function(r,n,a){return n=n.toLowerCase(),r+(a?cf(n):n)});function cf(r){return Hc(rt(r).toLowerCase())}function uf(r){return r=rt(r),r&&r.replace(ai,wg).replace(Ka,"")}function T_(r,n,a){r=rt(r),n=Dr(n);var u=r.length;a=a===t?u:Qi(Me(a),0,u);var y=a;return a-=n.length,a>=0&&r.slice(a,y)==n}function R_(r){return r=rt(r),r&&gt.test(r)?r.replace(Hi,bg):r}function N_(r){return r=rt(r),r&&jt.test(r)?r.replace(It,"\\$&"):r}var $_=Cn(function(r,n,a){return r+(a?"-":"")+n.toLowerCase()}),U_=Cn(function(r,n,a){return r+(a?" ":"")+n.toLowerCase()}),j_=ll("toLowerCase");function L_(r,n,a){r=rt(r),n=Me(n);var u=n?En(r):0;if(!n||u>=n)return r;var y=(n-u)/2;return Ro(_o(y),a)+r+Ro(mo(y),a)}function M_(r,n,a){r=rt(r),n=Me(n);var u=n?En(r):0;return n&&u<n?r+Ro(n-u,a):r}function q_(r,n,a){r=rt(r),n=Me(n);var u=n?En(r):0;return n&&u<n?Ro(n-u,a)+r:r}function F_(r,n,a){return a||n==null?n=0:n&&(n=+n),Gg(rt(r).replace(xt,""),n||0)}function z_(r,n,a){return(a?nr(r,n,a):n===t)?n=1:n=Me(n),yc(rt(r),n)}function H_(){var r=arguments,n=rt(r[0]);return r.length<3?n:n.replace(r[1],r[2])}var B_=Cn(function(r,n,a){return r+(a?"_":"")+n.toLowerCase()});function K_(r,n,a){return a&&typeof a!="number"&&nr(r,n,a)&&(n=a=t),a=a===t?ie:a>>>0,a?(r=rt(r),r&&(typeof n=="string"||n!=null&&!qc(n))&&(n=Dr(n),!n&&bn(r))?Ui(Br(r),0,a):r.split(n,a)):[]}var k_=Cn(function(r,n,a){return r+(a?" ":"")+Hc(n)});function V_(r,n,a){return r=rt(r),a=a==null?0:Qi(Me(a),0,r.length),n=Dr(n),r.slice(a,a+n.length)==n}function G_(r,n,a){var u=m.templateSettings;a&&nr(r,n,a)&&(n=t),r=rt(r),n=Ko({},n,u,ml);var y=Ko({},n.imports,u.imports,ml),_=Kt(y),O=Za(y,_),N,q,W=0,Y=n.interpolate||dn,re="__p += '",ce=tc((n.escape||dn).source+"|"+Y.source+"|"+(Y===wt?Pa:dn).source+"|"+(n.evaluate||dn).source+"|$","g"),pe="//# sourceURL="+(it.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ka+"]")+`
`;r.replace(ce,function(we,Ge,Xe,Ir,sr,xr){return Xe||(Xe=Ir),re+=r.slice(W,xr).replace(Na,Eg),Ge&&(N=!0,re+=`' +
__e(`+Ge+`) +
'`),sr&&(q=!0,re+=`';
`+sr+`;
__p += '`),Xe&&(re+=`' +
((__t = (`+Xe+`)) == null ? '' : __t) +
'`),W=xr+we.length,we}),re+=`';
`;var _e=it.call(n,"variable")&&n.variable;if(!_e)re=`with (obj) {
`+re+`
}
`;else if(Ia.test(_e))throw new Ce(f);re=(q?re.replace(Jr,""):re).replace(tr,"$1").replace(oi,"$1;"),re="function("+(_e||"obj")+`) {
`+(_e?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(N?", __e = _.escape":"")+(q?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+re+`return __p
}`;var ze=lf(function(){return tt(_,pe+"return "+re).apply(t,O)});if(ze.source=re,Mc(ze))throw ze;return ze}function W_(r){return rt(r).toLowerCase()}function Y_(r){return rt(r).toUpperCase()}function J_(r,n,a){if(r=rt(r),r&&(a||n===t))return _h(r);if(!r||!(n=Dr(n)))return r;var u=Br(r),y=Br(n),_=wh(u,y),O=bh(u,y)+1;return Ui(u,_,O).join("")}function Q_(r,n,a){if(r=rt(r),r&&(a||n===t))return r.slice(0,Dh(r)+1);if(!r||!(n=Dr(n)))return r;var u=Br(r),y=bh(u,Br(n))+1;return Ui(u,0,y).join("")}function X_(r,n,a){if(r=rt(r),r&&(a||n===t))return r.replace(xt,"");if(!r||!(n=Dr(n)))return r;var u=Br(r),y=wh(u,Br(n));return Ui(u,y).join("")}function Z_(r,n){var a=ne,u=ue;if(bt(n)){var y="separator"in n?n.separator:y;a="length"in n?Me(n.length):a,u="omission"in n?Dr(n.omission):u}r=rt(r);var _=r.length;if(bn(r)){var O=Br(r);_=O.length}if(a>=_)return r;var N=a-En(u);if(N<1)return u;var q=O?Ui(O,0,N).join(""):r.slice(0,N);if(y===t)return q+u;if(O&&(N+=q.length-N),qc(y)){if(r.slice(N).search(y)){var W,Y=q;for(y.global||(y=tc(y.source,rt(Ar.exec(y))+"g")),y.lastIndex=0;W=y.exec(Y);)var re=W.index;q=q.slice(0,re===t?N:re)}}else if(r.indexOf(Dr(y),N)!=N){var ce=q.lastIndexOf(y);ce>-1&&(q=q.slice(0,ce))}return q+u}function ew(r){return r=rt(r),r&&Et.test(r)?r.replace(xi,Cg):r}var tw=Cn(function(r,n,a){return r+(a?" ":"")+n.toUpperCase()}),Hc=ll("toUpperCase");function hf(r,n,a){return r=rt(r),n=a?t:n,n===t?Sg(r)?Rg(r):gg(r):r.match(n)||[]}var lf=Ke(function(r,n){try{return Bt(r,t,n)}catch(a){return Mc(a)?a:new Ce(a)}}),rw=di(function(r,n){return Rr(n,function(a){a=ti(a),li(r,a,jc(r[a],r))}),r});function iw(r){var n=r==null?0:r.length,a=me();return r=n?vt(r,function(u){if(typeof u[1]!="function")throw new Nr(l);return[a(u[0]),u[1]]}):[],Ke(function(u){for(var y=-1;++y<n;){var _=r[y];if(Bt(_[0],this,u))return Bt(_[1],this,u)}})}function nw(r){return C0(Ur(r,w))}function Bc(r){return function(){return r}}function sw(r,n){return r==null||r!==r?n:r}var ow=dl(),aw=dl(!0);function gr(r){return r}function Kc(r){return Bh(typeof r=="function"?r:Ur(r,w))}function cw(r){return kh(Ur(r,w))}function uw(r,n){return Vh(r,Ur(n,w))}var hw=Ke(function(r,n){return function(a){return ss(a,r,n)}}),lw=Ke(function(r,n){return function(a){return ss(r,a,n)}});function kc(r,n,a){var u=Kt(n),y=Io(n,u);a==null&&!(bt(n)&&(y.length||!u.length))&&(a=n,n=r,r=this,y=Io(n,Kt(n)));var _=!(bt(a)&&"chain"in a)||!!a.chain,O=gi(r);return Rr(y,function(N){var q=n[N];r[N]=q,O&&(r.prototype[N]=function(){var W=this.__chain__;if(_||W){var Y=r(this.__wrapped__),re=Y.__actions__=fr(this.__actions__);return re.push({func:q,args:arguments,thisArg:r}),Y.__chain__=W,Y}return q.apply(r,Ci([this.value()],arguments))})}),r}function fw(){return Qe._===this&&(Qe._=Mg),this}function Vc(){}function dw(r){return r=Me(r),Ke(function(n){return Gh(n,r)})}var pw=Dc(vt),gw=Dc(ph),yw=Dc(Wa);function ff(r){return Ac(r)?Ya(ti(r)):V0(r)}function vw(r){return function(n){return r==null?t:Xi(r,n)}}var mw=gl(),_w=gl(!0);function Gc(){return[]}function Wc(){return!1}function ww(){return{}}function bw(){return""}function Ew(){return!0}function Dw(r,n){if(r=Me(r),r<1||r>k)return[];var a=ie,u=Jt(r,ie);n=me(n),r-=ie;for(var y=Xa(u,n);++a<r;)n(a);return y}function Sw(r){return Re(r)?vt(r,ti):Sr(r)?[r]:fr(Tl(rt(r)))}function Iw(r){var n=++jg;return rt(r)+n}var xw=To(function(r,n){return r+n},0),Pw=Sc("ceil"),Ow=To(function(r,n){return r/n},1),Cw=Sc("floor");function Aw(r){return r&&r.length?So(r,gr,uc):t}function Tw(r,n){return r&&r.length?So(r,me(n,2),uc):t}function Rw(r){return vh(r,gr)}function Nw(r,n){return vh(r,me(n,2))}function $w(r){return r&&r.length?So(r,gr,dc):t}function Uw(r,n){return r&&r.length?So(r,me(n,2),dc):t}var jw=To(function(r,n){return r*n},1),Lw=Sc("round"),Mw=To(function(r,n){return r-n},0);function qw(r){return r&&r.length?Qa(r,gr):0}function Fw(r,n){return r&&r.length?Qa(r,me(n,2)):0}return m.after=cm,m.ary=Hl,m.assign=Ym,m.assignIn=rf,m.assignInWith=Ko,m.assignWith=Jm,m.at=Qm,m.before=Bl,m.bind=jc,m.bindAll=rw,m.bindKey=Kl,m.castArray=wm,m.chain=ql,m.chunk=Cy,m.compact=Ay,m.concat=Ty,m.cond=iw,m.conforms=nw,m.constant=Bc,m.countBy=qv,m.create=Xm,m.curry=kl,m.curryRight=Vl,m.debounce=Gl,m.defaults=Zm,m.defaultsDeep=e_,m.defer=um,m.delay=hm,m.difference=Ry,m.differenceBy=Ny,m.differenceWith=$y,m.drop=Uy,m.dropRight=jy,m.dropRightWhile=Ly,m.dropWhile=My,m.fill=qy,m.filter=zv,m.flatMap=Kv,m.flatMapDeep=kv,m.flatMapDepth=Vv,m.flatten=Ul,m.flattenDeep=Fy,m.flattenDepth=zy,m.flip=lm,m.flow=ow,m.flowRight=aw,m.fromPairs=Hy,m.functions=a_,m.functionsIn=c_,m.groupBy=Gv,m.initial=Ky,m.intersection=ky,m.intersectionBy=Vy,m.intersectionWith=Gy,m.invert=h_,m.invertBy=l_,m.invokeMap=Yv,m.iteratee=Kc,m.keyBy=Jv,m.keys=Kt,m.keysIn=pr,m.map=Mo,m.mapKeys=d_,m.mapValues=p_,m.matches=cw,m.matchesProperty=uw,m.memoize=Fo,m.merge=g_,m.mergeWith=nf,m.method=hw,m.methodOf=lw,m.mixin=kc,m.negate=zo,m.nthArg=dw,m.omit=y_,m.omitBy=v_,m.once=fm,m.orderBy=Qv,m.over=pw,m.overArgs=dm,m.overEvery=gw,m.overSome=yw,m.partial=Lc,m.partialRight=Wl,m.partition=Xv,m.pick=m_,m.pickBy=sf,m.property=ff,m.propertyOf=vw,m.pull=Qy,m.pullAll=Ll,m.pullAllBy=Xy,m.pullAllWith=Zy,m.pullAt=ev,m.range=mw,m.rangeRight=_w,m.rearg=pm,m.reject=tm,m.remove=tv,m.rest=gm,m.reverse=$c,m.sampleSize=im,m.set=w_,m.setWith=b_,m.shuffle=nm,m.slice=rv,m.sortBy=am,m.sortedUniq=uv,m.sortedUniqBy=hv,m.split=K_,m.spread=ym,m.tail=lv,m.take=fv,m.takeRight=dv,m.takeRightWhile=pv,m.takeWhile=gv,m.tap=Av,m.throttle=vm,m.thru=Lo,m.toArray=Zl,m.toPairs=of,m.toPairsIn=af,m.toPath=Sw,m.toPlainObject=tf,m.transform=E_,m.unary=mm,m.union=yv,m.unionBy=vv,m.unionWith=mv,m.uniq=_v,m.uniqBy=wv,m.uniqWith=bv,m.unset=D_,m.unzip=Uc,m.unzipWith=Ml,m.update=S_,m.updateWith=I_,m.values=Rn,m.valuesIn=x_,m.without=Ev,m.words=hf,m.wrap=_m,m.xor=Dv,m.xorBy=Sv,m.xorWith=Iv,m.zip=xv,m.zipObject=Pv,m.zipObjectDeep=Ov,m.zipWith=Cv,m.entries=of,m.entriesIn=af,m.extend=rf,m.extendWith=Ko,kc(m,m),m.add=xw,m.attempt=lf,m.camelCase=A_,m.capitalize=cf,m.ceil=Pw,m.clamp=P_,m.clone=bm,m.cloneDeep=Dm,m.cloneDeepWith=Sm,m.cloneWith=Em,m.conformsTo=Im,m.deburr=uf,m.defaultTo=sw,m.divide=Ow,m.endsWith=T_,m.eq=kr,m.escape=R_,m.escapeRegExp=N_,m.every=Fv,m.find=Hv,m.findIndex=Nl,m.findKey=t_,m.findLast=Bv,m.findLastIndex=$l,m.findLastKey=r_,m.floor=Cw,m.forEach=Fl,m.forEachRight=zl,m.forIn=i_,m.forInRight=n_,m.forOwn=s_,m.forOwnRight=o_,m.get=Fc,m.gt=xm,m.gte=Pm,m.has=u_,m.hasIn=zc,m.head=jl,m.identity=gr,m.includes=Wv,m.indexOf=By,m.inRange=O_,m.invoke=f_,m.isArguments=tn,m.isArray=Re,m.isArrayBuffer=Om,m.isArrayLike=dr,m.isArrayLikeObject=Tt,m.isBoolean=Cm,m.isBuffer=ji,m.isDate=Am,m.isElement=Tm,m.isEmpty=Rm,m.isEqual=Nm,m.isEqualWith=$m,m.isError=Mc,m.isFinite=Um,m.isFunction=gi,m.isInteger=Yl,m.isLength=Ho,m.isMap=Jl,m.isMatch=jm,m.isMatchWith=Lm,m.isNaN=Mm,m.isNative=qm,m.isNil=zm,m.isNull=Fm,m.isNumber=Ql,m.isObject=bt,m.isObjectLike=Ot,m.isPlainObject=ls,m.isRegExp=qc,m.isSafeInteger=Hm,m.isSet=Xl,m.isString=Bo,m.isSymbol=Sr,m.isTypedArray=Tn,m.isUndefined=Bm,m.isWeakMap=Km,m.isWeakSet=km,m.join=Wy,m.kebabCase=$_,m.last=Lr,m.lastIndexOf=Yy,m.lowerCase=U_,m.lowerFirst=j_,m.lt=Vm,m.lte=Gm,m.max=Aw,m.maxBy=Tw,m.mean=Rw,m.meanBy=Nw,m.min=$w,m.minBy=Uw,m.stubArray=Gc,m.stubFalse=Wc,m.stubObject=ww,m.stubString=bw,m.stubTrue=Ew,m.multiply=jw,m.nth=Jy,m.noConflict=fw,m.noop=Vc,m.now=qo,m.pad=L_,m.padEnd=M_,m.padStart=q_,m.parseInt=F_,m.random=C_,m.reduce=Zv,m.reduceRight=em,m.repeat=z_,m.replace=H_,m.result=__,m.round=Lw,m.runInContext=M,m.sample=rm,m.size=sm,m.snakeCase=B_,m.some=om,m.sortedIndex=iv,m.sortedIndexBy=nv,m.sortedIndexOf=sv,m.sortedLastIndex=ov,m.sortedLastIndexBy=av,m.sortedLastIndexOf=cv,m.startCase=k_,m.startsWith=V_,m.subtract=Mw,m.sum=qw,m.sumBy=Fw,m.template=G_,m.times=Dw,m.toFinite=yi,m.toInteger=Me,m.toLength=ef,m.toLower=W_,m.toNumber=Mr,m.toSafeInteger=Wm,m.toString=rt,m.toUpper=Y_,m.trim=J_,m.trimEnd=Q_,m.trimStart=X_,m.truncate=Z_,m.unescape=ew,m.uniqueId=Iw,m.upperCase=tw,m.upperFirst=Hc,m.each=Fl,m.eachRight=zl,m.first=jl,kc(m,function(){var r={};return Zr(m,function(n,a){it.call(m.prototype,a)||(r[a]=n)}),r}(),{chain:!1}),m.VERSION=s,Rr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){m[r].placeholder=m}),Rr(["drop","take"],function(r,n){Ye.prototype[r]=function(a){a=a===t?1:Ht(Me(a),0);var u=this.__filtered__&&!n?new Ye(this):this.clone();return u.__filtered__?u.__takeCount__=Jt(a,u.__takeCount__):u.__views__.push({size:Jt(a,ie),type:r+(u.__dir__<0?"Right":"")}),u},Ye.prototype[r+"Right"]=function(a){return this.reverse()[r](a).reverse()}}),Rr(["filter","map","takeWhile"],function(r,n){var a=n+1,u=a==S||a==X;Ye.prototype[r]=function(y){var _=this.clone();return _.__iteratees__.push({iteratee:me(y,3),type:a}),_.__filtered__=_.__filtered__||u,_}}),Rr(["head","last"],function(r,n){var a="take"+(n?"Right":"");Ye.prototype[r]=function(){return this[a](1).value()[0]}}),Rr(["initial","tail"],function(r,n){var a="drop"+(n?"":"Right");Ye.prototype[r]=function(){return this.__filtered__?new Ye(this):this[a](1)}}),Ye.prototype.compact=function(){return this.filter(gr)},Ye.prototype.find=function(r){return this.filter(r).head()},Ye.prototype.findLast=function(r){return this.reverse().find(r)},Ye.prototype.invokeMap=Ke(function(r,n){return typeof r=="function"?new Ye(this):this.map(function(a){return ss(a,r,n)})}),Ye.prototype.reject=function(r){return this.filter(zo(me(r)))},Ye.prototype.slice=function(r,n){r=Me(r);var a=this;return a.__filtered__&&(r>0||n<0)?new Ye(a):(r<0?a=a.takeRight(-r):r&&(a=a.drop(r)),n!==t&&(n=Me(n),a=n<0?a.dropRight(-n):a.take(n-r)),a)},Ye.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},Ye.prototype.toArray=function(){return this.take(ie)},Zr(Ye.prototype,function(r,n){var a=/^(?:filter|find|map|reject)|While$/.test(n),u=/^(?:head|last)$/.test(n),y=m[u?"take"+(n=="last"?"Right":""):n],_=u||/^find/.test(n);y&&(m.prototype[n]=function(){var O=this.__wrapped__,N=u?[1]:arguments,q=O instanceof Ye,W=N[0],Y=q||Re(O),re=function(Ge){var Xe=y.apply(m,Ci([Ge],N));return u&&ce?Xe[0]:Xe};Y&&a&&typeof W=="function"&&W.length!=1&&(q=Y=!1);var ce=this.__chain__,pe=!!this.__actions__.length,_e=_&&!ce,ze=q&&!pe;if(!_&&Y){O=ze?O:new Ye(this);var we=r.apply(O,N);return we.__actions__.push({func:Lo,args:[re],thisArg:t}),new $r(we,ce)}return _e&&ze?r.apply(this,N):(we=this.thru(re),_e?u?we.value()[0]:we.value():we)})}),Rr(["pop","push","shift","sort","splice","unshift"],function(r){var n=co[r],a=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",u=/^(?:pop|shift)$/.test(r);m.prototype[r]=function(){var y=arguments;if(u&&!this.__chain__){var _=this.value();return n.apply(Re(_)?_:[],y)}return this[a](function(O){return n.apply(Re(O)?O:[],y)})}}),Zr(Ye.prototype,function(r,n){var a=m[n];if(a){var u=a.name+"";it.call(xn,u)||(xn[u]=[]),xn[u].push({name:n,func:a})}}),xn[Ao(t,Z).name]=[{name:"wrapper",func:t}],Ye.prototype.clone=e0,Ye.prototype.reverse=t0,Ye.prototype.value=r0,m.prototype.at=Tv,m.prototype.chain=Rv,m.prototype.commit=Nv,m.prototype.next=$v,m.prototype.plant=jv,m.prototype.reverse=Lv,m.prototype.toJSON=m.prototype.valueOf=m.prototype.value=Mv,m.prototype.first=m.prototype.head,Xn&&(m.prototype[Xn]=Uv),m},Dn=Ng();At?((At.exports=Dn)._=Dn,at._=Dn):Qe._=Dn}).call(ms)})(Bu,Bu.exports);var T5=Object.defineProperty,R5=Object.defineProperties,N5=Object.getOwnPropertyDescriptors,Md=Object.getOwnPropertySymbols,$5=Object.prototype.hasOwnProperty,U5=Object.prototype.propertyIsEnumerable,qd=(i,e,t)=>e in i?T5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Jo=(i,e)=>{for(var t in e||(e={}))$5.call(e,t)&&qd(i,t,e[t]);if(Md)for(var t of Md(e))U5.call(e,t)&&qd(i,t,e[t]);return i},j5=(i,e)=>R5(i,N5(e));function qi(i,e,t){var s;const o=wE(i);return((s=e.rpcMap)==null?void 0:s[o.reference])||`${A5}?chainId=${o.namespace}:${o.reference}&projectId=${t}`}function fn(i){return i.includes(":")?i.split(":")[1]:i}function cg(i){return i.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function L5(i,e){const t=Object.keys(e.namespaces).filter(o=>o.includes(i));if(!t.length)return[];const s=[];return t.forEach(o=>{const c=e.namespaces[o].accounts;s.push(...c)}),s}function Fd(i={},e={}){const t=zd(i),s=zd(e);return Bu.exports.merge(t,s)}function zd(i){var e,t,s,o;const c={};if(!xs(i))return c;for(const[l,f]of Object.entries(i)){const g=ih(l)?[l]:f.chains,p=f.methods||[],v=f.events||[],w=f.rpcMap||{},E=_s(l);c[E]=j5(Jo(Jo({},c[E]),f),{chains:eu(g,(e=c[E])==null?void 0:e.chains),methods:eu(p,(t=c[E])==null?void 0:t.methods),events:eu(v,(s=c[E])==null?void 0:s.events),rpcMap:Jo(Jo({},w),(o=c[E])==null?void 0:o.rpcMap)})}return c}function M5(i){return i.includes(":")?i.split(":")[2]:i}function q5(i){const e={};for(const[t,s]of Object.entries(i)){const o=s.methods||[],c=s.events||[],l=s.accounts||[],f=ih(t)?[t]:s.chains?s.chains:cg(s.accounts);e[t]={chains:f,methods:o,events:c,accounts:l}}return e}function du(i){return typeof i=="number"?i:i.includes("0x")?parseInt(i,16):(i=i.includes(":")?i.split(":")[1]:i,isNaN(Number(i))?i:Number(i))}const ug={},_t=i=>ug[i],pu=(i,e)=>{ug[i]=e};class F5{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=_t("events"),this.client=_t("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=fn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||qi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Si(new zi(s,_t("disableProviderPing")))}}class z5{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=_t("events"),this.client=_t("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const s=t||qi(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Si(new zi(s,_t("disableProviderPing")))}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=parseInt(fn(t));e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,s;let o=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class H5{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=_t("events"),this.client=_t("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=fn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||qi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Si(new zi(s,_t("disableProviderPing")))}}class B5{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=_t("events"),this.client=_t("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=fn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||qi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Si(new zi(s,_t("disableProviderPing")))}}class K5{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=_t("events"),this.client=_t("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const s=this.getCardanoRPCUrl(t),o=fn(t);e[o]=this.createHttpProvider(o,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Si(new zi(s,_t("disableProviderPing")))}}class k5{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=_t("events"),this.client=_t("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=fn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||qi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Si(new zi(s,_t("disableProviderPing")))}}class V5{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=_t("events"),this.client=_t("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=fn(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||qi(e,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);return new Si(new zi(s,_t("disableProviderPing")))}}class G5{constructor(e){this.name="near",this.namespace=e.namespace,this.events=_t("events"),this.client=_t("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||qi(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Ii.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||qi(e,this.namespace);return typeof s>"u"?void 0:new Si(new zi(s,_t("disableProviderPing")))}}var W5=Object.defineProperty,Y5=Object.defineProperties,J5=Object.getOwnPropertyDescriptors,Hd=Object.getOwnPropertySymbols,Q5=Object.prototype.hasOwnProperty,X5=Object.prototype.propertyIsEnumerable,Bd=(i,e,t)=>e in i?W5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Qo=(i,e)=>{for(var t in e||(e={}))Q5.call(e,t)&&Bd(i,t,e[t]);if(Hd)for(var t of Hd(e))X5.call(e,t)&&Bd(i,t,e[t]);return i},gu=(i,e)=>Y5(i,J5(e));class fh{constructor(e){this.events=new Vu,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:ma(_a({level:(e==null?void 0:e.logger)||jd})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new fh(e);return await t.initialize(),t}async request(e,t,s){const[o,c]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(o).request({request:Qo({},e),chainId:`${o}:${c}`,topic:this.session.topic,expiry:s})}sendAsync(e,t,s,o){const c=new Date().getTime();this.request(e,s,o).then(l=>t(null,wa(c,l))).catch(l=>t(l,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:mt("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(c=>{this.session=c;const l=q5(c.namespaces);this.namespaces=Fd(this.namespaces,l),this.persist("namespaces",this.namespaces)}).catch(c=>{if(c.message!==og)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[s,o]=this.validateChain(e);this.getProvider(s).setDefaultChain(o,t)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(si(t)){for(const s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await D5.init({logger:this.providerOpts.logger||jd,relayUrl:this.providerOpts.relayUrl||P5,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>_s(t)))];pu("client",this.client),pu("events",this.events),pu("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const s=L5(t,this.session),o=cg(s),c=Fd(this.namespaces,this.optionalNamespaces),l=gu(Qo({},c[t]),{accounts:s,chains:o});switch(t){case"eip155":this.rpcProviders[t]=new z5({namespace:l});break;case"solana":this.rpcProviders[t]=new H5({namespace:l});break;case"cosmos":this.rpcProviders[t]=new B5({namespace:l});break;case"polkadot":this.rpcProviders[t]=new F5({namespace:l});break;case"cip34":this.rpcProviders[t]=new K5({namespace:l});break;case"elrond":this.rpcProviders[t]=new k5({namespace:l});break;case"multiversx":this.rpcProviders[t]=new V5({namespace:l});break;case"near":this.rpcProviders[t]=new G5({namespace:l});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:s}=t;if(s.name==="accountsChanged"){const o=s.data;o&&si(o)&&this.events.emit("accountsChanged",o.map(M5))}else if(s.name==="chainChanged"){const o=t.chainId,c=t.event.data,l=_s(o),f=du(o)!==du(c)?`${l}:${du(c)}`:o;this.onChainChanged(f)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var s;const{namespaces:o}=t,c=(s=this.client)==null?void 0:s.session.get(e);this.session=gu(Qo({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",gu(Qo({},mt("USER_DISCONNECTED")),{data:e.topic}))}),this.on(Ii.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:s,sessionProperties:o}=e;t&&Object.keys(t).length&&(this.namespaces=t),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",t),this.persist("optionalNamespaces",s)}validateChain(e){const[t,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,s];if(t&&!Object.keys(this.namespaces||{}).map(l=>_s(l)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];const o=_s(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){if(!this.namespaces)return;const[s,o]=this.validateChain(e);o&&(t||this.getProvider(s).setDefaultChain(o),this.namespaces[s]?this.namespaces[s].defaultChain=o:this.namespaces[`${s}:${o}`]?this.namespaces[`${s}:${o}`].defaultChain=o:this.namespaces[`${s}:${o}`]={defaultChain:o},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",o))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${Ld}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${Ld}/${e}`)}}const Z5=fh,ex="wc",tx="ethereum_provider",rx=`${ex}@2:${tx}:`,ix="https://rpc.walletconnect.com/v1/",Ku=["eth_sendTransaction","personal_sign"],nx=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],ku=["chainChanged","accountsChanged"],sx=["chainChanged","accountsChanged","message","disconnect","connect"];var ox=Object.defineProperty,ax=Object.defineProperties,cx=Object.getOwnPropertyDescriptors,Kd=Object.getOwnPropertySymbols,ux=Object.prototype.hasOwnProperty,hx=Object.prototype.propertyIsEnumerable,kd=(i,e,t)=>e in i?ox(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,bs=(i,e)=>{for(var t in e||(e={}))ux.call(e,t)&&kd(i,t,e[t]);if(Kd)for(var t of Kd(e))hx.call(e,t)&&kd(i,t,e[t]);return i},Vd=(i,e)=>ax(i,cx(e));function aa(i){return Number(i[0].split(":")[1])}function yu(i){return`0x${i.toString(16)}`}function lx(i){const{chains:e,optionalChains:t,methods:s,optionalMethods:o,events:c,optionalEvents:l,rpcMap:f}=i;if(!si(e))throw new Error("Invalid chains");const g={chains:e,methods:s||Ku,events:c||ku,rpcMap:bs({},e.length?{[aa(e)]:f[aa(e)]}:{})},p=c==null?void 0:c.filter(x=>!ku.includes(x)),v=s==null?void 0:s.filter(x=>!Ku.includes(x));if(!t&&!l&&!o&&!(p!=null&&p.length)&&!(v!=null&&v.length))return{required:e.length?g:void 0};const w=(p==null?void 0:p.length)&&(v==null?void 0:v.length)||!t,E={chains:[...new Set(w?g.chains.concat(t||[]):t)],methods:[...new Set(g.methods.concat(o!=null&&o.length?o:nx))],events:[...new Set(g.events.concat(l!=null&&l.length?l:sx))],rpcMap:f};return{required:e.length?g:void 0,optional:t.length?E:void 0}}class dh{constructor(){this.events=new Fr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=rx,this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const t=new dh;return await t.initialize(e),t}async request(e,t){return await this.signer.request(e,this.formatChainId(this.chainId),t)}sendAsync(e,t,s){this.signer.sendAsync(e,t,this.formatChainId(this.chainId),s)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:s}=lx(this.rpc);try{const o=await new Promise(async(l,f)=>{var g;this.rpc.showQrModal&&((g=this.modal)==null||g.subscribeModal(p=>{!p.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Vd(bs({namespaces:bs({},t&&{[this.namespace]:t})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(p=>{l(p)}).catch(p=>{f(new Error(p.message))})});if(!o)return;const c=bE(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:yu(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:s}=t;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",yu(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Vd(bs({},mt("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,s;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(s=this.modal)==null||s.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",yu(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,s,o]=e.split(":");return{chainId:`${t}:${s}`,address:o}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,s;const o=(t=e==null?void 0:e.chains)!=null?t:[],c=(s=e==null?void 0:e.optionalChains)!=null?s:[],l=o.concat(c);if(!l.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const f=o.length?(e==null?void 0:e.methods)||Ku:[],g=o.length?(e==null?void 0:e.events)||ku:[],p=(e==null?void 0:e.optionalMethods)||[],v=(e==null?void 0:e.optionalEvents)||[],w=(e==null?void 0:e.rpcMap)||this.buildRpcMap(l,e.projectId),E=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(x=>this.formatChainId(x)),optionalChains:c.map(x=>this.formatChainId(x)),methods:f,events:g,optionalMethods:p,optionalEvents:v,rpcMap:w,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:E,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const s={};return e.forEach(o=>{s[o]=this.getRpcUrl(o,t)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?aa(this.rpc.chains):aa(this.rpc.optionalChains),this.signer=await Z5.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:s}=await Hw(()=>import("./index-D8vjKS3j.js").then(o=>o.i),__vite__mapDeps([0,1,2]));t=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(bs({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:s,rpcMap:o}=e;t&&si(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)})),s&&si(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(c=>this.formatChainId(c)),s.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)}))}getRpcUrl(e,t){var s;return((s=this.rpc.rpcMap)==null?void 0:s[e])||`${ix}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const Tx=dh;export{Tx as EthereumProvider,sx as OPTIONAL_EVENTS,nx as OPTIONAL_METHODS,ku as REQUIRED_EVENTS,Ku as REQUIRED_METHODS,dh as default};
